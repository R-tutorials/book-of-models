<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>matrix_operations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="01_matrix_operations_files/libs/clipboard/clipboard.min.js"></script>
<script src="01_matrix_operations_files/libs/quarto-html/quarto.js"></script>
<script src="01_matrix_operations_files/libs/quarto-html/popper.min.js"></script>
<script src="01_matrix_operations_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="01_matrix_operations_files/libs/quarto-html/anchor.min.js"></script>
<link href="01_matrix_operations_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="01_matrix_operations_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="01_matrix_operations_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="01_matrix_operations_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="01_matrix_operations_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="matrix-operations" class="level1">
<h1>Matrix Operations</h1>
<p>Addition, subtraction, and multiplication. These are all things you already know how to do with scalars. What happens, though, if you want to multiply two different matrices together. Does that simple, scalar operation still translate if you have a <span class="math inline">\(2x3\)</span> matrix and a <span class="math inline">\(3x2\)</span> matrix? If you said, “Yes!”, or we’ve already lost you, then this chapter is for you! Maybe you’ve encountered these concepts before, possibly in the first 3 weeks of a graduate statistics course; you left that class confused, angry, and wondering why you would be subjected to such nonsense. If that sounds familiar, this chapter is for you. If you found Linear Algebra easy, then you can comfortably skip this chapter and see if Chapter 2 might be where you want to start.</p>
<p>Matrix operations, especially multiplication, are critical for understanding what comes throughout the rest of the book. Knowing the underlying mechanics of matrix operations helps to demystify several issues that you might run into with your models. You’ll frequently see model output tell you how many records were deleted due to missingness. You’ll then find yourself wondering why is missingness such a problem that entire rows get deleted from your model? As we progress through the next several chapters, those issues and more will become much clearer.</p>
<p>Before we get into any operations, though, let’s make sure we are together on some concepts.</p>
<p>A <em>scalar</em> is a single value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>scalar_example <span class="ot">&lt;-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>scalar_example <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A <em>vector</em> is a collection of scalars with a length of <strong>n</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>vector_example <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>vector_example <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A <em>matrix</em> is a 2 dimensional collection of vectors.</p>
<p><span class="math display">\[
\begin{bmatrix}
1 &amp; 2 &amp; 3\\
4 &amp; 5 &amp; 6
\end{bmatrix}
\]</span></p>
<p>If you think about most tables you’ve ever seen, you’ll see that the simple matrix looks remarkably familiar!</p>
<p>Any matrix has 2 dimensions, rows and columns. When we talk about the dimensions of a matrix, we always make note of the rows first, followed by the columns. This matrix has 2 rows and 3 columns; therefore, we have a <span class="math inline">\(2x3\)</span> matrix.</p>
<section id="addition" class="level2">
<h2 class="anchored" data-anchor-id="addition">Addition</h2>
<p>Matrix addition, along with subtraction, is the easiest concept when dealing with matrices. While it is easy to grasp, you will not find it featured as prominently as matrix multiplication.</p>
<p>There is one rule for matrix addition: the matrices need to have the same dimensions.</p>
<p>Let’s check out these two matrices:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}  
\
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 8_{12} &amp; 9_{13}\\
9_{21} &amp; 8_{22} &amp; 7_{23}
\end{bmatrix}
}
\]</span></p>
<p>You probably noticed that we gave each scalar within the matrix a label associated with its row and column position. We can use these to see how we will produce the new matrix:</p>
<p>Now, we can set this up as an addition problem to produce Matrix C:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}  
+
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 8_{12} &amp; 9_{13}\\
9_{21} &amp; 8_{22} &amp; 7_{23}
\end{bmatrix}
}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
A_{11} + B_{11}&amp; A_{12} + B_{12} &amp; A_{13} + B_{13}\\
A_{21} + B_{21}&amp; A_{22} + B_{22} &amp; A_{23} + B_{23}
\end{bmatrix}
}
\]</span></p>
<p>Now we can pull in the real numbers:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}  
+
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 8_{12} &amp; 9_{13}\\
9_{21} &amp; 8_{22} &amp; 7_{23}
\end{bmatrix}
}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
1 + 7  &amp; 2 + 8 &amp; 3 + 9\\
4 + 9 &amp; 5 + 8 &amp; 6 + 7
\end{bmatrix}
}
\]</span></p>
<p>Giving us Matrix C:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}  
+
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 8_{12} &amp; 9_{13}\\
9_{21} &amp; 8_{22} &amp; 7_{23}
\end{bmatrix}
}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
8 &amp; 10 &amp; 12 \\
13 &amp; 13 &amp; 13
\end{bmatrix}
}
\]</span></p>
</section>
<section id="subtraction" class="level2">
<h2 class="anchored" data-anchor-id="subtraction">Subtraction</h2>
<p>Take everything that you just saw with addition and replace it with subtraction!</p>
<p>Just like addition, every matrix needs to have the same dimensions if you are going to use subtraction.</p>
<p>Let’s see those two matrices again and cast it as subtraction problem:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}
-
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 8_{12} &amp; 9_{13}\\
9_{21} &amp; 8_{22} &amp; 7_{23}
\end{bmatrix}
}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
A_{11} - B_{11}&amp; A_{12} - B_{12} &amp; A_{13} - B_{13}\\
A_{21} - B_{21}&amp; A_{22} - B_{22} &amp; A_{23} - B_{23}
\end{bmatrix}
}
\]</span></p>
<p>And now we can substitute in the real numbers:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}
-
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 8_{12} &amp; 9_{13}\\
9_{21} &amp; 8_{22} &amp; 7_{23}
\end{bmatrix}
}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
1 - 7 &amp; 2 - 8 &amp; 3 - 9\\
4 - 9 &amp; 5 - 8 &amp; 6 - 7
\end{bmatrix}
}
\]</span></p>
<p>And end with this matrix:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}
-
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 8_{12} &amp; 9_{13}\\
9_{21} &amp; 8_{22} &amp; 7_{23}
\end{bmatrix}
}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
-6 &amp; -6 &amp; -6 \\
-5 &amp; -3 &amp; -1
\end{bmatrix}
}
\]</span></p>
<p>Adding and subtracting matrices in R and Python is pretty simple:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>matrix_A <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The following is an equivalent</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># to rbind:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix_A &lt;- matrix(c(1:3, 4:6), </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                    nrow = 2, </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                    ncol = 3, byrow = TRUE)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>matrix_B <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">9</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>matrix_A <span class="sc">+</span> matrix_B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    8   10   12
[2,]   13   13   13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>matrix_A <span class="sc">-</span> matrix_B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   -6   -6   -6
[2,]   -5   -3   -1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>matrix_A <span class="op">=</span> np.matrix(<span class="st">'1 2 3; 4 5 6'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>matrix_B <span class="op">=</span> np.matrix(<span class="st">'7 8 9; 9 8 7'</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>matrix_A <span class="op">+</span> matrix_B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>matrix([[ 8, 10, 12],
        [13, 13, 13]])</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>matrix_A <span class="op">-</span> matrix_B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>matrix([[-6, -6, -6],
        [-5, -3, -1]])</code></pre>
</div>
</div>
</section>
<section id="transpose" class="level2">
<h2 class="anchored" data-anchor-id="transpose">Transpose</h2>
<p>As you progress through this book, you might see a matrix denoted as <span class="math inline">\(A^T\)</span>; here the superscripted T stands for transpose. If we transpose a matrix, all we are doing is to flip the rows and columns along the matrix’s main diagonal. A visual example is much easier:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}
-&gt;
\stackrel{\mbox{Matrix A}^T}{
\begin{bmatrix}
1 &amp; 4 \\
2 &amp; 5 \\
3 &amp; 6
\end{bmatrix}
}
\]</span></p>
<p>Like any matrix operation, a tranpose is pretty easy to do when the matrix is small; you’re best bet is to rely on software to do anything beyond a few rows or columns.</p>
<p>In R, all we need is to use the <code>t</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(matrix_A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6</code></pre>
</div>
</div>
<p>In Python, we can use numpy’s <code>transpose</code> method:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>matrix_A.transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>matrix([[1, 4],
        [2, 5],
        [3, 6]])</code></pre>
</div>
</div>
</section>
<section id="multiplication" class="level2">
<h2 class="anchored" data-anchor-id="multiplication">Multiplication</h2>
<p>Now, you probably have some confidence in doing matrix operations. Just as quickly as we built that confidence, it will be crushed when learning about matrix multiplication.</p>
<p>When dealing with matrix multiplication, we have a huge change to our rule. No longer can our dimensions be the same! Instead, the matrices need to be <em>conformable</em> – the first matrix needs to have the same number of columns as the number of rows within the second matrix. In other words, the inner dimensions must match.</p>
<p>Look one more time at these matrices:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}
*
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 8_{12} &amp; 9_{13}\\
9_{21} &amp; 8_{22} &amp; 7_{23}
\end{bmatrix}
}
\]</span></p>
<p>Matrix A has dimensions of <span class="math inline">\(2x3\)</span>, as does Matrix B. Putting those dimensions side by side – <span class="math inline">\(2x3 * 2x3\)</span> – we see that our inner dimensions are 3 and 2 and do not match.</p>
<p>What if we <em>transpose</em> matrix B?</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 9_{12} \\
8_{21}&amp; 9_{22}\\
9_{31} &amp; 7_{32}
\end{bmatrix}
}
\]</span></p>
<p>Now we have something that works!</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}
*
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 9_{12} \\
8_{21}&amp; 9_{22}\\
9_{31} &amp; 7_{32}
\end{bmatrix}
}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
. &amp; . \\
. &amp; . \\
\end{bmatrix}
}
\]</span></p>
<p>Now we have a <span class="math inline">\(2x3 * 3x2\)</span> matrix multiplication problem! The resulting matrix will have the same dimensions as our two matrices’ outer dimensions: <span class="math inline">\(2x2\)</span></p>
<p>Here is how we will get at <span class="math inline">\(2x2\)</span> matrix:</p>
<p><span class="math display">\[
\stackrel{\mbox{Matrix A}}{
\begin{bmatrix}
1_{11} &amp; 2_{12} &amp; 3_{13}\\
4_{21} &amp; 5_{22} &amp; 6_{23}
\end{bmatrix}
}
.
\stackrel{\mbox{Matrix B}}{
\begin{bmatrix}
7_{11} &amp; 9_{12} \\
8_{21}&amp; 9_{22}\\
9_{31} &amp; 7_{32}
\end{bmatrix}
}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
(A_{11}*B_{11})+(A_{12}*B_{21})+(A_{13}*B_{31}) &amp; (A_{11}*B_{12})+(A_{12}*B_{22})+(A_{13}*B_{32}) \\
(A_{21}*B_{11})+(A_{22}*B_{21})+(A_{23}*B_{31}) &amp; (A_{21}*B_{12})+(A_{22}*B_{22})+(A_{23}*B_{32})
\end{bmatrix}
}
\]</span></p>
<p>That might look like a horrible mess and likely isn’t easy to commit to memory. Instead, we’d like to show you a way that might make it easier to remember how to multiply matrices. It also gives a nice representation of why your matrices need to be conformable.</p>
<p>We can leave Matrix A exactly where it is, flip Matrix B, and stack it right on top of Matrix A:</p>
<p><span class="math display">\[
\begin{bmatrix}
9_{b} &amp; 8_{b} &amp; 7_{b} \\
7_{b} &amp; 8_{b} &amp; 9_{b} \\
\\
1_{a} &amp; 2_{a} &amp; 3_{a} \\
4_{a} &amp; 5_{a} &amp; 6_{a}
\end{bmatrix}
\]</span></p>
<p>Now, we can let the B matrix “fall down” through the A matrix:</p>
<p><span class="math display">\[
\begin{bmatrix}
9_{b} &amp; 8_{b} &amp; 7_{b} \\
\\
1_{a}*7_{b} &amp; 2_{a}*8_{b} &amp; 3_{a}*9_{b}\\
4_{a} &amp; 5_{a} &amp; 6_{a}
\end{bmatrix}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
50 &amp; .\\
. &amp; .
\end{bmatrix}
}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
9_{b} &amp; 8_{b} &amp; 7_{b} \\
\\
1_{a} &amp; 2_{a} &amp; 3_{a}\\
4_{a}*7_{b} &amp; 5_{a}*8_{b} &amp; 6_{a}*9_{b}
\end{bmatrix}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
50 &amp; .\\
122 &amp; .
\end{bmatrix}
}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
1_{a}*9_{b} &amp; 2_{a}*8_{b} &amp; 3_{a}*7_{b}\\
4_{a} &amp; 5_{a} &amp; 6_{a}
\end{bmatrix}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
50 &amp; 46\\
122 &amp; .
\end{bmatrix}
}
\]</span></p>
<p><span class="math display">\[
\begin{bmatrix}
1_{a} &amp; 2_{a} &amp; 3_{a}\\
4_{a}*9_{b} &amp; 5_{a}*8_{b} &amp; 6_{a}*7_{b}
\end{bmatrix}
=
\stackrel{\mbox{Matrix C}}{
\begin{bmatrix}
50 &amp; 46\\
122 &amp; 118
\end{bmatrix}
}
\]</span></p>
<p>Now that you know how these work, you can see how easy it is to handle these tasks in R and Python.</p>
<p>In R, we need to use a fancy operator: <code>%*%</code>. This is just R matrix multiplication operator. We will also use the transpose function: <code>t</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>matrix_A <span class="sc">%*%</span> <span class="fu">t</span>(matrix_B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   50   46
[2,]  122  118</code></pre>
</div>
</div>
<p>In Python, we can just use the regular multiplication operator and the transpose method:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>matrix_A <span class="op">*</span> matrix_B.transpose()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>matrix([[ 50,  46],
        [122, 118]])</code></pre>
</div>
</div>
<p>You can see that whether we do this by hand, R, or Python, we come up with the same answer! While these small matrices can definitely be done by hand, we will always trust the computer to handle larger matrices.</p>
</section>
<section id="inversion" class="level2">
<h2 class="anchored" data-anchor-id="inversion">Inversion</h2>
<p>You might want to think of matrix inversion as the reciprocal of the matrix, usually noted as <span class="math inline">\(A^{-1}\)</span>. The biggest reason that we might invert a matrix is because there is no matrix division.</p>
<p>We have a nice figure in Figure @ref(fig:hello), and also a table in Table @ref(tab:iris).</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>