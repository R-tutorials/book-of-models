<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.339">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Models - 5&nbsp; How do we obtain a model?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./machine_learning.html" rel="next">
<link href="./steps.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear_models.html">Linear Models</a></li><li class="breadcrumb-item"><a href="./estimation.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">How do we obtain a model?</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Models</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/m-clark/book-of-models" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Models.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Foundation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_criticism.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model criticism</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Steps in Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">How do we obtain a model?</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml_common_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Common Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml_more.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">More ML</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Other Considerations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Issues in Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataset_descriptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Dataset Descriptions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrix_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Matrix Operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_placeholder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Other to come</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction-to-model-estimation" id="toc-introduction-to-model-estimation" class="nav-link active" data-scroll-target="#introduction-to-model-estimation"><span class="header-section-number">5.1</span> Introduction to Model Estimation</a></li>
  <li><a href="#key-ideas" id="toc-key-ideas" class="nav-link" data-scroll-target="#key-ideas"><span class="header-section-number">5.2</span> Key ideas</a></li>
  <li><a href="#data-setup" id="toc-data-setup" class="nav-link" data-scroll-target="#data-setup"><span class="header-section-number">5.3</span> Data Setup</a></li>
  <li><a href="#starting-out-by-guessing" id="toc-starting-out-by-guessing" class="nav-link" data-scroll-target="#starting-out-by-guessing"><span class="header-section-number">5.4</span> Starting Out by Guessing</a></li>
  <li><a href="#prediction-error" id="toc-prediction-error" class="nav-link" data-scroll-target="#prediction-error"><span class="header-section-number">5.5</span> Prediction Error</a></li>
  <li><a href="#ordinary-least-squares" id="toc-ordinary-least-squares" class="nav-link" data-scroll-target="#ordinary-least-squares"><span class="header-section-number">5.6</span> Ordinary Least Squares</a></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization"><span class="header-section-number">5.7</span> Optimization</a></li>
  <li><a href="#maximum-likelihood" id="toc-maximum-likelihood" class="nav-link" data-scroll-target="#maximum-likelihood"><span class="header-section-number">5.8</span> Maximum Likelihood</a></li>
  <li><a href="#estimation-quick-review" id="toc-estimation-quick-review" class="nav-link" data-scroll-target="#estimation-quick-review"><span class="header-section-number">5.9</span> Estimation: Quick Review</a></li>
  <li><a href="#penalized-objectives" id="toc-penalized-objectives" class="nav-link" data-scroll-target="#penalized-objectives"><span class="header-section-number">5.10</span> Penalized Objectives</a></li>
  <li><a href="#classification" id="toc-classification" class="nav-link" data-scroll-target="#classification"><span class="header-section-number">5.11</span> Classification</a>
  <ul class="collapse">
  <li><a href="#misclassification" id="toc-misclassification" class="nav-link" data-scroll-target="#misclassification"><span class="header-section-number">5.11.1</span> Misclassification</a></li>
  <li><a href="#log-loss" id="toc-log-loss" class="nav-link" data-scroll-target="#log-loss"><span class="header-section-number">5.11.2</span> Log loss</a></li>
  </ul></li>
  <li><a href="#optimization-algorithms" id="toc-optimization-algorithms" class="nav-link" data-scroll-target="#optimization-algorithms"><span class="header-section-number">5.12</span> Optimization Algorithms</a>
  <ul class="collapse">
  <li><a href="#gradient-descent" id="toc-gradient-descent" class="nav-link" data-scroll-target="#gradient-descent"><span class="header-section-number">5.12.1</span> Gradient Descent</a></li>
  <li><a href="#stochastic-gradient-descent" id="toc-stochastic-gradient-descent" class="nav-link" data-scroll-target="#stochastic-gradient-descent"><span class="header-section-number">5.12.2</span> Stochastic Gradient Descent</a></li>
  <li><a href="#other-optimization-algorithms" id="toc-other-optimization-algorithms" class="nav-link" data-scroll-target="#other-optimization-algorithms"><span class="header-section-number">5.12.3</span> Other Optimization Algorithms</a></li>
  </ul></li>
  <li><a href="#other-estimation-approaches" id="toc-other-estimation-approaches" class="nav-link" data-scroll-target="#other-estimation-approaches"><span class="header-section-number">5.13</span> Other Estimation Approaches</a>
  <ul class="collapse">
  <li><a href="#bootstrap" id="toc-bootstrap" class="nav-link" data-scroll-target="#bootstrap"><span class="header-section-number">5.13.1</span> Bootstrap</a></li>
  <li><a href="#bayesian-estimation" id="toc-bayesian-estimation" class="nav-link" data-scroll-target="#bayesian-estimation"><span class="header-section-number">5.13.2</span> Bayesian Estimation</a></li>
  </ul></li>
  <li><a href="#commentary" id="toc-commentary" class="nav-link" data-scroll-target="#commentary"><span class="header-section-number">5.14</span> Commentary</a></li>
  <li><a href="#refs" id="toc-refs" class="nav-link" data-scroll-target="#refs"><span class="header-section-number">5.15</span> Refs</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/m-clark/book-of-models/edit/main/estimation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear_models.html">Linear Models</a></li><li class="breadcrumb-item"><a href="./estimation.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">How do we obtain a model?</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">How do we obtain a model?</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<p>In our initial linear model, the key <strong>parameters</strong> are the coefficients for each feature. But how do we know what the coefficients are and come to those values? When we run a linear model using some program function, they appear magically, but it’s worth knowing a little bit about how they come to be, so let’s try and dive a little deeper! This chapter is more involved than most of the others, and is really for those who like to get their hands dirty. If you’re not one of those people, that’s ok, you can skip this chapter and still get a lot out of the rest of the book. But if you’re curious about how things work, or you want to be able to do more than just run a function, then we think you’ll find the following useful.</p>
<section id="introduction-to-model-estimation" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="introduction-to-model-estimation"><span class="header-section-number">5.1</span> Introduction to Model Estimation</h2>
<p><strong>Model estimation</strong> is the process of finding the parameters associated with a model that allow us to reach a particular modeling goal. Different types of models will have different parameters to estimate, and there are different ways to estimate them. In general though, the goal is the same, find the set of parameters that will lead to the best predictions under the current data modeling context.</p>
<p>With model estimation, we can break things down into the following steps:</p>
<ol type="1">
<li>Start with an initial guess for the parameters</li>
<li>Calculate the <strong>prediction error</strong>, or some function of it, or some other value that represents our model’s <strong>objective</strong></li>
<li><strong>Update</strong> the guess</li>
<li>Repeat steps 2 &amp; 3 until we find a ‘best’ guess</li>
</ol>
<p>Pretty straightforward, right? Well, it’s not always so simple, but this is the general idea in most applications. In this chapter, we’ll show how to do this ourselves to take away the mystery a bit from when you run standard model functions in typical contexts. Hopefully then you’ll gain more confidence when you do use them!</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" type="info" title="Estimation vs. Optimization">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estimation vs.&nbsp;Optimization
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can use <strong>estimation</strong> as general term for finding parameters, while <strong>optimization</strong> can be seen as a term for finding parameters that maximize or minimize some <strong>objective function</strong>, or even a combination of objectives. In some cases we can estimate parameters without optimization, because there is a known way of solving the problem, but in most modeling situations we are going to use some optimization approach to find a ‘best’ set of parameters.</p>
</div>
</div>
</section>
<section id="key-ideas" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="key-ideas"><span class="header-section-number">5.2</span> Key ideas</h2>
<ul>
<li><strong>Parameters</strong> are the values associated with a model</li>
<li><strong>Estimation</strong> is the process of finding the parameters associated with a model</li>
<li>The <strong>objective function</strong> produces a value that we want to, for example, maximize or minimize</li>
<li><strong>Prediction error</strong> is the difference between the actual value of the target and the predicted value of the target, and is often used to calculate the objective function</li>
<li><strong>Optimization</strong> is the process of finding the parameters that maximize or minimize some objective function</li>
<li><strong>Model Selection</strong> is the process of choosing the best model from a set of models</li>
</ul>
</section>
<section id="data-setup" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="data-setup"><span class="header-section-number">5.3</span> Data Setup</h2>
<p>For the examples here, we’ll use the world happiness dataset for the year 2018. We’ll use the happiness score as our target, and we’ll use the GDP per capita as our primary feature, though we may throw in some others. Let’s take a look at the data here, but for more information see the <a href="#appendix">appendix</a>.</p>
<p>NOTE GTEXTRAS PLOT CAUSES PDF ERROR AND WILL HAVE TO BE IMPORTED AS FILE</p>
<div class="cell">
<div class="cell-output-display">
<div id="lsftpjxsrx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#lsftpjxsrx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lsftpjxsrx thead, #lsftpjxsrx tbody, #lsftpjxsrx tfoot, #lsftpjxsrx tr, #lsftpjxsrx td, #lsftpjxsrx th {
  border-style: none;
}

#lsftpjxsrx p {
  margin: 0;
  padding: 0;
}

#lsftpjxsrx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lsftpjxsrx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lsftpjxsrx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lsftpjxsrx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lsftpjxsrx .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lsftpjxsrx .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lsftpjxsrx .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lsftpjxsrx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lsftpjxsrx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lsftpjxsrx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lsftpjxsrx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lsftpjxsrx .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lsftpjxsrx .gt_spanner_row {
  border-bottom-style: hidden;
}

#lsftpjxsrx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lsftpjxsrx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lsftpjxsrx .gt_from_md > :first-child {
  margin-top: 0;
}

#lsftpjxsrx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lsftpjxsrx .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lsftpjxsrx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lsftpjxsrx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lsftpjxsrx .gt_row_group_first td {
  border-top-width: 2px;
}

#lsftpjxsrx .gt_row_group_first th {
  border-top-width: 2px;
}

#lsftpjxsrx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lsftpjxsrx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lsftpjxsrx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lsftpjxsrx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lsftpjxsrx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lsftpjxsrx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lsftpjxsrx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lsftpjxsrx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lsftpjxsrx .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#lsftpjxsrx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lsftpjxsrx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lsftpjxsrx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lsftpjxsrx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lsftpjxsrx .gt_left {
  text-align: left;
}

#lsftpjxsrx .gt_center {
  text-align: center;
}

#lsftpjxsrx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lsftpjxsrx .gt_font_normal {
  font-weight: normal;
}

#lsftpjxsrx .gt_font_bold {
  font-weight: bold;
}

#lsftpjxsrx .gt_font_italic {
  font-style: italic;
}

#lsftpjxsrx .gt_super {
  font-size: 65%;
}

#lsftpjxsrx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lsftpjxsrx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lsftpjxsrx .gt_indent_1 {
  text-indent: 5px;
}

#lsftpjxsrx .gt_indent_2 {
  text-indent: 10px;
}

#lsftpjxsrx .gt_indent_3 {
  text-indent: 15px;
}

#lsftpjxsrx .gt_indent_4 {
  text-indent: 20px;
}

#lsftpjxsrx .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="happiness_score">happiness_score</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="healthy_life_expectancy_at_birth">healthy_life_expectancy_at_birth</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="log_gdp_per_capita">log_gdp_per_capita</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="perceptions_of_corruption">perceptions_of_corruption</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">happiness_score</td>
<td headers="happiness_score" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">NA</td>
<td headers="healthy_life_expectancy_at_birth" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.78</td>
<td headers="log_gdp_per_capita" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.82</td>
<td headers="perceptions_of_corruption" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.47</td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">healthy_life_expectancy_at_birth</td>
<td headers="happiness_score" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.78</td>
<td headers="healthy_life_expectancy_at_birth" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">NA</td>
<td headers="log_gdp_per_capita" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.86</td>
<td headers="perceptions_of_corruption" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.34</td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">log_gdp_per_capita</td>
<td headers="happiness_score" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.82</td>
<td headers="healthy_life_expectancy_at_birth" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.86</td>
<td headers="log_gdp_per_capita" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">NA</td>
<td headers="perceptions_of_corruption" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.34</td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">perceptions_of_corruption</td>
<td headers="happiness_score" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.47</td>
<td headers="healthy_life_expectancy_at_birth" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.34</td>
<td headers="log_gdp_per_capita" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.34</td>
<td headers="perceptions_of_corruption" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">NA</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Our happiness score has values from around 3-7, life expectancy and gdp appear to have some notable variability, and corruption perception is skewed toward lower values. We can also see that the features and target are correlated with each other, which is not surprising.</p>
<p>We’ll do some minor cleaning and renaming of columns, and we’ll drop any rows with missing values. We’ll also scale the features so that they are on the same scale, which as noted in the data chapter, can help make estimation easier.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df_happiness <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/world_happiness_2018.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        country,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        happiness_score,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        healthy_life_expectancy_at_birth,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        log_gdp_per_capita,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        perceptions_of_corruption</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">happiness  =</span> happiness_score,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">life_exp   =</span> healthy_life_expectancy_at_birth,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">log_gdp_pc =</span> log_gdp_per_capita,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">corrupt    =</span> perceptions_of_corruption</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">gdp_pc =</span> <span class="fu">exp</span>(log_gdp_pc), <span class="co"># put back on original scale before scaling</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">across</span>(life_exp<span class="sc">:</span>gdp_pc, \(x) (x <span class="sc">-</span> <span class="fu">mean</span>(x)) <span class="sc">/</span> <span class="fu">sd</span>(x))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>log_gdp_pc) <span class="co"># drop the log version</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_happiness <span class="op">=</span> (</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    pd.read_csv(<span class="st">'data/world_happiness_2018.csv'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    .dropna()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    .rename(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        columns <span class="op">=</span> {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">'happiness_score'</span>: <span class="st">'happiness'</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">'healthy_life_expectancy_at_birth'</span>: <span class="st">'life_exp'</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">'log_gdp_per_capita'</span>: <span class="st">'log_gdp_pc'</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">'perceptions_of_corruption'</span>: <span class="st">'corrupt'</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    .assign(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        gdp_pc <span class="op">=</span> <span class="kw">lambda</span> x: np.exp(x[<span class="st">'log_gdp_pc'</span>]),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    )    </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    [[<span class="st">'country'</span>, <span class="st">'happiness'</span>,<span class="st">'life_exp'</span>, <span class="st">'gdp_pc'</span>, <span class="st">'corrupt'</span>]]</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>df_happiness[[<span class="st">'life_exp'</span>, <span class="st">'gdp_pc'</span>, <span class="st">'corrupt'</span>]] <span class="op">=</span> scaler.fit_transform(</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    df_happiness[[<span class="st">'life_exp'</span>, <span class="st">'gdp_pc'</span>, <span class="st">'corrupt'</span>]]</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="starting-out-by-guessing" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="starting-out-by-guessing"><span class="header-section-number">5.4</span> Starting Out by Guessing</h2>
<p>So we’ll start with a model in which we predict a country’s level of happiness by their life expectancy, where if you can expect to live longer, maybe you’re probably in a country with better health care, higher incomes, and other important stuff. We’ll stick with our simple linear model as well.</p>
<p>As a starting point we can just guess what the parameter should be, but how would we know what to guess? How would we know which guesses are better than others? Let’s try a few guesses and see how they do. Let’s say that we don’t think life expectancy matters, and that most countries are at a happiness value of 4. We can plug this into the model and see what we get:</p>
<p><span class="math display">\[
\textrm{prediction} = 4 + 0\cdot\textrm{life\_exp}
\]</span></p>
<p>Alternatively we could use the data to inform our guess. We start with a mean of happiness score, but moving up a standard deviation of life expectancy (roughly ~1 years) would move a whole point of happiness <span class="math display">\[
\textrm{prediction} = \overline{\textrm{happiness}} + 1\cdot\textrm{life\_exp}
\]</span></p>
<p>In this case, our offset (or intercept) is the mean of the target, and our coefficient for the scaled life expectancy is 1. This is probably a better guess, since it is at least data driven, but it’s still not great. But how do we know it’s better?</p>
</section>
<section id="prediction-error" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="prediction-error"><span class="header-section-number">5.5</span> Prediction Error</h2>
<p>We can compare the predictions from each guess to the actual values of the target. We can do this by calculating the <strong>prediction error</strong>, or in the context of a linear model, they are also called <strong>residuals</strong>. The prediction error is the difference between the actual value of the target and the predicted value of the target. We can express this as:</p>
<p><span class="math display">\[
\epsilon = y - \hat{y}
\]</span> <span class="math display">\[
\textrm{error} = \textrm{target} - \textrm{(model based) guess}
\]</span></p>
<p>Not only does this tell us how far off our model prediction is, it gives us a way to compare models. With a measure of prediction error, we can get a <strong>metric</strong> for total error for all observations/predictions, or similarly the average error. If one model or parameter set has less total or average error, we can say it’s a better model than one that has more. Ideally we’d like to choose a model with the least error, but we’ll see that this is not always possible<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. For now, let’s calculate the error for our two guesses. One thing though, if we miss the mark above or below our target, we still want it to count the same in terms of prediction error. In other words, if the true happiness score is 5 and our model predicts 5.5 or 4.5, we want those to count the same when we total up our error<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. One way we can do this is to use the squared error value, or maybe the absolute value. We’ll use squared error here, and we’ll calculate the mean of the squared errors for all our predictions. We’ll do this for our two models above.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> df_happiness<span class="sc">$</span>happiness</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error for the guess of 4</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>mse_four <span class="ot">&lt;-</span> <span class="fu">mean</span>((y <span class="sc">-</span> prediction)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error for our other guess</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> df_happiness<span class="sc">$</span>life_exp</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>mse_other <span class="ot">&lt;-</span> <span class="fu">mean</span>((y <span class="sc">-</span> prediction)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error for the guess of four</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>mse_four   <span class="op">=</span> np.mean((y <span class="op">-</span> prediction)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error for our other guess</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> y.mean() <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> df_happiness[<span class="st">'life_exp'</span>]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>mse_other  <span class="op">=</span> np.mean((y <span class="op">-</span> prediction)<span class="op">**</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Now let’s look at our <strong>Mean Squared Error</strong> (MSE), and we’ll also inspect the square root of it, or the <strong>Root Mean Squared Error</strong>, as that puts things back on the original target scale. We also add the <strong>Mean Absolute Error</strong> as another metric. Inspecting the metrics, we can see that we are off on average by over a point for our ‘#4’ model, but notably less when guessing the mean.</p>
<div class="cell">
<div class="cell-output-display">
<div id="vtvkeelkbk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#vtvkeelkbk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vtvkeelkbk thead, #vtvkeelkbk tbody, #vtvkeelkbk tfoot, #vtvkeelkbk tr, #vtvkeelkbk td, #vtvkeelkbk th {
  border-style: none;
}

#vtvkeelkbk p {
  margin: 0;
  padding: 0;
}

#vtvkeelkbk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vtvkeelkbk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vtvkeelkbk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vtvkeelkbk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vtvkeelkbk .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtvkeelkbk .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtvkeelkbk .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vtvkeelkbk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vtvkeelkbk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vtvkeelkbk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vtvkeelkbk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vtvkeelkbk .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vtvkeelkbk .gt_spanner_row {
  border-bottom-style: hidden;
}

#vtvkeelkbk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vtvkeelkbk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vtvkeelkbk .gt_from_md > :first-child {
  margin-top: 0;
}

#vtvkeelkbk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vtvkeelkbk .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vtvkeelkbk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vtvkeelkbk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vtvkeelkbk .gt_row_group_first td {
  border-top-width: 2px;
}

#vtvkeelkbk .gt_row_group_first th {
  border-top-width: 2px;
}

#vtvkeelkbk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtvkeelkbk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vtvkeelkbk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vtvkeelkbk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vtvkeelkbk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtvkeelkbk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vtvkeelkbk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vtvkeelkbk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vtvkeelkbk .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#vtvkeelkbk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtvkeelkbk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtvkeelkbk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vtvkeelkbk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vtvkeelkbk .gt_left {
  text-align: left;
}

#vtvkeelkbk .gt_center {
  text-align: center;
}

#vtvkeelkbk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vtvkeelkbk .gt_font_normal {
  font-weight: normal;
}

#vtvkeelkbk .gt_font_bold {
  font-weight: bold;
}

#vtvkeelkbk .gt_font_italic {
  font-style: italic;
}

#vtvkeelkbk .gt_super {
  font-size: 65%;
}

#vtvkeelkbk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vtvkeelkbk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vtvkeelkbk .gt_indent_1 {
  text-indent: 5px;
}

#vtvkeelkbk .gt_indent_2 {
  text-indent: 10px;
}

#vtvkeelkbk .gt_indent_3 {
  text-indent: 15px;
}

#vtvkeelkbk .gt_indent_4 {
  text-indent: 20px;
}

#vtvkeelkbk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Model">Model</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="MSE">MSE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="RMSE">RMSE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="MAE">MAE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="RMSE % drop">RMSE % drop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="MAE % drop">MAE % drop</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Model" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">#4</td>
<td headers="MSE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">3.36</td>
<td headers="RMSE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.83</td>
<td headers="MAE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.52</td>
<td headers="RMSE % drop" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;"></td>
<td headers="MAE % drop" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;"></td></tr>
    <tr><td headers="Model" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">Other</td>
<td headers="MSE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.50</td>
<td headers="RMSE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.71</td>
<td headers="MAE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.58</td>
<td headers="RMSE % drop" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">61%</td>
<td headers="MAE % drop" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">62%</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>We can see that the other model is not only better, but results in a 61% drop in RMSE, and similar for MAE. We’d definitely prefer the other model over the ‘#4’ model. Furthermore, we can see how we can compare models in a general fashion.</p>
<p>Well, this is useful, and at least we can say one model is better than another. But you’re probably hoping there is an easier way to do get a good guess for our model parameters, especially when we have possibly dozens of features and/or parameters to keep track of, and there is!</p>
<p>MOVE THIS TO LATER</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" type="info" title="A Note on Terminology">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A Note on Terminology
</div>
</div>
<div class="callout-body-container callout-body">
<p>The objective function is often called the <strong>loss function</strong>, and sometimes the <strong>cost function</strong>. However, these both imply that we are trying to minimize the function, which is not always the case<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, and it’s arbitrary whether you want to minimize or maximize the function. In fact, some people will minimize the <em>negative</em> likelihood when using <em>maximum</em> likelihood! As such we’ll try to stick to the more neutral term objective function, but you may see the other terms used interchangeably in this text. In addition, some packages will use the term <strong>metric</strong> to refer a value that you might want to examine as well, or even use to compare models. For example, the MSE is a metric, but it may also be the objective function we are trying to minimize. Other metrics we could calculate without being the objective might be Adjusted R-squared and median absolute error. We could also use MSE as the objective, but use percentage drop in error from baseline when selecting among several models that minimized MSE. This can be very confusing when starting out! We’ll try to stick to the term <em>metric</em> for additional values that we might want to examine separate from the <em>objective function value</em>.</p>
</div>
</div>
</section>
<section id="ordinary-least-squares" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="ordinary-least-squares"><span class="header-section-number">5.6</span> Ordinary Least Squares</h2>
<p>For a simple linear model, we can estimate the parameters in several ways, but the most common is to use the <strong>Ordinary Least Squares (OLS)</strong> method. OLS is a method of estimating the coefficients that minimizes the sum of the squared errors, which we’ve just been doing in the previous section<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. In other words, it finds the coefficients that minimize the sum of the squared differences between the predicted values and the actual values. We can express this as:</p>
<p><span class="math display">\[
\textrm{Value} = \sum_{i=1}^{n} (y_i - \hat{y_i})^2
\]</span></p>
<p>Where <span class="math inline">\(y_i\)</span> is the actual value of the target for observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(\hat{y_i}\)</span> is the predicted value from the model. The sum of the squared errors is also called the <strong>residual sum of squares</strong> (RSS), as opposed to the total sums of squares (i.e.&nbsp;the variance of the target), and the part explained by the model (model or explained sums of squares). The OLS method finds the coefficients that minimize the sum of the squared differences between the predicted values and the actual values. It’s called <em>ordinary</em> least squares because there are other least squares methods - generalized least squares, weighted least squares, and others, but we don’t need to worry about that for now. What matters is that we have a way to estimate the coefficients that minimizes the sum of the squared errors.</p>
<p>The resulting value - the sum or mean of the squared errors, as we noted can be referred to as our <strong>objective value</strong>, while the <strong>objective function</strong> is just the process of taking the predictions and observed target values and totaling up their squared differences. We can use this value to find the best parameters for a specific model, as well as compare models with different parameters, such as a model with additional features versus one with fewer. We can also use this value to compare different types of models that are using the same objective function, such as a linear model and a decision tree model.</p>
<p>Let’s calculate the OLS estimate for our model. From our steps above, we need guesses and a way to update them. For now, we can just provide a bunch of guesses, and just move along from one set to the next, and ultimately just choose whichever has the lowest value.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ols <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, par, <span class="at">sum_sq =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="ot">&lt;-</span> X <span class="sc">%*%</span> par <span class="co"># %*% is matrix multiplication</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the error</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    error <span class="ot">&lt;-</span> y <span class="sc">-</span> y_hat</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the value as sum or mean squared error</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    value <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(error) <span class="co"># crossprod is matrix multiplication</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>sum_sq) {</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        value <span class="ot">&lt;-</span> value <span class="sc">/</span> <span class="fu">nrow</span>(X)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the value</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(value)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># create a grid of guesses</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>guesses <span class="ot">&lt;-</span> <span class="fu">crossing</span>(</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">b0 =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="fl">0.1</span>),</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">b1 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Example for one guess</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ols</span>(</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> df_happiness<span class="sc">$</span>life_exp,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> df_happiness<span class="sc">$</span>happiness,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">unlist</span>(guesses[<span class="dv">1</span>, ])</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]
[1,] 23.777</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ols(par, X, y, <span class="bu">sum</span> <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> X <span class="op">@</span> par</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the error</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the value as sum or average</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">sum</span>:</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> value <span class="op">/</span> X.shape[<span class="dv">0</span>]</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the value</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(value)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create a grid of guesses</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>guesses <span class="op">=</span> pd.DataFrame(</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    product(</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        np.arange(<span class="dv">1</span>, <span class="dv">7</span>, <span class="fl">0.1</span>),</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        np.arange(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    columns <span class="op">=</span> [<span class="st">'b0'</span>, <span class="st">'b1'</span>]</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Example for one guess</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>ols(</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    par <span class="op">=</span> guesses.iloc[<span class="dv">0</span>,:],</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> df_happiness[<span class="st">'life_exp'</span>],</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>]</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>23.793842044979073</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Now we want to calculate the loss for each guess and find which one gives us the minimum function value. Note that above, we could get the total or mean squared error by setting the <code>sum</code> parameter to <code>TRUE</code> or <code>FALSE</code>. Either is fine, but it’s more common to use the mean, which is a little more understandable - how far do our guess deviate from the true value on average? In the following darker suggests a better mean squared error result from our approach.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="estimation_files/figure-html/r-ols-apply-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If we inspect our results from the built-in functions, we had estimates of 5.44 and 0.89 for our coefficients. These are very similar but not exactly the same, but in the end we can see that we get pretty dang close to what our basic <code>lm</code> or <code>statsmodels</code> functions would get us. Pretty neat!</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled" type="info" title="Estimation as 'Learning'">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estimation as ‘Learning’
</div>
</div>
<div class="callout-body-container callout-body">
<p>Estimation can be seen as the process of a model learning which parameters will best allow the predictions to match the observed data, and hopefully, predict as-yet-unseen future data. This is a very common way to think about estimation in machine learning, and it is a useful way to think about our simple linear model also.</p>
<p>One thing to keep in mind is that it is not a magical process. It takes good data, a good idea (model), and an appropriate estimation method to get good results.</p>
</div>
</div>
</section>
<section id="optimization" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="optimization"><span class="header-section-number">5.7</span> Optimization</h2>
<p>Before we get into other objective functions, let’s think about a better way to find the best parameters for our model. Rather than just guessing, we can use a more systematic approach, and thankfully, there are tools out there to help us. We just use a function like our OLS function, give it a starting point, and let the algorithms do the rest! Thanks to some nifty approaches to making better guesses, these tools eventually arrive at a pretty good set of parameters. Well, they usually do, but not always- nothing’s perfect! But they are pretty good, and they are a lot better than guessing. Let’s see how we can use one of these tools to find the best parameters for our model.</p>
<p>Previously we created a set of guesses to search over to see which set of parameters resulted in prediction that matched the data best. What we did is called a <strong>grid search</strong>, and it is a bit of a brute force approach to finding the best fitting model. You can imagine that a couple of unfortunate or problematic scenarios, such as having a very large number of parameters, or that our specified range doesn’t allow us to get to the right sets of parameters, or we specify a very large range, but the best fitting model is within a very narrow part of that range, such that we waste a lot of time.</p>
<p>In general, we can think of <strong>optimization</strong> as a way to find the best parameters for our model. We start with an initial guess, see how well it does in terms of our objective function, and then try to improve it with a new guess. We continue to do so until a stopping point is reached. Here is an example.</p>
<ul>
<li><strong>Start with an initial guess</strong> for the parameters</li>
<li>Calculate the objective function given the parameters</li>
<li><strong>Update the parameters</strong> to a new guess (that hopefully improves the objective function)</li>
<li>Calculate the objective function given the new parameters</li>
<li><strong>Repeat</strong> until the improvement is small enough or we reach a maximum number of iterations we want to attempt</li>
</ul>
<p>This is what we described before with estimation in general. The key idea now is how we <em>update</em> the old parameters with a new guess at each iteration. Different <strong>optimization algorithms</strong> use different approaches to find the updated parameters. At some point, either the improvement is small enough, or we reach a maximum number of iterations we want to attempt, and either of these is something we can set ourselves. If we meet the terms of our objective, we say that we have reached <strong>convergence</strong>. Sometimes, the number of iterations is not enough for us to reach convergence, and we have to try again with a different set of parameters, a different algorithm, maybe use some data transformations, or something else.</p>
<p>So let’s try it out! Both R and Python offer a function where we can specify the objective function, and it will try to find the best parameters for us. We’ll use the <code>optim</code> function in R and the <code>minimize</code> function in Python. It needs several inputs:</p>
<ul>
<li>the objective function</li>
<li>the initial guess for the parameters to get things going</li>
<li>inputs to the objective function</li>
<li>options for the optimization process, e.g.&nbsp;algorithm, maximum number of iterations, etc.</li>
</ul>
<p>With these inputs, we’ll let the optimization functions do the rest of the work. We’ll also compare our results to the built-in functions to make sure we’re on the right track.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>our_result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">par    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn     =</span> ols,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">X      =</span> df_happiness<span class="sc">$</span>life_exp,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y      =</span> df_happiness<span class="sc">$</span>happiness,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"BFGS"</span> <span class="co"># optimization algorithm</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># our_result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>our_result <span class="op">=</span> minimize(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    fun    <span class="op">=</span> ols,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    x0     <span class="op">=</span> np.array([<span class="fl">1.</span>, <span class="fl">0.</span>]),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    args   <span class="op">=</span> (np.array(df_happiness[<span class="st">'life_exp'</span>]), np.array(df_happiness[<span class="st">'happiness'</span>])),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    method <span class="op">=</span> <span class="st">'BFGS'</span> <span class="co"># optimization algorithm</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># our_result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-r-optim-ols" class="anchored">
<div id="mkmkltskby" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#mkmkltskby table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mkmkltskby thead, #mkmkltskby tbody, #mkmkltskby tfoot, #mkmkltskby tr, #mkmkltskby td, #mkmkltskby th {
  border-style: none;
}

#mkmkltskby p {
  margin: 0;
  padding: 0;
}

#mkmkltskby .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mkmkltskby .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mkmkltskby .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mkmkltskby .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mkmkltskby .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mkmkltskby .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mkmkltskby .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mkmkltskby .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mkmkltskby .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mkmkltskby .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mkmkltskby .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mkmkltskby .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mkmkltskby .gt_spanner_row {
  border-bottom-style: hidden;
}

#mkmkltskby .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mkmkltskby .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mkmkltskby .gt_from_md > :first-child {
  margin-top: 0;
}

#mkmkltskby .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mkmkltskby .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mkmkltskby .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mkmkltskby .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mkmkltskby .gt_row_group_first td {
  border-top-width: 2px;
}

#mkmkltskby .gt_row_group_first th {
  border-top-width: 2px;
}

#mkmkltskby .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkmkltskby .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mkmkltskby .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mkmkltskby .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mkmkltskby .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkmkltskby .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mkmkltskby .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mkmkltskby .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mkmkltskby .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#mkmkltskby .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mkmkltskby .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkmkltskby .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mkmkltskby .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkmkltskby .gt_left {
  text-align: left;
}

#mkmkltskby .gt_center {
  text-align: center;
}

#mkmkltskby .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mkmkltskby .gt_font_normal {
  font-weight: normal;
}

#mkmkltskby .gt_font_bold {
  font-weight: bold;
}

#mkmkltskby .gt_font_italic {
  font-style: italic;
}

#mkmkltskby .gt_super {
  font-size: 65%;
}

#mkmkltskby .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mkmkltskby .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mkmkltskby .gt_indent_1 {
  text-indent: 5px;
}

#mkmkltskby .gt_indent_2 {
  text-indent: 10px;
}

#mkmkltskby .gt_indent_3 {
  text-indent: 15px;
}

#mkmkltskby .gt_indent_4 {
  text-indent: 20px;
}

#mkmkltskby .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption>Table&nbsp;5.1:  <p>Comparison of our results to built-in function</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Built-in">Built-in</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.4450</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.4450</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Life Exp. Coef.</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.8880</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.8880</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Objective/MSE</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.4890</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.4890</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>So our little function and the right tool allows us to come up with the same thing as base R and <code>statsmodels</code>! I hope you’re feeling pretty good at this point because you should! You just proved you could do what seems like magic, but really all it took is just a little knowledge about some key concepts. Let’s try some more!</p>
</section>
<section id="maximum-likelihood" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="maximum-likelihood"><span class="header-section-number">5.8</span> Maximum Likelihood</h2>
<p>In our example thus far, we have been minimizing the specific objective (or loss) function, which basically takes our parameter estimates, produces a prediction, and returns the sum or mean of the squared errors. But this is just one approach we could take. Now we’d like you to think about the <strong>data generating process</strong>. We have a model that says happiness is a function of life expectancy, but more specifically, let’s think about how the observed value of the happiness score is generated in a statistical sense. In particular, what kind of probability distribution might be involved? Ignoring the model, we might think that each happiness value is generated by some random process, and that the process is the same for each observation. Let’s assume that random process is a normal distribution. So something like this would describe it mathematically:</p>
<p><span class="math display">\[
\textrm{happiness} \sim N(\mu, \sigma)
\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the mean of the happiness and <span class="math inline">\(\sigma\)</span> is the standard deviation, or in other words, we can think of happiness as a random variable that is drawn from a normal distribution with <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> as the parameters of that distribution.</p>
<p>Let’s apply this idea to our linear model setting. In this case, the mean is a function of life expectancy, and we’re not sure what the standard deviation is, but we can go ahead and write our model as follows.</p>
<p><span class="math display">\[
\mu = \beta_0 + \beta_1 * \textrm{life\_exp}
\]</span> <span class="math display">\[
\textrm{happiness} \sim N(\mu, \sigma)
\]</span></p>
<p>Now, we can think of the model as a way to estimate the parameters of the normal distribution, but we have an additional parameter to estimate. We still have our previous coefficients, but now we need to estimate <span class="math inline">\(\sigma\)</span>, which is basically our RMSE, as well. But we still have to think of things a little differently. When we compare our prediction to the observed value, we don’t look at the simple difference, but we are still interested in the discrepancy between the two. So now we think about the <strong>likelihood</strong> of observing the happiness score given our prediction, which is based on the estimated parameters, i.e.&nbsp;given the <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(\mu\)</span> is a function of the coefficients and life expectancy. We can write this as:</p>
<p><span class="math display">\[
\textrm{Pr}(\textrm{happiness} \mid \textrm{life\_exp}, \beta_0, \beta_1, \sigma)
\]</span></p>
<p><span class="math display">\[
\textrm{Pr}(\textrm{happiness} \mid \mu, \sigma)
\]</span></p>
<p>Even more generally, the likelihood gives us a sense of the probability given the parameter estimates <span class="math inline">\(\theta\)</span>. <span class="math display">\[
\textrm{Pr}(\textrm{Data} \mid \theta)
\]</span></p>
<p>Here is a simple code demo to get a likelihood in the context of our model. The values you see are referred to statistically as probability density values, and they are technically not probabilities, but rather the probability density, or <strong>relative likelihood</strong>, at that observation<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. For your conceptual understanding, if it makes it easier, you can think of them in the same was as you do probabilities, but just know that technically they are not.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>UPDATE VALUES WHEN DEMO IS SETTLED</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two example life expectancy scores, mean and 1 sd above</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>life_expectancy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># observed happiness scores</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>happiness <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">5.2</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted happiness with rounded coefs</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> life_expectancy</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># just a guess for sigma</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood for each observation</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(happiness, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>L</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1079819 0.2218417</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># two example life expectancy scores, mean and 1 sd above</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>life_expectancy <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># observed happiness scores</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>happiness <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="fl">5.2</span>])</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted happiness with rounded coefs</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="dv">5</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> life_expectancy</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># just a guess for sigma</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">.5</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood for each observation</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> norm.pdf(happiness, loc <span class="op">=</span> mu, scale <span class="op">=</span> sigma)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>L</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0.10798193, 0.22184167])</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Given a guess at the parameters, and an assumption about the distribution of the data, we can calculate the likelihood of observing each data point, and total those sum those up, just like we did with our squared errors. In theory, we’d deal with the product of each likelihood, but in practice we sum the log of the likelihood, otherwise values would get too small for our computers to handle. Here is a corresponding function we can use to calculate the likelihood of the data given our parameters. Note that the actual likelihood value returned isn’t really interpretable, we just use it to compare models with different sets of parameter guesses. Even if our total likelihoods under comparison are negative, we prefer the model with the relatively higher likelihood. As we just demonstrated, we’ll use <code>optim</code> to help us get good guesses<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(par, X, y) {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># setup</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> par[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># coefficients</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">1</span>]) <span class="co"># error sd, exp keeps positive</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    LP <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta <span class="co"># linear predictor</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> LP <span class="co"># identity link in the glm sense</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate (log) likelihood</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    ll <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(y, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">sum</span>(ll) <span class="co"># for minimization</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>our_result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn  =</span> likelihood,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">X   =</span> df_happiness<span class="sc">$</span>life_exp,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y   =</span> df_happiness<span class="sc">$</span>happiness</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co"># our_result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> likelihood(par, X, y):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># setup</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    beta   <span class="op">=</span> par[<span class="dv">1</span>:]         <span class="co"># coefficients</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    sigma  <span class="op">=</span> np.exp(par[<span class="dv">0</span>])  <span class="co"># error sd, exp keeps positive</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> X.shape[<span class="dv">0</span>]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    LP <span class="op">=</span> X <span class="op">@</span> beta          <span class="co"># linear predictor</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> LP                <span class="co"># identity link in the glm sense</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate (log) likelihood</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    ll <span class="op">=</span> norm.logpdf(y, loc <span class="op">=</span> mu, scale <span class="op">=</span> sigma) </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(<span class="op">-</span>np.<span class="bu">sum</span>(ll))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>our_result <span class="op">=</span> minimize(</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    fun  <span class="op">=</span> likelihood,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    x0   <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> (np.array(df_happiness[<span class="st">'life_exp'</span>]), np.array(df_happiness[<span class="st">'happiness'</span>]))</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>How would we switch to a maximum likelihood approach using readily available functions? In both R and Python you can switch to using <code>glm</code> and <code>GLM</code> respectively would be the place to start. We can use different likelihoods distributions corresponding to the binomial, poisson and others. Still other packages would allow even more distributions for consideration. In general, we choose a distribution that we feel best reflects the data generating process. For binary targets for example, we typically would feel a bernoulli or binomial distribution is appropriate. For count data, we might choose a poisson or negative binomial distribution. For targets that fall between 0 and 1, we might go for a beta distribution. There are many distributions, and even when some might feel more appropriate, we might choose another for convenience. Some distributions tend toward a normal (a.k.a. gaussian) distribution depending on various factors, while others are special cases of more general distributions. For example, the exponential distribution is a special case of the gamma distribution, and a cauchy is equivalent to a t distribution with 1 degree of freedom, and the t tends toward a normal with increasing degrees of freedom. Here is a visualization of the relationships among some of the more common distributions.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-distribution-relationships" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/distribution_relationships.jpg" class="img-fluid figure-img" width="1643"></p>
<figcaption class="figure-caption">Figure&nbsp;5.1: Relationships among some of univariate probability distributions. Image from <a href="https://en.wikipedia.org/wiki/File:Relationships_among_some_of_univariate_probability_distributions.jpg">Wikipedia</a></figcaption>
</figure>
</div>
</div>
</div>
<p>Here are examples of standard GLM functions in R and Python</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(happiness <span class="sc">~</span> life_exp, <span class="at">data =</span> df_happiness, <span class="at">family =</span> gaussian)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(binary_target <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> some_data, <span class="at">family =</span> binomial)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(count <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> some_data, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>smf.glm(<span class="st">'happiness ~ life_exp'</span>, data <span class="op">=</span> df_happiness, family <span class="op">=</span> sm.families.Gaussian())</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>smf.glm(<span class="st">'binary_target ~ x1 + x2'</span>, data <span class="op">=</span> some_data, family <span class="op">=</span> sm.families.Binomial())</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>smf.glm(<span class="st">'count ~ x1 + x2'</span>, data <span class="op">=</span> some_data, family <span class="op">=</span> sm.families.Poisson())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>With that in mind, we can compare our result to a built-in function that has capabilities beyond OLS. As before, we’re duplicating the basic glm result. We show more decimal places on the log likelihood estimate to prove we aren’t getting <em>exactly</em> the same result</p>
<div id="tbl-r-likelihood" class="cell tbl-parent anchored">
<div class="cell-output-display">
<div id="jyxzbnzpsb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#jyxzbnzpsb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jyxzbnzpsb thead, #jyxzbnzpsb tbody, #jyxzbnzpsb tfoot, #jyxzbnzpsb tr, #jyxzbnzpsb td, #jyxzbnzpsb th {
  border-style: none;
}

#jyxzbnzpsb p {
  margin: 0;
  padding: 0;
}

#jyxzbnzpsb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jyxzbnzpsb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jyxzbnzpsb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jyxzbnzpsb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jyxzbnzpsb .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jyxzbnzpsb .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jyxzbnzpsb .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jyxzbnzpsb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jyxzbnzpsb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jyxzbnzpsb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jyxzbnzpsb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jyxzbnzpsb .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jyxzbnzpsb .gt_spanner_row {
  border-bottom-style: hidden;
}

#jyxzbnzpsb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jyxzbnzpsb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jyxzbnzpsb .gt_from_md > :first-child {
  margin-top: 0;
}

#jyxzbnzpsb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jyxzbnzpsb .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jyxzbnzpsb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jyxzbnzpsb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jyxzbnzpsb .gt_row_group_first td {
  border-top-width: 2px;
}

#jyxzbnzpsb .gt_row_group_first th {
  border-top-width: 2px;
}

#jyxzbnzpsb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jyxzbnzpsb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jyxzbnzpsb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jyxzbnzpsb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jyxzbnzpsb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jyxzbnzpsb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jyxzbnzpsb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jyxzbnzpsb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jyxzbnzpsb .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#jyxzbnzpsb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jyxzbnzpsb .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jyxzbnzpsb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jyxzbnzpsb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jyxzbnzpsb .gt_left {
  text-align: left;
}

#jyxzbnzpsb .gt_center {
  text-align: center;
}

#jyxzbnzpsb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jyxzbnzpsb .gt_font_normal {
  font-weight: normal;
}

#jyxzbnzpsb .gt_font_bold {
  font-weight: bold;
}

#jyxzbnzpsb .gt_font_italic {
  font-style: italic;
}

#jyxzbnzpsb .gt_super {
  font-size: 65%;
}

#jyxzbnzpsb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jyxzbnzpsb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jyxzbnzpsb .gt_indent_1 {
  text-indent: 5px;
}

#jyxzbnzpsb .gt_indent_2 {
  text-indent: 10px;
}

#jyxzbnzpsb .gt_indent_3 {
  text-indent: 15px;
}

#jyxzbnzpsb .gt_indent_4 {
  text-indent: 20px;
}

#jyxzbnzpsb .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Built-in">Built-in</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.44</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.44</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Life Exp. Coef.</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.89</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.89</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Sigma</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.71</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.70<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">LogLik (neg)</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">118.80</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">118.80</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Parameter estimate is exponentiated</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<p><strong>?(caption)</strong></p>
</div>
<p>Let’s think more about what’s going on here. It turns out that our objective function defines a space or surface. We can think of it as a landscape, and we are trying to find the lowest point on that landscape. We can then think of our guesses as points on that landscape, and we are trying to find the lowest point. Let’s start get a sense of this with the following visualization, based on a single parameter. The data is drawn from Poisson distributed variable with true mean <span class="math inline">\(\theta=5\)</span>. We note the calculated likelihood increases as we estimate values for <span class="math inline">\(\theta\)</span> closer to <span class="math inline">\(5\)</span>, or more precisely, whatever the mean observed value is for the data. However, with more and more data, the final ML estimate will converge on the true value. Model estimation finds that maximum on the curve, and optimization algorithms are the means to find it.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-likelihood-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="estimation_files/figure-html/fig-r-likelihood-plot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5.2: Likelihood function one parameter</figcaption>
</figure>
</div>
</div>
</div>
<p>Now let’s add a parameter. If we have more than one parameter, we now have a surfaace to deal with. Given some starting point, an optimization procedure then travels along the surface looking for a minimum/maximum point. For simpler settings such as this, we can visualize the likelihood surface and its minimum point. However, even our simple demo model has three parameters plus the likelihood, so would be difficult to visualize without additional complexity. To get around this, we show the results for an alternate model where happiness is standardized also, which means the intercept is zero<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>, and we don’t have to show that.</p>
<p>CANT DO INTERACTIVE WITH PDF/LATEX. NEED WORKAROUND.</p>
<div class="cell">
<div id="fig-r-likelihood-plot-3d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2a358d522d1f42144f36" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2a358d522d1f42144f36">{"x":{"visdat":{"8ac221e9428b":["function () ","plotlyVisDat"]},"cur_data":"8ac221e9428b","attrs":{"8ac221e9428b":{"z":{},"x":{},"y":{},"showscale":false,"colors":["#FDF4D9","#FCF4D8","#FBF2D7","#FBF1D6","#FAF0D5","#FBF0D4","#FAEFD3","#FAEED2","#F9EDD0","#F9EDCF","#F8ECCE","#F8EBCD","#F7EACC","#F7E9CB","#F6E8CA","#F6E8C9","#F5E7C8","#F6E6C6","#F5E5C5","#F5E5C4","#F4E4C3","#F4E3C2","#F3E2C1","#F3E1C0","#F2E0BF","#F2E0BE","#F1DFBD","#F2DEBB","#F1DDBA","#F1DDB9","#F0DCB8","#F0DBB7","#EFDAB6","#EFDAB5","#EED9B4","#EFD8B3","#EED7B2","#EED6B1","#EDD5B0","#EDD5AF","#ECD4AE","#EDD3AD","#ECD2AC","#ECD2AB","#EBD1AA","#EBD0A9","#EBCFA7","#EACEA6","#EACDA5","#E9CCA4","#EACCA3","#E9CBA2","#E9CAA1","#E8C9A0","#E9C99F","#E8C89E","#E8C79D","#E7C69C","#E8C69C","#E7C59B","#E7C49A","#E6C399","#E6C398","#E7C297","#E7C197","#E6C096","#E6C095","#E5BF94","#E5BE93","#E6BD92","#E5BD92","#E6BC91","#E6BC90","#E5BB8F","#E5BA8F","#E4B98E","#E4B98E","#E5B88D","#E5B88C","#E4B78B","#E4B68B","#E5B58A","#E5B58A","#E5B489","#E5B488","#E5B387","#E5B287","#E5B186","#E5B186","#E4B085","#E5B085","#E5AF84","#E4AE83","#E4AD82","#E5AC81","#E5AC81","#E6AB80","#E6AB80","#E5AA7F","#E5AA7F","#E6A97E","#E5A87E","#E6A77D","#E6A77D","#E5A67C","#E5A67C","#E6A57B","#E6A57B","#E7A47A","#E7A37A","#E6A279","#E7A279","#E6A178","#E6A178","#E7A077","#E7A077","#E89F76","#E89E77","#E79D76","#E89D76","#E79C75","#E79C75","#E89B74","#E89B74","#E99A73","#E99973","#E89872","#E89872","#E99771","#E99771","#E89670","#E89570","#E9946F","#E9946F","#EA936E","#EA926E","#E9916D","#EA906D","#EA906D","#EA8F6C","#E98E6C","#EA8D6B","#EA8D6B","#E98C6A","#E98B6A","#EA8A69","#EA8A69","#E98968","#E98868","#E88767","#E88768","#E98667","#E88567","#E98466","#E98466","#E88365","#E88265","#E78164","#E88165","#E78064","#E77F64","#E67E63","#E77E63","#E67D62","#E67C63","#E57B62","#E57B62","#E47A61","#E47A61","#E37960","#E37861","#E27760","#E27760","#E1765F","#E1765F","#E07560","#E07460","#DF735F","#DF735F","#DE725E","#DE725E","#DD715F","#DC705F","#DB705F","#DA6F5E","#DA6F5E","#D96E5D","#D86E5D","#D76D5E","#D76D5E","#D66C5D","#D56C5D","#D46B5E","#D46B5E","#D36A5D","#D26A5D","#D1695E","#D06A5E","#CF695D","#CF695D","#CE685E","#CD685E","#CC675F","#CB685F","#CA675E","#CA675E","#C9665F","#C8675F","#C7665E","#C6665E","#C5655F","#C5655F","#C46660","#C36660","#C2655F","#C1655F","#C06460","#BF6460","#BE6561","#BE6561","#BD6460","#BC6460","#BB6361","#BA6361","#B86462","#B86362","#B76461","#B66362","#B66362","#B46263","#B36262","#B26363","#B26363","#B16264","#B06264","#AF6363","#AE6363","#AD6264","#AD6264","#AC6365","#AB6365","#AA6264","#AA6264","#A96165","#A86165","#A76266","#A66265","#A56166","#A56166","#A46267","#A36267","#A26166","#A26166","#A16267","#A06267","#9F6168","#9F6167","#9E6268","#9D6268","#9C6169","#9B6169","#9A6068","#9A6068","#996169","#986169","#97606A","#976069","#96616A","#96606A","#95606B","#94606B","#93606A","#93606A","#91606B","#90606C","#90616C","#8F606B","#8E606B","#8D616C","#8D616C","#8C606D","#8C606C","#8B5F6D","#8A5F6D","#89606E","#89606E","#885F6D","#875F6D","#86606E","#865F6E","#855F6F","#855F6F","#845F6E","#835F6E","#825F6F","#825F6F","#815F70","#815F70","#805F6F","#805F6F","#7F6070","#7E6070","#7D5F71","#7D5F71","#7C6070","#7C6070","#7B5F71","#7A5F71","#795E72","#795E72","#785F71","#785F71","#775E72","#775F72","#765F73","#765F73","#755F72","#745F72","#735F73","#725F74","#725F74","#715F73","#715F74","#705F73","#705F73","#6F5F74","#6E5E74","#6D5F75","#6D5F75","#6C5E74","#6C5E74","#6B5F75","#6B5F75","#6A5E76","#6A5E76","#695D75","#695D75","#685E76","#685E76","#675D77","#665D77","#655E76","#655E77","#645E76","#645E76","#635D77","#635D77","#625E78","#625E78","#615D77","#615D78","#605E77","#605E77","#5F5D78","#5E5D78","#5D5C79","#5D5C79","#5C5D78","#5C5D79","#5B5C78","#5B5D78","#5A5C79","#5A5C79","#595D7A","#575C79","#575C79","#565B7A","#565B7A","#555C79","#545B79","#535C79","#535C79","#525B7A","#525B7A","#515A79","#505A79","#4F5B7A","#4F5B7A","#4E5A7B","#4D5A7B","#4C597A","#4C5A7A","#4B5979","#4A5979","#49587A","#48597A","#475879","#47587A","#465779","#455879","#44577A","#43577A","#425679","#415679","#405578","#3F5679","#3E5578","#3E5578","#3D5477","#3C5478","#3B5377","#3A5377","#395276","#385277","#375176","#365176","#355075","#345075","#324F74","#304E73","#2F4E73","#2E4D72","#2D4D72","#2C4C71","#2B4C71","#2A4B70","#294B70","#284A6F","#27496F","#26486E","#25486D","#24476C","#24476C","#23466B","#22466B","#21456A","#204469","#1F4368","#1E4368","#1D4267","#1D4266","#1C4165","#1B4064","#1A3F63","#193F63","#183E62","#183E61","#173D60","#163C5F","#153B5E","#153B5E","#143A5D","#14395C","#13385B","#13385A","#123759","#113758","#103657","#103557","#0F3456","#0F3455","#0E3354","#0E3353","#0D3152","#0C3050","#0D304F","#0C2F4E","#0C2E4D","#0B2D4C","#0B2D4B","#0A2C4A","#0A2C4A","#092B49","#0A2A48","#092947","#092946","#082845","#092844","#082743","#082642","#072541","#082540","#07243F","#07243E","#06233D","#06223C","#07213B","#07213A","#062039","#062038","#051F37","#051F37","#061E36","#061D35","#051C34","#051C33","#041B32","#041B31","#051A30","#041A2F","#05192E","#05182D","#04172C","#04172B","#03162A","#031629","#041528","#041428","#031327","#021326"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"},"8ac221e9428b.1":{"z":104.93884673492462,"x":0.61751761812201755,"y":0.78437129136747719,"showscale":false,"colors":["#FDF4D9","#FCF4D8","#FBF2D7","#FBF1D6","#FAF0D5","#FBF0D4","#FAEFD3","#FAEED2","#F9EDD0","#F9EDCF","#F8ECCE","#F8EBCD","#F7EACC","#F7E9CB","#F6E8CA","#F6E8C9","#F5E7C8","#F6E6C6","#F5E5C5","#F5E5C4","#F4E4C3","#F4E3C2","#F3E2C1","#F3E1C0","#F2E0BF","#F2E0BE","#F1DFBD","#F2DEBB","#F1DDBA","#F1DDB9","#F0DCB8","#F0DBB7","#EFDAB6","#EFDAB5","#EED9B4","#EFD8B3","#EED7B2","#EED6B1","#EDD5B0","#EDD5AF","#ECD4AE","#EDD3AD","#ECD2AC","#ECD2AB","#EBD1AA","#EBD0A9","#EBCFA7","#EACEA6","#EACDA5","#E9CCA4","#EACCA3","#E9CBA2","#E9CAA1","#E8C9A0","#E9C99F","#E8C89E","#E8C79D","#E7C69C","#E8C69C","#E7C59B","#E7C49A","#E6C399","#E6C398","#E7C297","#E7C197","#E6C096","#E6C095","#E5BF94","#E5BE93","#E6BD92","#E5BD92","#E6BC91","#E6BC90","#E5BB8F","#E5BA8F","#E4B98E","#E4B98E","#E5B88D","#E5B88C","#E4B78B","#E4B68B","#E5B58A","#E5B58A","#E5B489","#E5B488","#E5B387","#E5B287","#E5B186","#E5B186","#E4B085","#E5B085","#E5AF84","#E4AE83","#E4AD82","#E5AC81","#E5AC81","#E6AB80","#E6AB80","#E5AA7F","#E5AA7F","#E6A97E","#E5A87E","#E6A77D","#E6A77D","#E5A67C","#E5A67C","#E6A57B","#E6A57B","#E7A47A","#E7A37A","#E6A279","#E7A279","#E6A178","#E6A178","#E7A077","#E7A077","#E89F76","#E89E77","#E79D76","#E89D76","#E79C75","#E79C75","#E89B74","#E89B74","#E99A73","#E99973","#E89872","#E89872","#E99771","#E99771","#E89670","#E89570","#E9946F","#E9946F","#EA936E","#EA926E","#E9916D","#EA906D","#EA906D","#EA8F6C","#E98E6C","#EA8D6B","#EA8D6B","#E98C6A","#E98B6A","#EA8A69","#EA8A69","#E98968","#E98868","#E88767","#E88768","#E98667","#E88567","#E98466","#E98466","#E88365","#E88265","#E78164","#E88165","#E78064","#E77F64","#E67E63","#E77E63","#E67D62","#E67C63","#E57B62","#E57B62","#E47A61","#E47A61","#E37960","#E37861","#E27760","#E27760","#E1765F","#E1765F","#E07560","#E07460","#DF735F","#DF735F","#DE725E","#DE725E","#DD715F","#DC705F","#DB705F","#DA6F5E","#DA6F5E","#D96E5D","#D86E5D","#D76D5E","#D76D5E","#D66C5D","#D56C5D","#D46B5E","#D46B5E","#D36A5D","#D26A5D","#D1695E","#D06A5E","#CF695D","#CF695D","#CE685E","#CD685E","#CC675F","#CB685F","#CA675E","#CA675E","#C9665F","#C8675F","#C7665E","#C6665E","#C5655F","#C5655F","#C46660","#C36660","#C2655F","#C1655F","#C06460","#BF6460","#BE6561","#BE6561","#BD6460","#BC6460","#BB6361","#BA6361","#B86462","#B86362","#B76461","#B66362","#B66362","#B46263","#B36262","#B26363","#B26363","#B16264","#B06264","#AF6363","#AE6363","#AD6264","#AD6264","#AC6365","#AB6365","#AA6264","#AA6264","#A96165","#A86165","#A76266","#A66265","#A56166","#A56166","#A46267","#A36267","#A26166","#A26166","#A16267","#A06267","#9F6168","#9F6167","#9E6268","#9D6268","#9C6169","#9B6169","#9A6068","#9A6068","#996169","#986169","#97606A","#976069","#96616A","#96606A","#95606B","#94606B","#93606A","#93606A","#91606B","#90606C","#90616C","#8F606B","#8E606B","#8D616C","#8D616C","#8C606D","#8C606C","#8B5F6D","#8A5F6D","#89606E","#89606E","#885F6D","#875F6D","#86606E","#865F6E","#855F6F","#855F6F","#845F6E","#835F6E","#825F6F","#825F6F","#815F70","#815F70","#805F6F","#805F6F","#7F6070","#7E6070","#7D5F71","#7D5F71","#7C6070","#7C6070","#7B5F71","#7A5F71","#795E72","#795E72","#785F71","#785F71","#775E72","#775F72","#765F73","#765F73","#755F72","#745F72","#735F73","#725F74","#725F74","#715F73","#715F74","#705F73","#705F73","#6F5F74","#6E5E74","#6D5F75","#6D5F75","#6C5E74","#6C5E74","#6B5F75","#6B5F75","#6A5E76","#6A5E76","#695D75","#695D75","#685E76","#685E76","#675D77","#665D77","#655E76","#655E77","#645E76","#645E76","#635D77","#635D77","#625E78","#625E78","#615D77","#615D78","#605E77","#605E77","#5F5D78","#5E5D78","#5D5C79","#5D5C79","#5C5D78","#5C5D79","#5B5C78","#5B5D78","#5A5C79","#5A5C79","#595D7A","#575C79","#575C79","#565B7A","#565B7A","#555C79","#545B79","#535C79","#535C79","#525B7A","#525B7A","#515A79","#505A79","#4F5B7A","#4F5B7A","#4E5A7B","#4D5A7B","#4C597A","#4C5A7A","#4B5979","#4A5979","#49587A","#48597A","#475879","#47587A","#465779","#455879","#44577A","#43577A","#425679","#415679","#405578","#3F5679","#3E5578","#3E5578","#3D5477","#3C5478","#3B5377","#3A5377","#395276","#385277","#375176","#365176","#355075","#345075","#324F74","#304E73","#2F4E73","#2E4D72","#2D4D72","#2C4C71","#2B4C71","#2A4B70","#294B70","#284A6F","#27496F","#26486E","#25486D","#24476C","#24476C","#23466B","#22466B","#21456A","#204469","#1F4368","#1E4368","#1D4267","#1D4266","#1C4165","#1B4064","#1A3F63","#193F63","#183E62","#183E61","#173D60","#163C5F","#153B5E","#153B5E","#143A5D","#14395C","#13385B","#13385A","#123759","#113758","#103657","#103557","#0F3456","#0F3455","#0E3354","#0E3353","#0D3152","#0C3050","#0D304F","#0C2F4E","#0C2E4D","#0B2D4C","#0B2D4B","#0A2C4A","#0A2C4A","#092B49","#0A2A48","#092947","#092946","#082845","#092844","#082743","#082642","#072541","#082540","#07243F","#07243E","#06233D","#06223C","#07213B","#07213A","#062039","#062038","#051F37","#051F37","#061E36","#061D35","#051C34","#051C33","#041B32","#041B31","#051A30","#041A2F","#05192E","#05182D","#04172C","#04172B","#03162A","#031629","#041528","#041428","#031327","#021326"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","showlegend":false,"inherit":true},"8ac221e9428b.2":{"z":{},"x":{},"y":{},"showscale":false,"colors":["#FDF4D9","#FCF4D8","#FBF2D7","#FBF1D6","#FAF0D5","#FBF0D4","#FAEFD3","#FAEED2","#F9EDD0","#F9EDCF","#F8ECCE","#F8EBCD","#F7EACC","#F7E9CB","#F6E8CA","#F6E8C9","#F5E7C8","#F6E6C6","#F5E5C5","#F5E5C4","#F4E4C3","#F4E3C2","#F3E2C1","#F3E1C0","#F2E0BF","#F2E0BE","#F1DFBD","#F2DEBB","#F1DDBA","#F1DDB9","#F0DCB8","#F0DBB7","#EFDAB6","#EFDAB5","#EED9B4","#EFD8B3","#EED7B2","#EED6B1","#EDD5B0","#EDD5AF","#ECD4AE","#EDD3AD","#ECD2AC","#ECD2AB","#EBD1AA","#EBD0A9","#EBCFA7","#EACEA6","#EACDA5","#E9CCA4","#EACCA3","#E9CBA2","#E9CAA1","#E8C9A0","#E9C99F","#E8C89E","#E8C79D","#E7C69C","#E8C69C","#E7C59B","#E7C49A","#E6C399","#E6C398","#E7C297","#E7C197","#E6C096","#E6C095","#E5BF94","#E5BE93","#E6BD92","#E5BD92","#E6BC91","#E6BC90","#E5BB8F","#E5BA8F","#E4B98E","#E4B98E","#E5B88D","#E5B88C","#E4B78B","#E4B68B","#E5B58A","#E5B58A","#E5B489","#E5B488","#E5B387","#E5B287","#E5B186","#E5B186","#E4B085","#E5B085","#E5AF84","#E4AE83","#E4AD82","#E5AC81","#E5AC81","#E6AB80","#E6AB80","#E5AA7F","#E5AA7F","#E6A97E","#E5A87E","#E6A77D","#E6A77D","#E5A67C","#E5A67C","#E6A57B","#E6A57B","#E7A47A","#E7A37A","#E6A279","#E7A279","#E6A178","#E6A178","#E7A077","#E7A077","#E89F76","#E89E77","#E79D76","#E89D76","#E79C75","#E79C75","#E89B74","#E89B74","#E99A73","#E99973","#E89872","#E89872","#E99771","#E99771","#E89670","#E89570","#E9946F","#E9946F","#EA936E","#EA926E","#E9916D","#EA906D","#EA906D","#EA8F6C","#E98E6C","#EA8D6B","#EA8D6B","#E98C6A","#E98B6A","#EA8A69","#EA8A69","#E98968","#E98868","#E88767","#E88768","#E98667","#E88567","#E98466","#E98466","#E88365","#E88265","#E78164","#E88165","#E78064","#E77F64","#E67E63","#E77E63","#E67D62","#E67C63","#E57B62","#E57B62","#E47A61","#E47A61","#E37960","#E37861","#E27760","#E27760","#E1765F","#E1765F","#E07560","#E07460","#DF735F","#DF735F","#DE725E","#DE725E","#DD715F","#DC705F","#DB705F","#DA6F5E","#DA6F5E","#D96E5D","#D86E5D","#D76D5E","#D76D5E","#D66C5D","#D56C5D","#D46B5E","#D46B5E","#D36A5D","#D26A5D","#D1695E","#D06A5E","#CF695D","#CF695D","#CE685E","#CD685E","#CC675F","#CB685F","#CA675E","#CA675E","#C9665F","#C8675F","#C7665E","#C6665E","#C5655F","#C5655F","#C46660","#C36660","#C2655F","#C1655F","#C06460","#BF6460","#BE6561","#BE6561","#BD6460","#BC6460","#BB6361","#BA6361","#B86462","#B86362","#B76461","#B66362","#B66362","#B46263","#B36262","#B26363","#B26363","#B16264","#B06264","#AF6363","#AE6363","#AD6264","#AD6264","#AC6365","#AB6365","#AA6264","#AA6264","#A96165","#A86165","#A76266","#A66265","#A56166","#A56166","#A46267","#A36267","#A26166","#A26166","#A16267","#A06267","#9F6168","#9F6167","#9E6268","#9D6268","#9C6169","#9B6169","#9A6068","#9A6068","#996169","#986169","#97606A","#976069","#96616A","#96606A","#95606B","#94606B","#93606A","#93606A","#91606B","#90606C","#90616C","#8F606B","#8E606B","#8D616C","#8D616C","#8C606D","#8C606C","#8B5F6D","#8A5F6D","#89606E","#89606E","#885F6D","#875F6D","#86606E","#865F6E","#855F6F","#855F6F","#845F6E","#835F6E","#825F6F","#825F6F","#815F70","#815F70","#805F6F","#805F6F","#7F6070","#7E6070","#7D5F71","#7D5F71","#7C6070","#7C6070","#7B5F71","#7A5F71","#795E72","#795E72","#785F71","#785F71","#775E72","#775F72","#765F73","#765F73","#755F72","#745F72","#735F73","#725F74","#725F74","#715F73","#715F74","#705F73","#705F73","#6F5F74","#6E5E74","#6D5F75","#6D5F75","#6C5E74","#6C5E74","#6B5F75","#6B5F75","#6A5E76","#6A5E76","#695D75","#695D75","#685E76","#685E76","#675D77","#665D77","#655E76","#655E77","#645E76","#645E76","#635D77","#635D77","#625E78","#625E78","#615D77","#615D78","#605E77","#605E77","#5F5D78","#5E5D78","#5D5C79","#5D5C79","#5C5D78","#5C5D79","#5B5C78","#5B5D78","#5A5C79","#5A5C79","#595D7A","#575C79","#575C79","#565B7A","#565B7A","#555C79","#545B79","#535C79","#535C79","#525B7A","#525B7A","#515A79","#505A79","#4F5B7A","#4F5B7A","#4E5A7B","#4D5A7B","#4C597A","#4C5A7A","#4B5979","#4A5979","#49587A","#48597A","#475879","#47587A","#465779","#455879","#44577A","#43577A","#425679","#415679","#405578","#3F5679","#3E5578","#3E5578","#3D5477","#3C5478","#3B5377","#3A5377","#395276","#385277","#375176","#365176","#355075","#345075","#324F74","#304E73","#2F4E73","#2E4D72","#2D4D72","#2C4C71","#2B4C71","#2A4B70","#294B70","#284A6F","#27496F","#26486E","#25486D","#24476C","#24476C","#23466B","#22466B","#21456A","#204469","#1F4368","#1E4368","#1D4267","#1D4266","#1C4165","#1B4064","#1A3F63","#193F63","#183E62","#183E61","#173D60","#163C5F","#153B5E","#153B5E","#143A5D","#14395C","#13385B","#13385A","#123759","#113758","#103657","#103557","#0F3456","#0F3455","#0E3354","#0E3353","#0D3152","#0C3050","#0D304F","#0C2F4E","#0C2E4D","#0B2D4C","#0B2D4B","#0A2C4A","#0A2C4A","#092B49","#0A2A48","#092947","#092946","#082845","#092844","#082743","#082642","#072541","#082540","#07243F","#07243E","#06233D","#06223C","#07213B","#07213A","#062039","#062038","#051F37","#051F37","#061E36","#061D35","#051C34","#051C33","#041B32","#041B31","#051A30","#041A2F","#05192E","#05182D","#04172C","#04172B","#03162A","#031629","#041528","#041428","#031327","#021326"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","contours":{"z":{"show":true,"usecolormap":true,"highlightcolor":"#ff0000","start":104.93884673492462,"end":128.76351163328218,"size":1,"project":{"z":true}}},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"zeroline":false,"showgrid":false},"yaxis":{"zeroline":false,"showgrid":false},"plot_bgcolor":"transparent","paper_bgcolor":"transparent","scene":{"xaxis":{"title":"sigma","range":[0.5,1]},"yaxis":{"title":"b1","range":[0.5,1]},"zaxis":{"title":"-LL","angle":-90,"range":[100,135]},"camera":{"eye":{"x":1.25,"y":2,"z":1}},"paper_bgcolor":"rgba(0,0,0,0)","plot_bgcolor":"rgba(0,0,0,0)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"colorbar":{"title":"llsurf<br />llsurf","ticklen":2},"colorscale":[["0","rgba(253,244,217,1)"],["0.0416666666666665","rgba(244,227,194,1)"],["0.083333333333333","rgba(236,210,172,1)"],["0.125","rgba(230,195,152,1)"],["0.166666666666667","rgba(229,180,137,1)"],["0.208333333333333","rgba(229,166,124,1)"],["0.25","rgba(233,153,115,1)"],["0.291666666666667","rgba(234,138,105,1)"],["0.333333333333333","rgba(229,123,98,1)"],["0.375","rgba(216,110,93,1)"],["0.416666666666666","rgba(199,102,94,1)"],["0.458333333333333","rgba(181,98,99,1)"],["0.5","rgba(164,98,103,1)"],["0.541666666666667","rgba(148,96,107,1)"],["0.583333333333334","rgba(133,95,111,1)"],["0.625","rgba(119,94,114,1)"],["0.666666666666667","rgba(106,94,118,1)"],["0.708333333333333","rgba(95,93,120,1)"],["0.75","rgba(81,90,121,1)"],["0.791666666666667","rgba(63,86,121,1)"],["0.833333333333333","rgba(41,75,112,1)"],["0.875","rgba(23,61,96,1)"],["0.916666666666667","rgba(12,46,77,1)"],["0.958333333333333","rgba(6,32,57,1)"],["1","rgba(2,19,38,1)"]],"showscale":false,"z":[[128.65821515364468,126.82748286037244,125.19036329109143,123.73043416050049,122.43287085267794,121.28426705741521,120.27247827914593,119.38648495787983,118.61627245416614,117.95272557483929,117.38753566941442,116.91311862155619,116.52254230654486,116.20946229257358,115.96806473792188,115.79301558314111,115.67941526192993,115.6227582601192,115.61889694218308,115.66400914150127,115.75456907629393,115.88732120949072,116.05925671920838,116.26759228821584,116.50975095676597,116.783344814309,117.08615933259752,117.4161391661318,117.77137526629411,118.15009317330308,118.55064236565138,118.97148656027871,119.41119486864226,119.86843372430418,120.34195950684783,120.83061179503656,121.33330718926784,121.84903364969163,122.37684530194201,122.91585766738226,123.46524327914987,124.02422764919194,124.59208555495105,125.16813761745144,125.75174714529685,126.34231722155072,126.93928801267569,127.54213428067852,128.15036308137601,128.76351163328218],[127.39295467851532,125.6123267000582,124.02239312546831,122.6069539826952,121.35138619593687,120.24246650844886,119.26821698963006,118.41776990660891,117.68124924678366,117.04966659719793,116.51482943534789,116.06926017689355,115.70612456916628,115.41916822369068,115.20266025296709,115.0513431220118,114.96038794813458,114.92535458684422,114.942155930647,115.0070259233383,115.11649085726731,115.26734357667735,115.45662025803286,115.68157947942234,115.93968332666921,116.22858031453077,116.54608992801344,116.89018861197916,117.25899705735736,117.65076864983402,118.06387896222472,118.49681618515594,118.94817240243502,119.41663562781605,119.90098252894309,120.4000717722495,120.91283792964354,121.4382858940418,121.97548575632356,122.52356810116511,123.08171968354507,123.64917945156412,124.22523488464724,124.80921861924895,125.40050533690444,125.99850889190088,126.60267965801792,127.21250207573216,127.8274923830249,128.44719651449984],[126.17392494057876,124.44157053974396,122.89709885373216,121.5245241007478,120.30941738113233,119.23873180310397,118.30064991499012,117.48445026350126,116.78039039766523,116.17960405237464,115.67401058996276,115.25623506556417,114.91953752246228,114.65775032546334,114.46522251026475,114.33677027025749,114.2676328236882,114.25343300723316,114.29014202982593,114.37404789548673,114.50172706798234,114.67001900508845,114.87600323744454,115.11697870766587,115.3904451204794,115.69408608502278,116.02575385676262,116.38345550935009,116.76534038662273,117.16968870230191,117.59490117007837,118.03948956003319,118.50206808894842,118.98134556226201,119.47611819438283,119.98526304197944,120.50773199181859,121.04254625088532,121.58879129195768,122.14561221263389,122.71220947008892,123.28783495763992,123.87178839258283,124.46341398777618,125.06209738213677,125.66726280761097,126.2783704723353,126.89491414161915,127.5164189001058,128.14243908001563],[125.00112593983508,123.31521437942961,121.81448047588303,120.48314451465843,119.30696440826463,118.27306294138047,117.36977705522627,116.58652602855679,115.91369590681093,115.34253794036935,114.86507913325903,114.47404328756819,114.16278116643279,113.92520859789164,113.75575150981486,113.64929702787822,113.601149888591,113.60699352128604,113.66285523971999,113.76507505794655,113.91027770843912,114.095347494724,114.31740565744349,114.57378997294643,114.86203633819646,115.17986212578508,115.52515111884522,115.89593985824453,116.29040525409019,116.70685333070658,117.14370898921221,117.59950668491049,118.07288192818243,118.56256352764187,119.06736650316699,119.58618560422634,120.11798937579287,120.66181472022203,121.21676190884425,121.7819900017887,122.35671263878159,122.94019416741945,123.53174607875773,124.13072372303301,124.73652328099378,125.34857896868091,125.96636045562784,126.58937047833939,127.21714263261875,127.8492393298297],[123.87455767628411,122.23325821911536,120.77453799192085,119.48281522442711,118.3440272773334,117.34545992327843,116.47559841033851,115.7239972017757,115.08116577422061,114.53846826118217,114.08803506523671,113.72268484290548,113.43585550107787,113.22154304097556,113.07424725161738,112.98892339487386,112.96093914284292,112.98603612900281,113.06029556032921,113.18010741071782,113.34214277863741,113.54332904558412,113.78082751802955,114.05201327526393,114.35445697982043,114.68590843681764,115.04428171426106,115.42764165866248,115.83419165975961,116.26226253504814,116.71030241962634,117.17686755978762,117.66061392013708,118.16028952395571,118.6747274552957,119.20283945899031,119.74361008156649,120.29609130205202,120.85939760698328,121.43270146862926,122.01522918962296,122.60625708090272,123.20510794317198,123.81114782501966,124.42378303347546,125.04245737511083,125.66664960789528,126.29587108589305,126.92966358056368,127.56759726394203],[122.79422014992608,121.19570205880107,119.77727140184557,118.52353623005368,117.42060598833891,116.45592274879776,115.61811398032663,114.89686378315785,114.28279999989449,113.76739501481308,113.34287838589582,113.0021597315761,112.7387605263975,112.54675365471495,112.42070973567239,112.35564937124455,112.34700058644394,112.39056083038356,112.48246299165335,112.6191449538005,112.79732227857741,113.01396365766868,113.26626881920274,113.55164861461861,113.86770704535138,114.21222501812051,114.58314564301028,114.97856091060406,115.39669960363116,115.83591631532673,116.29468146132064,116.77157218466489,117.26526406481227,117.77452355120353,118.29820105076882,118.83522460627125,119.3845941091394,119.94537599637516,120.51669838637483,121.09774661315599,121.68775912261304,122.28602369808972,122.8918739858255,123.5046862937359,124.12387663958187,124.74889802690056,125.37923792913793,126.01441596427999,126.65398174394073,127.29751288235251],[121.76011336076088,120.20254589848682,118.82268070565739,117.60530753153827,116.53670054128098,115.60445141793845,114.7973237651909,114.10512577270323,113.51859858383249,113.02931820126204,112.62960909523635,112.31246795358011,112.07149624239169,111.9008404391099,111.79513896197984,111.74947495699024,111.75933421939409,111.82056762542818,111.92935753369257,112.08218768719462,112.27581620825907,112.50725133097772,112.77372956096319,113.07269599101024,113.40178653478927,113.75881186969357,114.14174290509283,114.5486976140691,114.9779290857048,115.42781467154204,115.8968461142952,116.38362055954217,116.88683236220817,117.40526560938528,117.93778728958634,118.48334104606911,119.04094145851163,119.6096688031916,120.18866424701879,120.77712543536857,121.37430243775175,121.9794940189803,122.59204420671851,123.21133912918181,123.83680409931301,124.4679009240502,125.10412541935554,125.74500511350035,126.39009712274975,127.03898618506125],[120.77223730878852,119.25378973817259,117.91076590335607,116.72812912888082,115.69231093615973,114.79104593070062,114.01322776493116,113.34878317041183,112.78856152603443,112.32423782052908,111.94822719325821,111.65360950891743,111.43406264906041,111.28380339416051,111.1975349305398,111.17040015211093,111.1979400416933,111.27605651413668,111.400979186447,111.56923561090018,111.77762456768239,112.02319206551121,112.30320974331079,112.61515540443887,112.95669544813404,113.32566899153693,113.7200735005087,114.13805176905778,114.57788010598047,115.0379576036943,115.51679637855001,116.01301268441942,116.52531881232463,117.0525156985011,117.59348617174844,118.14718877838416,118.71265212968316,119.28896972250124,119.87529518891526,120.47083793526711,121.07485913503932,121.68666804357473,122.30561860585075,122.93110633135736,123.56256541266883,124.19946606655969,124.84131207854827,125.48763853355399,126.13800971699082,126.79201717206814],[119.83059199400898,118.34943357785824,117.04152699494165,115.8920010220814,114.88743717297507,114.01570628708413,113.26582597954751,112.62783597628375,112.09268882650055,111.65215387261415,111.29873267996153,111.02558439758815,110.82645974640369,110.69564251986662,110.62789764135216,110.61842495660657,110.6628180533417,110.75702749650912,110.8973279499164,111.08028872491711,111.30274735684732,111.56178586126923,111.85470936624561,112.17902685490468,112.53243378538572,112.91279638365063,113.31813742925796,113.7466233755699,114.19655266445812,114.6663451117835,115.15453225408507,115.65974855929662,116.18072341516181,116.7162738185508,117.26529769725491,117.82676780321609,118.39972612265393,118.98327875430415,119.57659121206424,120.17888411285162,120.78942921447553,121.40754577187273,122.03259718322231,122.6639879002627,123.30116057964936,123.94359345442923,124.59079790671606,125.24231622444097,125.89771952666392,126.55660584337326],[118.93517741642221,117.48947741754408,116.21496398041432,115.09692321113997,114.1220792517271,113.27843248708898,112.55511840903984,111.94228419031896,111.43098048523073,111.01306635751737,110.68112555534634,110.42839261959202,110.24868753442149,110.1363578162283,110.086227094417,110.09354937047726,110.1539682543392,110.26348057254552,110.41840382410095,110.61534702924543,110.85118457575386,111.12303271825181,111.42822842976759,111.76431034240741,112.12900154654439,112.52019404603456,112.93593469134045,113.37441243360574,113.83394676113787,114.31297719580945,114.81005374090044,115.32382818417389,115.85304617071955,116.39653996953449,116.95322186610592,117.52207812056501,118.10216343742421,118.69259589860035,119.29255231646562,119.90126396812209,120.51801267606048,121.14212720387451,121.77297993883333,122.40998383589768,123.05258960025449,123.70028308765853,124.35258290385889,125.00903818616129,125.66922655176917,126.33275219897654],[118.08599357602843,116.67392125722979,115.43107685977387,114.3428956960565,113.39623717241568,112.57922453071535,111.88110505340821,111.29212781251742,110.80343650222495,110.40697527523871,110.09540581941253,109.86203417492935,109.70074601311389,109.60594928324552,109.57252328973426,109.59577339372298,109.67139064468576,109.79541574224577,109.9642068090005,110.17441052388527,110.42293622440219,110.7069326364588,111.02376693387676,111.37100586694721,111.74639873160991,112.14786197868872,112.57346528675635,113.02141894316489,113.49006239601978,113.97785385577238,114.48336083899595,115.0052515590511,115.54228707899794,116.09331415145212,116.65725867830132,117.23311973043104,117.81996407399357,118.41692115538972,119.02317850211944,119.63797750107844,120.26060951979412,120.89041233957995,121.52676687268357,122.16909413826232,122.81685247448434,123.46953496624779,124.12666706997682,124.78780441871491,125.45253079230626,126.12045623887812],[117.28304047282732,115.9027650969155,114.6898656330205,113.62991847683102,112.7099109350409,111.91808241796306,111.24378591265258,110.67736684287908,110.2100568774833,109.83388062577795,109.5415734721601,109.32650906359996,109.18263518248079,109.10441692091831,109.086786227304,109.1250970263437,109.21508522438143,109.35283300560981,109.53473690461519,109.75747920883639,110.01800230279213,110.31348561589031,110.64132487857307,110.99911342852408,111.38462534058245,111.79580018161319,112.23072921550558,112.68764290424777,113.1648995691036,113.6609750916722,114.17445354837179,114.70401868392831,115.24844613999687,115.80659636430376,116.3774081338412,116.95989263281403,117.55312803236237,118.15625452467238,118.76846976902588,119.38902471172081,120.01721974567657,120.65240117898921,121.29395798477324,121.94131880735667,122.59394920233899,123.25134909019684,123.91305040506988,124.57861492210193,125.24763224827555,125.91971796307786],[116.52631810681925,115.17600893660119,113.99133030015402,112.95799155346351,112.0631005396028,111.29500614883214,110.64316098677301,110.098001281404,109.6508416110057,109.29378240913535,109.01962851358903,108.821817285604,108.69435504252226,108.63176072924674,108.6290159071262,108.68152026833937,108.78505199342625,108.93573236263795,109.12999411094501,109.36455308409904,109.63638281092366,109.94269165654627,110.28090226385666,110.64863302713792,111.04368137346184,111.46400865480788,111.9077264775881,112.37308431685412,112.85845828038953,113.36234090350889,113.88333186902777,114.42012955880563,114.97152335371648,115.5363866080893,116.11367023272557,116.70239682771398,117.30165531253046,117.91059600644829,118.52842611718476,119.15440560004912,119.78784335370763,120.42809372210206,121.07455327510219,121.72665784318066,122.38387978381826,123.04572545950585,123.71173290913787,124.3814696963222,125.05453091967678,125.73053737157575],[115.81582647800386,114.49365277628695,113.33547086117458,112.32711492595406,111.45580598610128,110.70999572332261,110.07923027576949,109.55403112809226,109.12579070279226,108.78668062531085,108.52957094369945,108.3479588409413,108.23590559323831,108.1879807082307,108.19921232920092,108.26504311971001,108.38129095182015,108.54411381332997,108.74997842798983,108.99563214967304,109.27807774879682,109.59455075842673,109.94249908972738,110.31956466278882,110.72356683024813,111.15248739827297,111.6044570730039,112.07774318098399,112.57073852987752,113.08195129128249,113.6099958009641,114.15358418368282,114.71151872015666,115.28268488280895,115.86604497495438,116.46063231513098,117.06554591449782,117.67994560071732,118.30304754659612,118.93412016606332,119.57248034388738,120.21748996891867,120.86855274367052,121.52511124573432,122.18664421892224,122.85266407417474,123.52271458218105,124.19636874137585,124.87322680651005,125.55291446437197],[115.15156558638134,113.85569661597265,112.72228731608206,111.73728859430256,110.88802727453647,110.16305114143458,109.55199377964203,109.04545638294384,108.63490415284275,108.31257527430441,108.07140076249128,107.90493372961195,107.80728683462887,107.77307685787024,107.79737549352808,107.8756655804557,108.00380209956325,108.17797735768593,108.39468985574973,108.6507164055585,108.94308711641168,109.26906292153168,109.62611535618525,110.01190833547678,110.42428171094137,110.86123641200817,111.32092100175318,111.8016194966374,112.30174031756758,112.81980625499291,113.35444534418062,113.90438255856009,114.46843223931759,115.04549118846248,115.63453236052771,116.23459909506502,116.84479983826449,117.46430330747968,118.09233405725981,118.72816840976354,119.37113071621594,120.02058991943893,120.67595639047816,121.33667901501765,122.00224250765095,122.67216493420352,123.34599542419927,124.0233120572628,124.70371990877535,125.38684924146625],[114.53353543195162,113.2621404556584,112.15177966487643,111.18851255850895,110.35976440490823,109.65417240316786,109.06145149839054,108.57227704595853,108.17818196115749,107.87146635611604,107.64511796996452,107.49274195161594,107.40849876669398,107.38704917816533,107.42350540010762,107.51338765057648,107.6525854366554,107.8373229957057,108.06412839422472,108.32980585175538,108.63141091376815,108.96622814586112,109.33175106323039,109.72566404520178,110.14582601554153,110.59025569601371,111.05711826383573,111.54471326381442,112.05146364345968,112.57590579464015,113.11668049867738,113.6725246834373,114.2422639111991,114.82480552504987,115.41913238944547,116.02429716751604,116.63941708383052,117.26366912673528,117.89628564917614,118.53655033114974,119.18379447069321,119.83739357366292,120.49676421552519,121.1613611510307,121.8306746500043,122.50422803959219,123.18157543519261,123.86229964398314,124.54601022647267,125.23234170285892],[113.9617360147148,112.71298429534413,111.62394790755789,110.68078681857348,109.87101737721667,109.18335950852254,108.60760343201513,108.13449311713666,107.75562412773618,107.46335387074576,107.25072256611918,107.11138350695323,107.03954138943371,107.02989766911598,107.0776020489396,107.17820933007214,107.32764096309667,107.52215072738944,107.75829404341486,108.03290048826366,108.34304914086637,108.68604643141509,109.05940621086272,109.4608317919638,109.88819974404865,110.33954525028956,110.81304885925165,111.307024482515,111.81990850755392,112.35024991022442,112.89670126445442,113.45801055831453,114.03301373580111,114.62062789257138,115.2198450617076,115.82972653248403,116.44939765119582,117.07804305848407,117.7149023223449,118.35926593022178,119.01047160731916,119.66790093159058,120.33097621881157,120.99915765377338,121.6719406459824,122.34885339034079,123.02945461516087,123.71333150153677,124.40009775960209,125.08939184854965],[113.43616733467077,112.2082281350299,111.13879204412621,110.21411137449589,109.42178619146175,108.75061245749868,108.19044958051575,107.73210459647798,107.36723065257901,107.08823781819356,106.8882145509552,106.7608583956239,106.70041470284794,106.70162233072217,106.75966544002411,106.87013061894281,107.028968678887,107.23246055273704,107.47718680332004,107.76000031508342,108.07800179770614,108.42851777819351,108.80908079908212,109.21741157576287,109.65140289646268,110.10910507483563,110.58871278800082,111.0885531527391,111.60707490985008,112.14283860174552,112.69450764151159,113.26084018319173,113.84068171312377,114.43295829102688,115.03667037731427,115.65088718996905,116.27474154036042,116.90742510272621,117.54818407676616,118.19631520697986,118.85116212609391,119.51211199322206,120.17859240033727,120.8500685232458,121.52604049558521,122.20604098644925,122.88963296410431,123.57640762992374,124.26598250816352,124.95799967853866],[112.95682939181962,111.74787197471569,110.69631207458156,109.78848622627638,109.01207084764341,108.35593125009615,107.80998994389238,107.36511148398255,107.0130015356859,106.74611819845934,106.55759392447276,106.44116661762784,106.39111870693671,106.40222316298401,106.46969557336104,106.58915151718845,106.7565685840265,106.96825247174863,107.22080667394032,107.51110533221448,107.83626888428765,108.19364218619644,108.58077482788877,108.99540339659897,109.43543547278358,109.89893516965195,110.38411005008334,110.88929927448673,111.41296285034834,111.9536718692035,112.51009962984911,113.08101355806905,113.66526784316717,114.2617967204162,114.8696083362655,115.48777913997108,116.11544875132432,116.75181525946151,117.39613091243986,118.04769816142388,118.70586602701724,119.37002675855713,120.03961276010239,120.71409375944792,121.39297419881262,122.07579082791754,122.76211048202275,123.451528029144,124.14366447215693,124.83816519282583],[112.52372218616128,111.33191581440134,110.29650799892389,109.40391137391482,108.64187134576166,107.99931588631506,107.46622452214505,107.03351377965033,106.69293677705697,106.43699501154335,106.25886068667157,106.15230817296523,106.11165340169998,106.13170016590135,106.2076924489505,106.33527202480914,106.51044067851517,106.72952648442408,106.98915365527554,107.28621553965704,107.61785040061072,107.98141965542391,108.3744882972826,108.79480725447213,109.24029747301147,109.70903553473858,110.1992406454993,110.70926284775788,111.23757232904872,111.78274971259832,112.3434772294669,112.91853068294631,113.50677212593118,114.10714318073964,114.71865893856095,115.34040238249013,115.97151928408762,116.61121352868999,117.25874282936604,117.9134147935538,118.57458331008942,119.24164522759585,119.91403729810676,120.5912333623796,121.27274175566473,121.95810291474585,122.64688716891641,123.33869269919764,124.03314365158238,124.72988839141129],[112.13684571769576,110.96035965408707,109.93937981715315,109.06038681741131,108.31118768581663,107.6807663661554,107.15915331527377,106.73731148348142,106.40703637669202,106.16086825744533,105.99201483755191,105.89428306163585,105.86201878713781,105.89005333947428,105.97365606679229,106.1084921418048,106.29058496235274,106.51628259076344,106.78222774732603,107.08533093741102,107.42274634667548,107.79185018587576,108.19022120726366,108.61562314938229,109.06598889714627,109.53940617009542,110.03410457424846,110.54844387255261,111.08090334595107,111.63007213193006,112.19464044036485,112.7733915578235,113.36519456141566,113.96899767199693,114.58382218420101,115.20875691752616,115.8429531386501,116.48561991041176,117.13601982754473,117.79346510336974,118.45731397531027,119.12696740033846,119.80186601435048,120.48148733204107,121.16534316614162,121.85297724693395,122.54396302478504,123.23790164008464,123.93442004643988,124.63316927429486],[111.79619998642312,110.63320349377281,109.62492752926934,108.7579125567657,108.02001986780823,107.40028268961714,106.88877632327849,106.47650459547577,106.1553003345911,105.91773793616534,105.75705637711364,105.66709128363982,105.64221486325033,105.67728268370278,105.76758642688655,105.90881186817556,106.09700143553964,106.3285207907668,106.60002895009153,106.90845152547641,107.25095672248193,107.62493377755214,108.02797355783181,108.45785108132948,108.91250974518803,109.39004707572262,109.88870183633095,110.40684234887085,110.94295590105558,111.49563912719863,112.06358926254309,112.6455961827007,113.24053514962092,113.84736019418825,114.46509807318554,115.09284274507922,115.72975031501198,116.3750344046268,117.02796190697583,117.68784909087154,118.35405802267987,119.02599327678459,119.7030989088335,120.38485566843211,121.07077843024315,121.76041382448201,122.45333804962861,123.14915485180494,123.84749365672941,124.54800784147677],[111.50178499234319,110.35044733345858,109.35315113527255,108.49648859197805,107.76836789173637,107.1578648567002,106.65509354615921,106.25109311563345,105.93772865075439,105.7076040477036,105.55398530535676,105.47073283897717,105.45224163003734,105.4933881985869,105.58948352923336,105.73623120392121,105.92969009807557,106.16624108443398,106.44255726357213,106.75557730385319,107.10248152802993,107.48067043045302,107.88774534898725,108.32149105031375,108.77986001713664,109.26095825162008,109.76303243174685,110.28445827671266,110.82372999436208,111.3794506984042,111.9503236960015,112.53514455757792,113.13279389054674,113.74223074731351,114.3624866055145,114.99265986514929,115.63191081317318,116.27945701133505,116.93456906765947,117.59656675605933,118.26481545219809,118.93872285693452,119.61773598155594,120.30133837155297,120.98904754796939,121.68041264738989,122.37501224344742,123.07245233435856,123.77236448245108,124.47440409295679],[111.25360073545626,110.11209117314428,109.12405063516273,108.27611492304838,107.55623175760124,106.95351286740473,106.45810498391607,106.06107704395433,105.75432132518166,105.53046659205972,105.38280162228128,105.30520772764783,105.2920990874988,105.33836988412645,105.4393473738326,105.5907501490419,105.78865094996067,106.02944347176508,106.30981268776776,106.62670827254142,106.97732076331968,107.35906014457844,107.76953658072983,108.20654305633498,108.66803971299217,109.15213969778773,109.65709636049613,110.181291656078,110.72322562587063,111.28150684554656,111.85484374074032,112.4420366824552,113.0419707841932,113.65360933137271,114.27598778118802,114.90820827773631,115.54943463313353,116.19888773053653,116.8558413095955,117.51961809893315,118.1895862638651,118.86515614078819,119.54577723251771,120.23093544140343,120.9201505193204,121.6129737156577,122.30898560624127,123.00779408774552,123.70903252360465,124.41235802873511],[111.05164721576215,109.91813501282999,108.9376260289399,108.09679154997684,107.38361146540269,106.78722672173058,106.2978106365489,105.90645638043848,105.60507835787311,105.38632556923407,105.24350532788722,105.17051594965174,105.16178723563488,105.21222774032167,105.31717796068425,105.47236870353755,105.67388399119474,105.91812795276012,106.20179522267854,106.52184443154104,106.87547442835114,107.26010291992826,107.67334725305957,108.11300709939333,108.57704883275474,109.06359141422573,109.57089362257871,110.09734248696691,110.64144279558133,111.20180756862584,111.77714939675924,112.36627255733244,112.96806583056025,113.58149594636593,114.20560160020594,114.83948798284042,115.48232177489341,116.13332656223133,116.7917786327841,117.45700311949278,118.12837045768084,118.80529312834551,119.48722266171882,120.1736468779836,120.864087344296,121.55809702928542,122.25525813801019,122.95518011196593,123.65749778019034,124.36186964881153],[110.89592443326079,109.76857885251574,108.79387731660394,107.95851847276325,107.25050701514084,106.65900641967787,106.17421050405781,105.78723112508594,105.48999974882854,105.27518097922645,105.13609642217465,105.06665750498912,105.06130607444548,105.11496176717245,105.22297528978844,105.38108686740821,105.58538922177804,105.83229452741907,106.11850486830434,106.44098578085212,106.79694252312409,107.18379875650263,107.5991773659765,108.04088317948867,108.50688737642415,108.99531340093398,109.50442421799453,110.03261076937946,110.57838150349393,111.14035286764201,111.71724066405844,112.30785218220964,112.91107902964791,113.52589059229311,114.15132806256825,114.78649898046147,115.43057223845237,116.08277350641933,116.74238103722519,117.40872181773847,118.08116803364528,118.75913381960656,119.44207226915927,120.12947268129345,120.82085802289633,121.51578258827297,122.21382983875405,122.91461040701951,123.61776025220797,124.3229389531862],[110.78643238795233,109.66342269220145,108.69280449815501,107.86129569140753,107.15691840681549,106.56885196124659,106.08730458644266,105.7034012778966,105.40908549804806,105.19703282203689,105.06057490514338,104.99363239365968,104.99065560393066,105.04657196467879,105.15673936114503,105.31690464065395,105.52316664171042,105.77194319574191,106.05994162464522,106.38413232047462,106.74172504763877,107.13014765430148,107.54702691948069,107.990171296621,108.45755534400045,108.94730565791252,109.45768814674369,109.98709650331541,110.53404174960878,111.09714274259512,111.67511754263785,112.26677555708693,112.87101038145627,113.48679326915428,114.11316716827507,114.74924127059961,115.39418602381079,116.04722856310053,116.70764852291873,117.37477419367005,118.04797899175844,118.72667821457124,119.41032605483905,120.0984128513329,120.79046255512138,121.48603039262052,122.18470070847324,122.88608497290639,123.5898199396577,124.29556594185904],[110.72317107983662,109.60266653188719,108.63440757359307,107.80512320590981,107.10284564042691,106.51676334643675,106.03709288370362,105.65496683887055,105.36233560553178,105.15188109766537,105.01694077679359,104.95144061566373,104.94983582409033,105.00705833284067,105.11847017475417,105.27982202327462,105.48721625099192,105.7370739577286,106.02610549170129,106.35128405040848,106.70982200189502,107.0991496133248,107.51689591357194,107.96087145079056,108.42905273548371,108.91956818516127,109.43068540882628,109.96079968877493,110.50842353392547,111.07217719348503,111.65078003249756,112.24304268196417,112.84785988598522,113.46420397694939,114.0911189173264,114.72771485325467,115.37316313096848,116.02669173227503,116.68758108986478,117.35516024728759,118.0288033320203,118.7079263132397,119.39198401875814,120.08046738810211,120.77290094097106,121.46884044232782,122.16787074716726,122.86960380962674,123.57367684253947,124.27975061483018],[110.70614050891382,109.58631037157295,108.61868654291808,107.79000101627021,107.08828871597494,106.50274057524813,106.02357539584057,105.64192780800782,105.34975007127939,105.13972580611197,105.00519403712514,104.94008217100094,104.93884673492462,104.99642087165806,105.10816773061558,105.26983901527034,105.47753804962255,105.72768681337931,106.01699646947232,106.34244097065378,106.70123338589302,107.09080463357262,107.50878434825049,107.95298364199698,108.42137955087392,108.91210098268031,109.42341600424217,109.9537203257581,110.50152685644443,111.0654562203118,111.64422813363744,112.23665355684142,112.84162754323469,113.45812271567853,114.08518330972207,114.72191972842678,115.36750355992551,116.02116301394275,116.68217873806321,117.34987997859109,118.02364105443093,118.70287811561182,119.38704616091665,120.07563629160093,120.7681731804455,121.46421273739507,122.1633399548364,122.86516691718037,123.56933096085321,124.27549297209943],[110.73534067518392,109.61435421125864,108.64564140613007,107.81592912248847,107.11324763345959,106.52678364768109,106.04675212285358,105.66428418530829,105.3713288952912,105.16056694737661,105.02533468613821,104.95955705967171,104.95768833643351,105.01465958113114,105.12583202872958,105.28695561664098,105.4941320376023,105.7437817626939,106.03261455795847,106.35760308121053,106.71595919963262,107.10511271504497,107.52269222351615,107.96650787024043,108.43453579017105,108.92490405046964,109.43587993299144,109.96585841426467,110.51335171716525,111.07697982307548,111.65546184605768,112.24760818171865,112.85231335320481,113.46854948534147,114.09536034546234,114.73185589611585,115.37720731068184,116.03064240810363,116.69144146751418,117.35893338758059,118.03249215899025,118.71153362168775,119.39551248131447,120.08391956182943,120.77627927354465,121.47214727782224,122.17110833148071,122.8727742955674,123.57678229459901,124.28279301366696],[110.81077157864667,109.68679805094439,108.71527216322902,107.88290752456487,107.1777223928808,106.58889256373536,106.10662306474262,105.72203597077201,105.42707207756715,105.21440452145937,105.07736272383264,105.00986528167562,105.00636062861683,105.06177446125973,105.17146306909598,105.3311718273867,105.53699821493109,105.78535880567239,106.07295975715972,106.39677038207873,106.75399944311384,107.14207385774178,107.55861953936902,108.00144413552101,108.46852145337513,108.95797738852923,109.46807719507396,109.99721395429491,110.54389811608827,111.10674800177611,111.68448116975813,112.27590655659587,112.8799173158957,113.49548428593855,114.12165002454701,114.75752335632198,115.4022743832374,116.05512991475781,116.71536927821764,117.38232047425598,118.05535664569823,118.73389283146722,119.41738297995163,120.10531719878767,120.79721922026847,121.49264406360929,122.19117587710002,122.89242594478765,123.59603084377683,124.30165073953265],[110.93243321930247,109.80364189063013,108.82757881421492,107.99093622249919,107.28171299423869,106.68906732341111,106.20318822150773,105.81518316439902,105.51697961810709,105.30123852836017,105.16127815020852,105.09100683701298,105.08486361147473,105.13776551204387,105.24506085171484,105.40248764750737,105.60613658160909,105.85241794231477,106.13803206707601,106.45994287325823,106.81535411633686,107.20168806166301,107.61656629580906,108.05779243783856,108.52333654048608,109.01132099685908,109.5200077904899,110.04778694584861,110.59316605321335,111.15476075641354,111.73128610473873,112.32154868147315,112.92443943130715,113.53892711746948,114.16405234697618,114.79892210904514,115.44270477759234,116.09462553390524,116.75396217017355,117.42004123861736,118.09223451455496,118.76995574495049,119.45265765682809,120.13982920247558,120.830993020617,121.52570309475628,122.22354259169444,122.92412186484137,123.62707660838676,124.33206614969667],[111.10032559715094,109.96488573031587,108.98256135908778,108.1400152162914,107.42521943753324,106.82730792670816,106.33644759314876,105.9437257661893,105.64105151691106,105.42106896807906,105.27708096526578,105.20298172568354,105.19319728500723,105.24263273348365,105.34662537658615,105.50090307700304,105.70154713763614,105.94495917262117,106.22783148770739,106.54712055474927,106.90002321930139,107.28395532680884,107.69653249283633,108.13555277719324,108.59898105150391,109.08493487545923,109.59167171923903,110.11757738892584,110.66115552854041,111.22101808698787,111.7958766509997,112.3845345563504,112.98587969943917,113.59887797993447,114.22256731274975,114.85605215428521,115.4984984937466,116.14912926554591,116.80722014338188,117.47209568066468,118.14312576556047,118.81972236213745,119.501336511944,120.18745557289314,120.87760067459023,121.57132437126309,122.26820847526386,122.96786205572829,123.66991958842864,124.37403924415872],[111.31444871219229,110.17052957000162,109.18021979784757,108.33014450594172,107.6082417227644,107.00361437362668,106.50640117966593,106.1076637761429,105.79928777397922,105.57389584061607,105.42477116900443,105.34578994768762,105.33136164921423,105.37637612557899,105.47615664370994,105.62641811587378,105.82322988301223,106.06298249659137,106.34235801905388,106.65830342655165,107.00800675200762,107.38887565317904,107.79851813045077,108.23472515358483,108.69545498642874,109.1788190243296,109.68306898132161,110.20658528352668,110.74786654206957,111.30551999349919,111.87825280854085,112.46486418122755,113.06423812029183,113.67533687333339,114.29719492186784,114.92891349204237,115.56965553170015,116.21864110967985,116.87514319784273,117.53848380039787,118.20803039871467,118.88319268302813,119.56341954529913,120.24819631004041,120.93704218218809,121.62950789312978,122.32517352780835,123.02364651744851,123.72455978390262,124.42757002291904],[111.57480256442656,110.42057340968732,109.42055413049439,108.56132409144995,107.83077984993221,107.21798666416656,106.71304898105909,106.30699719425974,105.99168838931146,105.759719145971,105.6043487614245,105.51943150302486,105.49935670409582,105.53899568832975,105.63365465308624,105.77903276411945,105.97118481773757,106.20648791422553,106.48161166111541,106.7934914886655,107.13930471445551,107.51644904077384,107.92252320865234,108.35530956701352,108.81275834526049,109.29297344347033,109.79419957673743,110.31481062965105,110.85329909380077,111.4082664759473,111.97841457736222,112.56253755610486,113.15951469386511,113.76830379766626,114.38793517433035,115.01750612231646,115.656175891453,116.30316106630697,116.95773133355613,117.61920559781707,118.28694841401759,118.96036670762251,119.63890675689372,120.32205141391728,121.0093175434107,121.7002536603563,122.39443774932798,123.09147525000226,123.79099719480857,124.49265848597763],[111.88138715385354,110.71501724937308,109.70356435702813,108.83355397281619,108.09283381903663,107.47042479832787,106.95639099732824,106.54172602053978,106.21825336290772,105.97853888414417,105.81581374252599,105.72390639169551,105.6971824496519,105.73049142173619,105.81911940471494,105.95874702174015,106.14541194181197,106.3754754255236,106.64559241389206,106.95268474109072,107.293917106645,107.66667548959309,108.0685477274412,108.49730601747927,108.95089112799923,109.42739813288129,109.92506350548675,110.44225342729891,110.97745318373406,111.52925753433222,112.09636195746384,112.6775546809821,113.27170942015901,113.87777875293317,114.49478807013735,115.12183004510764,115.75805957300513,116.40268913542738,117.05498455052192,117.71426107292226,118.37987981146921,119.05124443592049,119.72779814672757,120.40902088452394,121.09442675825801,121.78356167294288,122.47600113982263,123.17134825338917,123.8692318211466,124.56930463333434],[112.23420248047351,111.05386108905883,110.02925047744895,109.14683415004038,108.39440363007763,107.76092877611055,107.23642722847343,106.81185025498311,106.47898269476805,106.23035505513535,106.05916611230893,105.9592146136995,105.92483888588261,105.95086332579827,106.03255089859607,106.16556088873581,106.34591125523545,106.56994503048553,106.83430027738379,107.13588318382736,107.47184392857623,107.83955499963686,108.23659168681715,108.66071450498207,109.1098533346448,109.58209309256246,110.07566076756922,110.58891367647038,111.12032881186938,111.66849316865412,112.23209494884571,112.80991555585926,113.40082229917351,114.00376173913389,114.61775360928877,115.2418852604158,115.87530657635659,116.51722531704097,117.16690284874026,117.82365022571338,118.48682459106951,119.15582586792222,119.83009371480078,120.50910472186015,121.19236982673002,121.87943193088931,122.5698636992924,123.26326552760949,123.95926366291663,124.65750846498929],[112.63324854428622,111.43710492874455,110.39761249175656,109.50116462312268,108.73548928305537,108.08949859751468,107.55315767449474,107.11736989758973,106.77387638489255,106.51516765894462,106.33440587077332,106.22535616903683,106.1823260127878,106.20011140051581,106.27394913472976,106.39947436510647,106.5726827580081,106.78989672911143,107.04773525159058,107.34308681687546,107.67308518024907,108.03508757090508,108.42665508678036,108.84553502952187,109.28964496519727,109.75705832251394,110.24599136298509,110.75479137716545,111.28192597820673,111.82597337891289,112.38561355150782,112.95962018073654,113.54685333090873,114.14625275626877,114.75683179178465,115.37767176824094,116.00791690150736,116.64676961114779,117.29348622821102,117.94737305619037,118.60778275281852,119.27411100362777,119.94579346111337,120.62230292592621,121.30314674882675,121.98786443419556,122.67602542773712,123.36722707266317,124.06109272011872,124.75726998094247],[113.07852534529172,111.86474876843025,110.80865039995122,109.89654539206286,109.11609077796966,108.45613426254013,107.90658233539205,107.45828494835956,107.10293443328109,106.83297669557189,106.64153301791899,106.52233105770745,106.46964383036762,106.47823564588896,106.54331411311583,106.66048745085213,106.82572645012981,107.03533052140121,107.28589733651249,107.57429564023494,107.89764086166349,108.25327320339778,108.63873792733067,109.05176759109864,109.49026601965672,109.9522938227357,110.43605529173433,110.93988652938398,111.46224468274623,112.00169816510856,112.55691776545022,113.12666855561379,113.70980251536447,114.30525180433754,114.9120226176251,115.52918956858315,116.15589054845739,116.79132201774789,117.4347346889343,118.08542956435336,118.74275429671641,119.40609984303694,120.07489738566521,120.7486154967218,121.42675752454809,122.10885918286172,122.79448632515704,123.48323288855009,124.1747189927528,124.86858918119394],[113.57003288349016,112.336792608116,111.26236420203287,110.33297645686108,109.53620811482062,108.86083577118703,108.29670121116533,107.83459540729275,107.46615683993363,107.18378216501733,106.98054755374616,106.8501392797114,106.78679233862192,106.78523606191759,106.84064583375435,106.94860014597285,107.10504233160061,107.30624640735489,107.54878653214939,107.82950965390584,108.14551097281966,108.49411189711496,108.8728402084682,109.27941218971255,109.71171649802298,110.16779959322776,110.64585255381687,111.14419913312607,111.66128492548764,112.19566752724107,112.74600759067283,113.31106068049104,113.88966985254091,114.4807588833402,115.0833260868099,115.69643866144229,116.31922751720684,116.95088253684126,117.59064823091002,118.23781975020243,118.89173922276288,119.55179238614981,120.21740548845645,120.88804243424713,121.56320215389421,122.24241617688776,122.92524639155199,123.61128297527051,124.30014248081893,124.99146606574347],[114.10777115888129,112.85323644780171,111.75875389800152,110.81045781751723,109.99584129360819,109.30360312345535,108.72351430181476,108.24630127438915,107.86354360485036,107.56758406728082,107.35144947825472,107.20878083504881,107.13377153755081,107.12111264860188,107.16594429664532,107.26381245046852,107.41063040242059,107.60264438697253,107.83640283850153,108.10872885788818,108.41669551371737,108.75760365205673,109.12896193019297,109.52846882536346,109.95399640029639,110.40357563399006,110.87538314923276,111.36772918839169,111.87904670643123,112.40788146531048,112.9528830271757,113.51279655536825,114.08645534243793,114.67277399327692,115.27074219933917,115.87941904681848,116.49792780775546,117.12545116842784,117.76122685413823,118.40454361373733,119.05473753095814,119.71118863296644,120.37331776948704,121.04058373850214,121.71248063686504,122.38853541627377,123.06830562692198,123.75137733282405,124.43736318431708,125.1259006345913],[114.69174017146538,113.41408028748742,112.29781948785707,111.32898947403135,110.49499031433241,109.78443631934493,109.18702160734017,108.69340254964882,108.29509472803116,107.98438240236229,107.75423879144475,107.59825572371949,107.51058142715425,107.48586540594175,107.51920950178872,107.60612436433919,107.74249066258969,107.92452446025406,108.14874625556862,108.41195325218197,108.71119448435685,109.04374846822287,109.40710309250484,109.79893749805143,110.2171057264765,110.65962194502261,111.12464707798196,111.61047669518088,112.11553002557685,112.63833997931681,113.17754407495883,113.73187618024545,114.30015898505555,114.88129713414756,115.47427095521293,116.0781307247117,116.69199142010352,117.3150279125076,117.94647055861897,118.58560115495813,119.23174922130204,119.88428858348674,120.54263422875709,121.20623940948686,121.87459297346052,122.54721690101962,123.22366403126703,123.90351596121096,124.58638110324726,125.27189288773734],[115.32193992124232,114.01932412717316,112.87956097159959,111.88857142640359,111.03365517699328,110.3033353588561,109.68722312774162,109.17589923307176,108.76081020947599,108.43417717026199,108.18891549331612,108.01856394572341,107.91722200743222,107.87949433393712,107.90044144918463,107.97553588758494,108.10062311210791,108.27188662719954,108.4858167833508,108.73918283678715,109.02900788473796,109.35254634561358,109.70726369540385,110.09081820777644,110.50104447656364,110.93593852632542,111.39364434006451,111.87244165349357,112.37073488292451,112.88704306925997,113.41999073402214,113.96829955512275,114.53078078039378,115.10632830595218,115.69391235443121,116.29257369512192,116.90141835425088,117.51961276908074,118.14637934435208,118.7809923738649,119.42277429379469,120.07109223771067,120.72535486626631,121.38500944720123,122.04953916368075,122.7184606311254,123.39132160458723,124.06769886043128,124.7471962376096,125.42944282518155],[115.99837040821207,114.66896796685889,113.50397834922913,112.4892036746337,111.61183588159074,110.86030024198851,110.22411886301909,109.69379132465792,109.26069004918493,108.91696837097962,108.65547958386894,108.46970550106067,108.35369327838474,108.30199943258813,108.30964013883302,108.3720470202056,108.48502775097516,108.64473088780888,108.84761442184815,109.09041761170373,109.37013571486062,109.68399728422878,110.02944373889027,110.40411095453835,110.80581265055773,111.23252537789854,111.68237493548045,112.15362406332991,112.64466127847425,113.15399073514,113.68022300436573,114.22206668000001,114.77832072845266,115.34786750869085,115.92966639699387,116.52274795804904,117.12620861019744,117.73920573814706,118.3609532113378,118.99071727045765,119.6278127484361,120.27159959563836,120.92147968201493,121.57689385164522,122.23731920752552,122.90226660659101,123.57127834688245,124.24392603048501,124.91980858740384,125.59855044692398],[116.72103163237455,115.36301180654461,114.17107162074556,113.13088621872188,112.22953242812494,111.45533096874252,110.79770881317252,110.24707882440738,109.7947342471579,109.43275600451543,109.15393106310319,108.95168038973134,108.81999524001182,108.7533807018946,108.7468055707338,108.79565776220129,108.89570457919156,109.04305724208207,109.23413917106046,109.46565757693172,109.73457797472503,110.03810128406846,110.37364322296369,110.73881573833748,111.13141024845872,111.54938249974188,111.99083886422963,112.45402392468972,112.93730921222595,113.439182976957,113.95824088598953,114.49317755487721,115.04277882923219,115.60591474236335,116.18153308290098,116.76865351349325,117.36636218794342,117.97380681970652,118.59019215957589,119.21477584473639,119.84686458522616,120.48581065726977,121.13100867600286,121.78189262281896,122.43793310499508,123.09863482741657,123.76353425815273,124.43219747137196,125.10421815263017,125.77921575296463],[117.48992359372998,116.10145564623042,114.88084078614904,113.813619058668,112.88674481659561,112.08842753911773,111.40799297820203,110.83576173232008,110.36294280339504,109.98154007086923,109.68426993101879,109.46448861173533,109.31612789231342,109.23363814185677,109.21193774488704,109.24636811357192,109.33265359675704,109.46686569001922,109.64539103098787,109.86490273247119,110.12233466433106,110.41485834513259,110.73986214762428,111.09493255917359,111.4778372702666,111.88650989185552,112.31903612631216,112.7736412375731,113.24867868417986,113.74261979471082,114.25404437889367,114.78163217975447,115.32415508273228,115.88047000696994,116.4495124121526,117.0302903614545,117.62187908748858,118.22341601375932,118.83409618906643,119.45316809670106,120.079929804165,120.71372542260484,121.35394184823015,122.00000576072242,122.65138085608943,123.30756529360195,123.96808933839809,124.63251318309224,125.30042493328851,125.97143874330351],[118.30504629227829,116.88429948591606,115.63328584543942,114.53740219447205,113.58347304700305,112.75958995311446,112.05497135810766,111.45984004839613,110.96531571789617,110.56332057004123,110.24649618761586,110.00813016707266,109.8420912352896,109.7427717524744,109.70503666129275,109.72417807431766,109.79587480367172,109.91615623162036,110.08137000163046,110.288153078322,110.53340578367882,110.81426846742116,111.12810051287214,111.47246141704669,111.84509371598145,112.24390755423944,112.66696672172804,113.11247600198001,113.57876969433578,114.06430118840153,114.56763348307797,115.08743055463168,115.62244948895309,116.17153330251038,116.73360438474869,117.30765850193272,117.89275930883319,118.48803332030535,119.09266529980952,119.70589402635171,120.32700840525254,120.95534389164368,121.59027919869686,122.23123326535543,122.87766246080835,123.52905800514728,124.18494358761845,124.84487316564592,125.50842892937882,126.17521941794057],[119.16639972801931,117.71154332560184,116.42840679861681,115.30223562613418,114.3197171193471,113.46881821073254,112.73864395288918,112.11931377263546,111.60185299066144,111.17809750203124,110.84060983289434,110.58260505574329,110.39788526894026,110.2807815337476,110.226102319951,110.22908764443832,110.28536819993552,110.3909288668853,110.54207608298807,110.73540861448427,110.96779133276807,111.23633165093429,111.53835831870717,111.87140231195693,112.23317958560318,112.62157548689366,113.03463065047727,113.47052821791054,113.92758224269372,114.40422715802917,114.89900819854256,115.41057267950889,115.93766204789443,116.47910462898487,117.03380900068922,117.60075793492797,118.17900285197702,118.76765873934461,119.36589949180508,119.97295363368821,120.58810038848871,121.21066606438617,121.84002072740286,122.47557513671822,123.11677791915197,123.76311296205247,124.41409700581401,125.06927741903284,125.72823014090136,126.39055777687588],[120.07398390095317,118.58318716528757,117.26620364568109,116.10811935365426,115.0954770336276,114.216112311972,113.45901076254682,112.814182905038,112.27255462169079,111.82587086683928,111.4666108668542,111.18791327774731,110.98350999326551,110.84766748567642,110.77513472086162,110.761096823934,110.80113378554832,110.89118359581425,111.02750927506078,111.20666934095799,111.42549131159909,111.68104789567191,111.9706355651293,112.29175524390409,112.64209487913186,113.01951368981807,113.4220279125598,113.84779788536443,114.29511632925369,114.76239770359363,115.24816852528737,115.75105855438618,116.26979275955644,116.80318398639332,117.35012625997422,117.90958866044015,118.48060971692018,119.06229227087708,119.65379876505307,120.25434691871077,120.8632057538737,121.47969194083237,122.10316643434815,122.73303137481059,123.36872723112032,124.00973016431749,124.65554959298454,125.30572594325319,125.95982856785567,126.61745382010929],[121.02779881107995,119.49923100497327,118.14667638663236,116.95505337703241,115.91075278984495,115.00147225683286,114.21607178708057,113.54444744560378,112.9774206109842,112.50664066446546,112.1244992894955,111.82405483308463,111.59896540826546,111.44342960826083,111.35213386402472,111.32020561280467,111.34317156051036,111.4169204184071,111.53766957784855,111.70193525774313,111.90650572017171,112.14841720163399,112.4249322521388,112.73352021288835,113.07183959656756,113.43772216301285,113.82915850797562,114.24428500434198,114.68137195401579,115.13881282509502,115.61511446331238,116.1088881792634,116.61884162393902,117.14377137473576,117.68255616260362,118.23415067846943,118.79757990366262,119.37193391490285,119.9563631195536,120.55007388141924,121.15232450140742,121.76242152098227,122.37971631953285,123.00360197963272,123.63351039671343,124.26890961194239,124.90930134913025,125.55421873830679,126.20322421024217,126.85590754764095]],"x":[0.5,0.51020408163265307,0.52040816326530615,0.53061224489795922,0.54081632653061229,0.55102040816326525,0.56122448979591832,0.5714285714285714,0.58163265306122447,0.59183673469387754,0.60204081632653061,0.61224489795918369,0.62244897959183676,0.63265306122448983,0.64285714285714279,0.65306122448979587,0.66326530612244894,0.67346938775510201,0.68367346938775508,0.69387755102040816,0.70408163265306123,0.7142857142857143,0.72448979591836737,0.73469387755102034,0.74489795918367352,0.75510204081632648,0.76530612244897955,0.77551020408163263,0.7857142857142857,0.79591836734693877,0.80612244897959173,0.81632653061224492,0.82653061224489788,0.83673469387755106,0.84693877551020402,0.8571428571428571,0.86734693877551017,0.87755102040816324,0.88775510204081631,0.89795918367346927,0.90816326530612246,0.91836734693877542,0.9285714285714286,0.93877551020408156,0.94897959183673464,0.95918367346938771,0.96938775510204078,0.97959183673469385,0.98979591836734693,1],"y":[0.5,0.51020408163265307,0.52040816326530615,0.53061224489795922,0.54081632653061229,0.55102040816326525,0.56122448979591832,0.5714285714285714,0.58163265306122447,0.59183673469387754,0.60204081632653061,0.61224489795918369,0.62244897959183676,0.63265306122448983,0.64285714285714279,0.65306122448979587,0.66326530612244894,0.67346938775510201,0.68367346938775508,0.69387755102040816,0.70408163265306123,0.7142857142857143,0.72448979591836737,0.73469387755102034,0.74489795918367352,0.75510204081632648,0.76530612244897955,0.77551020408163263,0.7857142857142857,0.79591836734693877,0.80612244897959173,0.81632653061224492,0.82653061224489788,0.83673469387755106,0.84693877551020402,0.8571428571428571,0.86734693877551017,0.87755102040816324,0.88775510204081631,0.89795918367346927,0.90816326530612246,0.91836734693877542,0.9285714285714286,0.93877551020408156,0.94897959183673464,0.95918367346938771,0.96938775510204078,0.97959183673469385,0.98979591836734693,1],"type":"surface","frame":null},{"z":[104.93884673492462],"x":[0.61751761812201755],"y":[0.78437129136747719],"showscale":false,"type":"scatter3d","mode":"markers","showlegend":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null},{"colorbar":{"title":"llsurf<br />llsurf","ticklen":2},"colorscale":[["0","rgba(253,244,217,1)"],["0.0416666666666665","rgba(244,227,194,1)"],["0.083333333333333","rgba(236,210,172,1)"],["0.125","rgba(230,195,152,1)"],["0.166666666666667","rgba(229,180,137,1)"],["0.208333333333333","rgba(229,166,124,1)"],["0.25","rgba(233,153,115,1)"],["0.291666666666667","rgba(234,138,105,1)"],["0.333333333333333","rgba(229,123,98,1)"],["0.375","rgba(216,110,93,1)"],["0.416666666666666","rgba(199,102,94,1)"],["0.458333333333333","rgba(181,98,99,1)"],["0.5","rgba(164,98,103,1)"],["0.541666666666667","rgba(148,96,107,1)"],["0.583333333333334","rgba(133,95,111,1)"],["0.625","rgba(119,94,114,1)"],["0.666666666666667","rgba(106,94,118,1)"],["0.708333333333333","rgba(95,93,120,1)"],["0.75","rgba(81,90,121,1)"],["0.791666666666667","rgba(63,86,121,1)"],["0.833333333333333","rgba(41,75,112,1)"],["0.875","rgba(23,61,96,1)"],["0.916666666666667","rgba(12,46,77,1)"],["0.958333333333333","rgba(6,32,57,1)"],["1","rgba(2,19,38,1)"]],"showscale":false,"z":[[128.65821515364468,126.82748286037244,125.19036329109143,123.73043416050049,122.43287085267794,121.28426705741521,120.27247827914593,119.38648495787983,118.61627245416614,117.95272557483929,117.38753566941442,116.91311862155619,116.52254230654486,116.20946229257358,115.96806473792188,115.79301558314111,115.67941526192993,115.6227582601192,115.61889694218308,115.66400914150127,115.75456907629393,115.88732120949072,116.05925671920838,116.26759228821584,116.50975095676597,116.783344814309,117.08615933259752,117.4161391661318,117.77137526629411,118.15009317330308,118.55064236565138,118.97148656027871,119.41119486864226,119.86843372430418,120.34195950684783,120.83061179503656,121.33330718926784,121.84903364969163,122.37684530194201,122.91585766738226,123.46524327914987,124.02422764919194,124.59208555495105,125.16813761745144,125.75174714529685,126.34231722155072,126.93928801267569,127.54213428067852,128.15036308137601,128.76351163328218],[127.39295467851532,125.6123267000582,124.02239312546831,122.6069539826952,121.35138619593687,120.24246650844886,119.26821698963006,118.41776990660891,117.68124924678366,117.04966659719793,116.51482943534789,116.06926017689355,115.70612456916628,115.41916822369068,115.20266025296709,115.0513431220118,114.96038794813458,114.92535458684422,114.942155930647,115.0070259233383,115.11649085726731,115.26734357667735,115.45662025803286,115.68157947942234,115.93968332666921,116.22858031453077,116.54608992801344,116.89018861197916,117.25899705735736,117.65076864983402,118.06387896222472,118.49681618515594,118.94817240243502,119.41663562781605,119.90098252894309,120.4000717722495,120.91283792964354,121.4382858940418,121.97548575632356,122.52356810116511,123.08171968354507,123.64917945156412,124.22523488464724,124.80921861924895,125.40050533690444,125.99850889190088,126.60267965801792,127.21250207573216,127.8274923830249,128.44719651449984],[126.17392494057876,124.44157053974396,122.89709885373216,121.5245241007478,120.30941738113233,119.23873180310397,118.30064991499012,117.48445026350126,116.78039039766523,116.17960405237464,115.67401058996276,115.25623506556417,114.91953752246228,114.65775032546334,114.46522251026475,114.33677027025749,114.2676328236882,114.25343300723316,114.29014202982593,114.37404789548673,114.50172706798234,114.67001900508845,114.87600323744454,115.11697870766587,115.3904451204794,115.69408608502278,116.02575385676262,116.38345550935009,116.76534038662273,117.16968870230191,117.59490117007837,118.03948956003319,118.50206808894842,118.98134556226201,119.47611819438283,119.98526304197944,120.50773199181859,121.04254625088532,121.58879129195768,122.14561221263389,122.71220947008892,123.28783495763992,123.87178839258283,124.46341398777618,125.06209738213677,125.66726280761097,126.2783704723353,126.89491414161915,127.5164189001058,128.14243908001563],[125.00112593983508,123.31521437942961,121.81448047588303,120.48314451465843,119.30696440826463,118.27306294138047,117.36977705522627,116.58652602855679,115.91369590681093,115.34253794036935,114.86507913325903,114.47404328756819,114.16278116643279,113.92520859789164,113.75575150981486,113.64929702787822,113.601149888591,113.60699352128604,113.66285523971999,113.76507505794655,113.91027770843912,114.095347494724,114.31740565744349,114.57378997294643,114.86203633819646,115.17986212578508,115.52515111884522,115.89593985824453,116.29040525409019,116.70685333070658,117.14370898921221,117.59950668491049,118.07288192818243,118.56256352764187,119.06736650316699,119.58618560422634,120.11798937579287,120.66181472022203,121.21676190884425,121.7819900017887,122.35671263878159,122.94019416741945,123.53174607875773,124.13072372303301,124.73652328099378,125.34857896868091,125.96636045562784,126.58937047833939,127.21714263261875,127.8492393298297],[123.87455767628411,122.23325821911536,120.77453799192085,119.48281522442711,118.3440272773334,117.34545992327843,116.47559841033851,115.7239972017757,115.08116577422061,114.53846826118217,114.08803506523671,113.72268484290548,113.43585550107787,113.22154304097556,113.07424725161738,112.98892339487386,112.96093914284292,112.98603612900281,113.06029556032921,113.18010741071782,113.34214277863741,113.54332904558412,113.78082751802955,114.05201327526393,114.35445697982043,114.68590843681764,115.04428171426106,115.42764165866248,115.83419165975961,116.26226253504814,116.71030241962634,117.17686755978762,117.66061392013708,118.16028952395571,118.6747274552957,119.20283945899031,119.74361008156649,120.29609130205202,120.85939760698328,121.43270146862926,122.01522918962296,122.60625708090272,123.20510794317198,123.81114782501966,124.42378303347546,125.04245737511083,125.66664960789528,126.29587108589305,126.92966358056368,127.56759726394203],[122.79422014992608,121.19570205880107,119.77727140184557,118.52353623005368,117.42060598833891,116.45592274879776,115.61811398032663,114.89686378315785,114.28279999989449,113.76739501481308,113.34287838589582,113.0021597315761,112.7387605263975,112.54675365471495,112.42070973567239,112.35564937124455,112.34700058644394,112.39056083038356,112.48246299165335,112.6191449538005,112.79732227857741,113.01396365766868,113.26626881920274,113.55164861461861,113.86770704535138,114.21222501812051,114.58314564301028,114.97856091060406,115.39669960363116,115.83591631532673,116.29468146132064,116.77157218466489,117.26526406481227,117.77452355120353,118.29820105076882,118.83522460627125,119.3845941091394,119.94537599637516,120.51669838637483,121.09774661315599,121.68775912261304,122.28602369808972,122.8918739858255,123.5046862937359,124.12387663958187,124.74889802690056,125.37923792913793,126.01441596427999,126.65398174394073,127.29751288235251],[121.76011336076088,120.20254589848682,118.82268070565739,117.60530753153827,116.53670054128098,115.60445141793845,114.7973237651909,114.10512577270323,113.51859858383249,113.02931820126204,112.62960909523635,112.31246795358011,112.07149624239169,111.9008404391099,111.79513896197984,111.74947495699024,111.75933421939409,111.82056762542818,111.92935753369257,112.08218768719462,112.27581620825907,112.50725133097772,112.77372956096319,113.07269599101024,113.40178653478927,113.75881186969357,114.14174290509283,114.5486976140691,114.9779290857048,115.42781467154204,115.8968461142952,116.38362055954217,116.88683236220817,117.40526560938528,117.93778728958634,118.48334104606911,119.04094145851163,119.6096688031916,120.18866424701879,120.77712543536857,121.37430243775175,121.9794940189803,122.59204420671851,123.21133912918181,123.83680409931301,124.4679009240502,125.10412541935554,125.74500511350035,126.39009712274975,127.03898618506125],[120.77223730878852,119.25378973817259,117.91076590335607,116.72812912888082,115.69231093615973,114.79104593070062,114.01322776493116,113.34878317041183,112.78856152603443,112.32423782052908,111.94822719325821,111.65360950891743,111.43406264906041,111.28380339416051,111.1975349305398,111.17040015211093,111.1979400416933,111.27605651413668,111.400979186447,111.56923561090018,111.77762456768239,112.02319206551121,112.30320974331079,112.61515540443887,112.95669544813404,113.32566899153693,113.7200735005087,114.13805176905778,114.57788010598047,115.0379576036943,115.51679637855001,116.01301268441942,116.52531881232463,117.0525156985011,117.59348617174844,118.14718877838416,118.71265212968316,119.28896972250124,119.87529518891526,120.47083793526711,121.07485913503932,121.68666804357473,122.30561860585075,122.93110633135736,123.56256541266883,124.19946606655969,124.84131207854827,125.48763853355399,126.13800971699082,126.79201717206814],[119.83059199400898,118.34943357785824,117.04152699494165,115.8920010220814,114.88743717297507,114.01570628708413,113.26582597954751,112.62783597628375,112.09268882650055,111.65215387261415,111.29873267996153,111.02558439758815,110.82645974640369,110.69564251986662,110.62789764135216,110.61842495660657,110.6628180533417,110.75702749650912,110.8973279499164,111.08028872491711,111.30274735684732,111.56178586126923,111.85470936624561,112.17902685490468,112.53243378538572,112.91279638365063,113.31813742925796,113.7466233755699,114.19655266445812,114.6663451117835,115.15453225408507,115.65974855929662,116.18072341516181,116.7162738185508,117.26529769725491,117.82676780321609,118.39972612265393,118.98327875430415,119.57659121206424,120.17888411285162,120.78942921447553,121.40754577187273,122.03259718322231,122.6639879002627,123.30116057964936,123.94359345442923,124.59079790671606,125.24231622444097,125.89771952666392,126.55660584337326],[118.93517741642221,117.48947741754408,116.21496398041432,115.09692321113997,114.1220792517271,113.27843248708898,112.55511840903984,111.94228419031896,111.43098048523073,111.01306635751737,110.68112555534634,110.42839261959202,110.24868753442149,110.1363578162283,110.086227094417,110.09354937047726,110.1539682543392,110.26348057254552,110.41840382410095,110.61534702924543,110.85118457575386,111.12303271825181,111.42822842976759,111.76431034240741,112.12900154654439,112.52019404603456,112.93593469134045,113.37441243360574,113.83394676113787,114.31297719580945,114.81005374090044,115.32382818417389,115.85304617071955,116.39653996953449,116.95322186610592,117.52207812056501,118.10216343742421,118.69259589860035,119.29255231646562,119.90126396812209,120.51801267606048,121.14212720387451,121.77297993883333,122.40998383589768,123.05258960025449,123.70028308765853,124.35258290385889,125.00903818616129,125.66922655176917,126.33275219897654],[118.08599357602843,116.67392125722979,115.43107685977387,114.3428956960565,113.39623717241568,112.57922453071535,111.88110505340821,111.29212781251742,110.80343650222495,110.40697527523871,110.09540581941253,109.86203417492935,109.70074601311389,109.60594928324552,109.57252328973426,109.59577339372298,109.67139064468576,109.79541574224577,109.9642068090005,110.17441052388527,110.42293622440219,110.7069326364588,111.02376693387676,111.37100586694721,111.74639873160991,112.14786197868872,112.57346528675635,113.02141894316489,113.49006239601978,113.97785385577238,114.48336083899595,115.0052515590511,115.54228707899794,116.09331415145212,116.65725867830132,117.23311973043104,117.81996407399357,118.41692115538972,119.02317850211944,119.63797750107844,120.26060951979412,120.89041233957995,121.52676687268357,122.16909413826232,122.81685247448434,123.46953496624779,124.12666706997682,124.78780441871491,125.45253079230626,126.12045623887812],[117.28304047282732,115.9027650969155,114.6898656330205,113.62991847683102,112.7099109350409,111.91808241796306,111.24378591265258,110.67736684287908,110.2100568774833,109.83388062577795,109.5415734721601,109.32650906359996,109.18263518248079,109.10441692091831,109.086786227304,109.1250970263437,109.21508522438143,109.35283300560981,109.53473690461519,109.75747920883639,110.01800230279213,110.31348561589031,110.64132487857307,110.99911342852408,111.38462534058245,111.79580018161319,112.23072921550558,112.68764290424777,113.1648995691036,113.6609750916722,114.17445354837179,114.70401868392831,115.24844613999687,115.80659636430376,116.3774081338412,116.95989263281403,117.55312803236237,118.15625452467238,118.76846976902588,119.38902471172081,120.01721974567657,120.65240117898921,121.29395798477324,121.94131880735667,122.59394920233899,123.25134909019684,123.91305040506988,124.57861492210193,125.24763224827555,125.91971796307786],[116.52631810681925,115.17600893660119,113.99133030015402,112.95799155346351,112.0631005396028,111.29500614883214,110.64316098677301,110.098001281404,109.6508416110057,109.29378240913535,109.01962851358903,108.821817285604,108.69435504252226,108.63176072924674,108.6290159071262,108.68152026833937,108.78505199342625,108.93573236263795,109.12999411094501,109.36455308409904,109.63638281092366,109.94269165654627,110.28090226385666,110.64863302713792,111.04368137346184,111.46400865480788,111.9077264775881,112.37308431685412,112.85845828038953,113.36234090350889,113.88333186902777,114.42012955880563,114.97152335371648,115.5363866080893,116.11367023272557,116.70239682771398,117.30165531253046,117.91059600644829,118.52842611718476,119.15440560004912,119.78784335370763,120.42809372210206,121.07455327510219,121.72665784318066,122.38387978381826,123.04572545950585,123.71173290913787,124.3814696963222,125.05453091967678,125.73053737157575],[115.81582647800386,114.49365277628695,113.33547086117458,112.32711492595406,111.45580598610128,110.70999572332261,110.07923027576949,109.55403112809226,109.12579070279226,108.78668062531085,108.52957094369945,108.3479588409413,108.23590559323831,108.1879807082307,108.19921232920092,108.26504311971001,108.38129095182015,108.54411381332997,108.74997842798983,108.99563214967304,109.27807774879682,109.59455075842673,109.94249908972738,110.31956466278882,110.72356683024813,111.15248739827297,111.6044570730039,112.07774318098399,112.57073852987752,113.08195129128249,113.6099958009641,114.15358418368282,114.71151872015666,115.28268488280895,115.86604497495438,116.46063231513098,117.06554591449782,117.67994560071732,118.30304754659612,118.93412016606332,119.57248034388738,120.21748996891867,120.86855274367052,121.52511124573432,122.18664421892224,122.85266407417474,123.52271458218105,124.19636874137585,124.87322680651005,125.55291446437197],[115.15156558638134,113.85569661597265,112.72228731608206,111.73728859430256,110.88802727453647,110.16305114143458,109.55199377964203,109.04545638294384,108.63490415284275,108.31257527430441,108.07140076249128,107.90493372961195,107.80728683462887,107.77307685787024,107.79737549352808,107.8756655804557,108.00380209956325,108.17797735768593,108.39468985574973,108.6507164055585,108.94308711641168,109.26906292153168,109.62611535618525,110.01190833547678,110.42428171094137,110.86123641200817,111.32092100175318,111.8016194966374,112.30174031756758,112.81980625499291,113.35444534418062,113.90438255856009,114.46843223931759,115.04549118846248,115.63453236052771,116.23459909506502,116.84479983826449,117.46430330747968,118.09233405725981,118.72816840976354,119.37113071621594,120.02058991943893,120.67595639047816,121.33667901501765,122.00224250765095,122.67216493420352,123.34599542419927,124.0233120572628,124.70371990877535,125.38684924146625],[114.53353543195162,113.2621404556584,112.15177966487643,111.18851255850895,110.35976440490823,109.65417240316786,109.06145149839054,108.57227704595853,108.17818196115749,107.87146635611604,107.64511796996452,107.49274195161594,107.40849876669398,107.38704917816533,107.42350540010762,107.51338765057648,107.6525854366554,107.8373229957057,108.06412839422472,108.32980585175538,108.63141091376815,108.96622814586112,109.33175106323039,109.72566404520178,110.14582601554153,110.59025569601371,111.05711826383573,111.54471326381442,112.05146364345968,112.57590579464015,113.11668049867738,113.6725246834373,114.2422639111991,114.82480552504987,115.41913238944547,116.02429716751604,116.63941708383052,117.26366912673528,117.89628564917614,118.53655033114974,119.18379447069321,119.83739357366292,120.49676421552519,121.1613611510307,121.8306746500043,122.50422803959219,123.18157543519261,123.86229964398314,124.54601022647267,125.23234170285892],[113.9617360147148,112.71298429534413,111.62394790755789,110.68078681857348,109.87101737721667,109.18335950852254,108.60760343201513,108.13449311713666,107.75562412773618,107.46335387074576,107.25072256611918,107.11138350695323,107.03954138943371,107.02989766911598,107.0776020489396,107.17820933007214,107.32764096309667,107.52215072738944,107.75829404341486,108.03290048826366,108.34304914086637,108.68604643141509,109.05940621086272,109.4608317919638,109.88819974404865,110.33954525028956,110.81304885925165,111.307024482515,111.81990850755392,112.35024991022442,112.89670126445442,113.45801055831453,114.03301373580111,114.62062789257138,115.2198450617076,115.82972653248403,116.44939765119582,117.07804305848407,117.7149023223449,118.35926593022178,119.01047160731916,119.66790093159058,120.33097621881157,120.99915765377338,121.6719406459824,122.34885339034079,123.02945461516087,123.71333150153677,124.40009775960209,125.08939184854965],[113.43616733467077,112.2082281350299,111.13879204412621,110.21411137449589,109.42178619146175,108.75061245749868,108.19044958051575,107.73210459647798,107.36723065257901,107.08823781819356,106.8882145509552,106.7608583956239,106.70041470284794,106.70162233072217,106.75966544002411,106.87013061894281,107.028968678887,107.23246055273704,107.47718680332004,107.76000031508342,108.07800179770614,108.42851777819351,108.80908079908212,109.21741157576287,109.65140289646268,110.10910507483563,110.58871278800082,111.0885531527391,111.60707490985008,112.14283860174552,112.69450764151159,113.26084018319173,113.84068171312377,114.43295829102688,115.03667037731427,115.65088718996905,116.27474154036042,116.90742510272621,117.54818407676616,118.19631520697986,118.85116212609391,119.51211199322206,120.17859240033727,120.8500685232458,121.52604049558521,122.20604098644925,122.88963296410431,123.57640762992374,124.26598250816352,124.95799967853866],[112.95682939181962,111.74787197471569,110.69631207458156,109.78848622627638,109.01207084764341,108.35593125009615,107.80998994389238,107.36511148398255,107.0130015356859,106.74611819845934,106.55759392447276,106.44116661762784,106.39111870693671,106.40222316298401,106.46969557336104,106.58915151718845,106.7565685840265,106.96825247174863,107.22080667394032,107.51110533221448,107.83626888428765,108.19364218619644,108.58077482788877,108.99540339659897,109.43543547278358,109.89893516965195,110.38411005008334,110.88929927448673,111.41296285034834,111.9536718692035,112.51009962984911,113.08101355806905,113.66526784316717,114.2617967204162,114.8696083362655,115.48777913997108,116.11544875132432,116.75181525946151,117.39613091243986,118.04769816142388,118.70586602701724,119.37002675855713,120.03961276010239,120.71409375944792,121.39297419881262,122.07579082791754,122.76211048202275,123.451528029144,124.14366447215693,124.83816519282583],[112.52372218616128,111.33191581440134,110.29650799892389,109.40391137391482,108.64187134576166,107.99931588631506,107.46622452214505,107.03351377965033,106.69293677705697,106.43699501154335,106.25886068667157,106.15230817296523,106.11165340169998,106.13170016590135,106.2076924489505,106.33527202480914,106.51044067851517,106.72952648442408,106.98915365527554,107.28621553965704,107.61785040061072,107.98141965542391,108.3744882972826,108.79480725447213,109.24029747301147,109.70903553473858,110.1992406454993,110.70926284775788,111.23757232904872,111.78274971259832,112.3434772294669,112.91853068294631,113.50677212593118,114.10714318073964,114.71865893856095,115.34040238249013,115.97151928408762,116.61121352868999,117.25874282936604,117.9134147935538,118.57458331008942,119.24164522759585,119.91403729810676,120.5912333623796,121.27274175566473,121.95810291474585,122.64688716891641,123.33869269919764,124.03314365158238,124.72988839141129],[112.13684571769576,110.96035965408707,109.93937981715315,109.06038681741131,108.31118768581663,107.6807663661554,107.15915331527377,106.73731148348142,106.40703637669202,106.16086825744533,105.99201483755191,105.89428306163585,105.86201878713781,105.89005333947428,105.97365606679229,106.1084921418048,106.29058496235274,106.51628259076344,106.78222774732603,107.08533093741102,107.42274634667548,107.79185018587576,108.19022120726366,108.61562314938229,109.06598889714627,109.53940617009542,110.03410457424846,110.54844387255261,111.08090334595107,111.63007213193006,112.19464044036485,112.7733915578235,113.36519456141566,113.96899767199693,114.58382218420101,115.20875691752616,115.8429531386501,116.48561991041176,117.13601982754473,117.79346510336974,118.45731397531027,119.12696740033846,119.80186601435048,120.48148733204107,121.16534316614162,121.85297724693395,122.54396302478504,123.23790164008464,123.93442004643988,124.63316927429486],[111.79619998642312,110.63320349377281,109.62492752926934,108.7579125567657,108.02001986780823,107.40028268961714,106.88877632327849,106.47650459547577,106.1553003345911,105.91773793616534,105.75705637711364,105.66709128363982,105.64221486325033,105.67728268370278,105.76758642688655,105.90881186817556,106.09700143553964,106.3285207907668,106.60002895009153,106.90845152547641,107.25095672248193,107.62493377755214,108.02797355783181,108.45785108132948,108.91250974518803,109.39004707572262,109.88870183633095,110.40684234887085,110.94295590105558,111.49563912719863,112.06358926254309,112.6455961827007,113.24053514962092,113.84736019418825,114.46509807318554,115.09284274507922,115.72975031501198,116.3750344046268,117.02796190697583,117.68784909087154,118.35405802267987,119.02599327678459,119.7030989088335,120.38485566843211,121.07077843024315,121.76041382448201,122.45333804962861,123.14915485180494,123.84749365672941,124.54800784147677],[111.50178499234319,110.35044733345858,109.35315113527255,108.49648859197805,107.76836789173637,107.1578648567002,106.65509354615921,106.25109311563345,105.93772865075439,105.7076040477036,105.55398530535676,105.47073283897717,105.45224163003734,105.4933881985869,105.58948352923336,105.73623120392121,105.92969009807557,106.16624108443398,106.44255726357213,106.75557730385319,107.10248152802993,107.48067043045302,107.88774534898725,108.32149105031375,108.77986001713664,109.26095825162008,109.76303243174685,110.28445827671266,110.82372999436208,111.3794506984042,111.9503236960015,112.53514455757792,113.13279389054674,113.74223074731351,114.3624866055145,114.99265986514929,115.63191081317318,116.27945701133505,116.93456906765947,117.59656675605933,118.26481545219809,118.93872285693452,119.61773598155594,120.30133837155297,120.98904754796939,121.68041264738989,122.37501224344742,123.07245233435856,123.77236448245108,124.47440409295679],[111.25360073545626,110.11209117314428,109.12405063516273,108.27611492304838,107.55623175760124,106.95351286740473,106.45810498391607,106.06107704395433,105.75432132518166,105.53046659205972,105.38280162228128,105.30520772764783,105.2920990874988,105.33836988412645,105.4393473738326,105.5907501490419,105.78865094996067,106.02944347176508,106.30981268776776,106.62670827254142,106.97732076331968,107.35906014457844,107.76953658072983,108.20654305633498,108.66803971299217,109.15213969778773,109.65709636049613,110.181291656078,110.72322562587063,111.28150684554656,111.85484374074032,112.4420366824552,113.0419707841932,113.65360933137271,114.27598778118802,114.90820827773631,115.54943463313353,116.19888773053653,116.8558413095955,117.51961809893315,118.1895862638651,118.86515614078819,119.54577723251771,120.23093544140343,120.9201505193204,121.6129737156577,122.30898560624127,123.00779408774552,123.70903252360465,124.41235802873511],[111.05164721576215,109.91813501282999,108.9376260289399,108.09679154997684,107.38361146540269,106.78722672173058,106.2978106365489,105.90645638043848,105.60507835787311,105.38632556923407,105.24350532788722,105.17051594965174,105.16178723563488,105.21222774032167,105.31717796068425,105.47236870353755,105.67388399119474,105.91812795276012,106.20179522267854,106.52184443154104,106.87547442835114,107.26010291992826,107.67334725305957,108.11300709939333,108.57704883275474,109.06359141422573,109.57089362257871,110.09734248696691,110.64144279558133,111.20180756862584,111.77714939675924,112.36627255733244,112.96806583056025,113.58149594636593,114.20560160020594,114.83948798284042,115.48232177489341,116.13332656223133,116.7917786327841,117.45700311949278,118.12837045768084,118.80529312834551,119.48722266171882,120.1736468779836,120.864087344296,121.55809702928542,122.25525813801019,122.95518011196593,123.65749778019034,124.36186964881153],[110.89592443326079,109.76857885251574,108.79387731660394,107.95851847276325,107.25050701514084,106.65900641967787,106.17421050405781,105.78723112508594,105.48999974882854,105.27518097922645,105.13609642217465,105.06665750498912,105.06130607444548,105.11496176717245,105.22297528978844,105.38108686740821,105.58538922177804,105.83229452741907,106.11850486830434,106.44098578085212,106.79694252312409,107.18379875650263,107.5991773659765,108.04088317948867,108.50688737642415,108.99531340093398,109.50442421799453,110.03261076937946,110.57838150349393,111.14035286764201,111.71724066405844,112.30785218220964,112.91107902964791,113.52589059229311,114.15132806256825,114.78649898046147,115.43057223845237,116.08277350641933,116.74238103722519,117.40872181773847,118.08116803364528,118.75913381960656,119.44207226915927,120.12947268129345,120.82085802289633,121.51578258827297,122.21382983875405,122.91461040701951,123.61776025220797,124.3229389531862],[110.78643238795233,109.66342269220145,108.69280449815501,107.86129569140753,107.15691840681549,106.56885196124659,106.08730458644266,105.7034012778966,105.40908549804806,105.19703282203689,105.06057490514338,104.99363239365968,104.99065560393066,105.04657196467879,105.15673936114503,105.31690464065395,105.52316664171042,105.77194319574191,106.05994162464522,106.38413232047462,106.74172504763877,107.13014765430148,107.54702691948069,107.990171296621,108.45755534400045,108.94730565791252,109.45768814674369,109.98709650331541,110.53404174960878,111.09714274259512,111.67511754263785,112.26677555708693,112.87101038145627,113.48679326915428,114.11316716827507,114.74924127059961,115.39418602381079,116.04722856310053,116.70764852291873,117.37477419367005,118.04797899175844,118.72667821457124,119.41032605483905,120.0984128513329,120.79046255512138,121.48603039262052,122.18470070847324,122.88608497290639,123.5898199396577,124.29556594185904],[110.72317107983662,109.60266653188719,108.63440757359307,107.80512320590981,107.10284564042691,106.51676334643675,106.03709288370362,105.65496683887055,105.36233560553178,105.15188109766537,105.01694077679359,104.95144061566373,104.94983582409033,105.00705833284067,105.11847017475417,105.27982202327462,105.48721625099192,105.7370739577286,106.02610549170129,106.35128405040848,106.70982200189502,107.0991496133248,107.51689591357194,107.96087145079056,108.42905273548371,108.91956818516127,109.43068540882628,109.96079968877493,110.50842353392547,111.07217719348503,111.65078003249756,112.24304268196417,112.84785988598522,113.46420397694939,114.0911189173264,114.72771485325467,115.37316313096848,116.02669173227503,116.68758108986478,117.35516024728759,118.0288033320203,118.7079263132397,119.39198401875814,120.08046738810211,120.77290094097106,121.46884044232782,122.16787074716726,122.86960380962674,123.57367684253947,124.27975061483018],[110.70614050891382,109.58631037157295,108.61868654291808,107.79000101627021,107.08828871597494,106.50274057524813,106.02357539584057,105.64192780800782,105.34975007127939,105.13972580611197,105.00519403712514,104.94008217100094,104.93884673492462,104.99642087165806,105.10816773061558,105.26983901527034,105.47753804962255,105.72768681337931,106.01699646947232,106.34244097065378,106.70123338589302,107.09080463357262,107.50878434825049,107.95298364199698,108.42137955087392,108.91210098268031,109.42341600424217,109.9537203257581,110.50152685644443,111.0654562203118,111.64422813363744,112.23665355684142,112.84162754323469,113.45812271567853,114.08518330972207,114.72191972842678,115.36750355992551,116.02116301394275,116.68217873806321,117.34987997859109,118.02364105443093,118.70287811561182,119.38704616091665,120.07563629160093,120.7681731804455,121.46421273739507,122.1633399548364,122.86516691718037,123.56933096085321,124.27549297209943],[110.73534067518392,109.61435421125864,108.64564140613007,107.81592912248847,107.11324763345959,106.52678364768109,106.04675212285358,105.66428418530829,105.3713288952912,105.16056694737661,105.02533468613821,104.95955705967171,104.95768833643351,105.01465958113114,105.12583202872958,105.28695561664098,105.4941320376023,105.7437817626939,106.03261455795847,106.35760308121053,106.71595919963262,107.10511271504497,107.52269222351615,107.96650787024043,108.43453579017105,108.92490405046964,109.43587993299144,109.96585841426467,110.51335171716525,111.07697982307548,111.65546184605768,112.24760818171865,112.85231335320481,113.46854948534147,114.09536034546234,114.73185589611585,115.37720731068184,116.03064240810363,116.69144146751418,117.35893338758059,118.03249215899025,118.71153362168775,119.39551248131447,120.08391956182943,120.77627927354465,121.47214727782224,122.17110833148071,122.8727742955674,123.57678229459901,124.28279301366696],[110.81077157864667,109.68679805094439,108.71527216322902,107.88290752456487,107.1777223928808,106.58889256373536,106.10662306474262,105.72203597077201,105.42707207756715,105.21440452145937,105.07736272383264,105.00986528167562,105.00636062861683,105.06177446125973,105.17146306909598,105.3311718273867,105.53699821493109,105.78535880567239,106.07295975715972,106.39677038207873,106.75399944311384,107.14207385774178,107.55861953936902,108.00144413552101,108.46852145337513,108.95797738852923,109.46807719507396,109.99721395429491,110.54389811608827,111.10674800177611,111.68448116975813,112.27590655659587,112.8799173158957,113.49548428593855,114.12165002454701,114.75752335632198,115.4022743832374,116.05512991475781,116.71536927821764,117.38232047425598,118.05535664569823,118.73389283146722,119.41738297995163,120.10531719878767,120.79721922026847,121.49264406360929,122.19117587710002,122.89242594478765,123.59603084377683,124.30165073953265],[110.93243321930247,109.80364189063013,108.82757881421492,107.99093622249919,107.28171299423869,106.68906732341111,106.20318822150773,105.81518316439902,105.51697961810709,105.30123852836017,105.16127815020852,105.09100683701298,105.08486361147473,105.13776551204387,105.24506085171484,105.40248764750737,105.60613658160909,105.85241794231477,106.13803206707601,106.45994287325823,106.81535411633686,107.20168806166301,107.61656629580906,108.05779243783856,108.52333654048608,109.01132099685908,109.5200077904899,110.04778694584861,110.59316605321335,111.15476075641354,111.73128610473873,112.32154868147315,112.92443943130715,113.53892711746948,114.16405234697618,114.79892210904514,115.44270477759234,116.09462553390524,116.75396217017355,117.42004123861736,118.09223451455496,118.76995574495049,119.45265765682809,120.13982920247558,120.830993020617,121.52570309475628,122.22354259169444,122.92412186484137,123.62707660838676,124.33206614969667],[111.10032559715094,109.96488573031587,108.98256135908778,108.1400152162914,107.42521943753324,106.82730792670816,106.33644759314876,105.9437257661893,105.64105151691106,105.42106896807906,105.27708096526578,105.20298172568354,105.19319728500723,105.24263273348365,105.34662537658615,105.50090307700304,105.70154713763614,105.94495917262117,106.22783148770739,106.54712055474927,106.90002321930139,107.28395532680884,107.69653249283633,108.13555277719324,108.59898105150391,109.08493487545923,109.59167171923903,110.11757738892584,110.66115552854041,111.22101808698787,111.7958766509997,112.3845345563504,112.98587969943917,113.59887797993447,114.22256731274975,114.85605215428521,115.4984984937466,116.14912926554591,116.80722014338188,117.47209568066468,118.14312576556047,118.81972236213745,119.501336511944,120.18745557289314,120.87760067459023,121.57132437126309,122.26820847526386,122.96786205572829,123.66991958842864,124.37403924415872],[111.31444871219229,110.17052957000162,109.18021979784757,108.33014450594172,107.6082417227644,107.00361437362668,106.50640117966593,106.1076637761429,105.79928777397922,105.57389584061607,105.42477116900443,105.34578994768762,105.33136164921423,105.37637612557899,105.47615664370994,105.62641811587378,105.82322988301223,106.06298249659137,106.34235801905388,106.65830342655165,107.00800675200762,107.38887565317904,107.79851813045077,108.23472515358483,108.69545498642874,109.1788190243296,109.68306898132161,110.20658528352668,110.74786654206957,111.30551999349919,111.87825280854085,112.46486418122755,113.06423812029183,113.67533687333339,114.29719492186784,114.92891349204237,115.56965553170015,116.21864110967985,116.87514319784273,117.53848380039787,118.20803039871467,118.88319268302813,119.56341954529913,120.24819631004041,120.93704218218809,121.62950789312978,122.32517352780835,123.02364651744851,123.72455978390262,124.42757002291904],[111.57480256442656,110.42057340968732,109.42055413049439,108.56132409144995,107.83077984993221,107.21798666416656,106.71304898105909,106.30699719425974,105.99168838931146,105.759719145971,105.6043487614245,105.51943150302486,105.49935670409582,105.53899568832975,105.63365465308624,105.77903276411945,105.97118481773757,106.20648791422553,106.48161166111541,106.7934914886655,107.13930471445551,107.51644904077384,107.92252320865234,108.35530956701352,108.81275834526049,109.29297344347033,109.79419957673743,110.31481062965105,110.85329909380077,111.4082664759473,111.97841457736222,112.56253755610486,113.15951469386511,113.76830379766626,114.38793517433035,115.01750612231646,115.656175891453,116.30316106630697,116.95773133355613,117.61920559781707,118.28694841401759,118.96036670762251,119.63890675689372,120.32205141391728,121.0093175434107,121.7002536603563,122.39443774932798,123.09147525000226,123.79099719480857,124.49265848597763],[111.88138715385354,110.71501724937308,109.70356435702813,108.83355397281619,108.09283381903663,107.47042479832787,106.95639099732824,106.54172602053978,106.21825336290772,105.97853888414417,105.81581374252599,105.72390639169551,105.6971824496519,105.73049142173619,105.81911940471494,105.95874702174015,106.14541194181197,106.3754754255236,106.64559241389206,106.95268474109072,107.293917106645,107.66667548959309,108.0685477274412,108.49730601747927,108.95089112799923,109.42739813288129,109.92506350548675,110.44225342729891,110.97745318373406,111.52925753433222,112.09636195746384,112.6775546809821,113.27170942015901,113.87777875293317,114.49478807013735,115.12183004510764,115.75805957300513,116.40268913542738,117.05498455052192,117.71426107292226,118.37987981146921,119.05124443592049,119.72779814672757,120.40902088452394,121.09442675825801,121.78356167294288,122.47600113982263,123.17134825338917,123.8692318211466,124.56930463333434],[112.23420248047351,111.05386108905883,110.02925047744895,109.14683415004038,108.39440363007763,107.76092877611055,107.23642722847343,106.81185025498311,106.47898269476805,106.23035505513535,106.05916611230893,105.9592146136995,105.92483888588261,105.95086332579827,106.03255089859607,106.16556088873581,106.34591125523545,106.56994503048553,106.83430027738379,107.13588318382736,107.47184392857623,107.83955499963686,108.23659168681715,108.66071450498207,109.1098533346448,109.58209309256246,110.07566076756922,110.58891367647038,111.12032881186938,111.66849316865412,112.23209494884571,112.80991555585926,113.40082229917351,114.00376173913389,114.61775360928877,115.2418852604158,115.87530657635659,116.51722531704097,117.16690284874026,117.82365022571338,118.48682459106951,119.15582586792222,119.83009371480078,120.50910472186015,121.19236982673002,121.87943193088931,122.5698636992924,123.26326552760949,123.95926366291663,124.65750846498929],[112.63324854428622,111.43710492874455,110.39761249175656,109.50116462312268,108.73548928305537,108.08949859751468,107.55315767449474,107.11736989758973,106.77387638489255,106.51516765894462,106.33440587077332,106.22535616903683,106.1823260127878,106.20011140051581,106.27394913472976,106.39947436510647,106.5726827580081,106.78989672911143,107.04773525159058,107.34308681687546,107.67308518024907,108.03508757090508,108.42665508678036,108.84553502952187,109.28964496519727,109.75705832251394,110.24599136298509,110.75479137716545,111.28192597820673,111.82597337891289,112.38561355150782,112.95962018073654,113.54685333090873,114.14625275626877,114.75683179178465,115.37767176824094,116.00791690150736,116.64676961114779,117.29348622821102,117.94737305619037,118.60778275281852,119.27411100362777,119.94579346111337,120.62230292592621,121.30314674882675,121.98786443419556,122.67602542773712,123.36722707266317,124.06109272011872,124.75726998094247],[113.07852534529172,111.86474876843025,110.80865039995122,109.89654539206286,109.11609077796966,108.45613426254013,107.90658233539205,107.45828494835956,107.10293443328109,106.83297669557189,106.64153301791899,106.52233105770745,106.46964383036762,106.47823564588896,106.54331411311583,106.66048745085213,106.82572645012981,107.03533052140121,107.28589733651249,107.57429564023494,107.89764086166349,108.25327320339778,108.63873792733067,109.05176759109864,109.49026601965672,109.9522938227357,110.43605529173433,110.93988652938398,111.46224468274623,112.00169816510856,112.55691776545022,113.12666855561379,113.70980251536447,114.30525180433754,114.9120226176251,115.52918956858315,116.15589054845739,116.79132201774789,117.4347346889343,118.08542956435336,118.74275429671641,119.40609984303694,120.07489738566521,120.7486154967218,121.42675752454809,122.10885918286172,122.79448632515704,123.48323288855009,124.1747189927528,124.86858918119394],[113.57003288349016,112.336792608116,111.26236420203287,110.33297645686108,109.53620811482062,108.86083577118703,108.29670121116533,107.83459540729275,107.46615683993363,107.18378216501733,106.98054755374616,106.8501392797114,106.78679233862192,106.78523606191759,106.84064583375435,106.94860014597285,107.10504233160061,107.30624640735489,107.54878653214939,107.82950965390584,108.14551097281966,108.49411189711496,108.8728402084682,109.27941218971255,109.71171649802298,110.16779959322776,110.64585255381687,111.14419913312607,111.66128492548764,112.19566752724107,112.74600759067283,113.31106068049104,113.88966985254091,114.4807588833402,115.0833260868099,115.69643866144229,116.31922751720684,116.95088253684126,117.59064823091002,118.23781975020243,118.89173922276288,119.55179238614981,120.21740548845645,120.88804243424713,121.56320215389421,122.24241617688776,122.92524639155199,123.61128297527051,124.30014248081893,124.99146606574347],[114.10777115888129,112.85323644780171,111.75875389800152,110.81045781751723,109.99584129360819,109.30360312345535,108.72351430181476,108.24630127438915,107.86354360485036,107.56758406728082,107.35144947825472,107.20878083504881,107.13377153755081,107.12111264860188,107.16594429664532,107.26381245046852,107.41063040242059,107.60264438697253,107.83640283850153,108.10872885788818,108.41669551371737,108.75760365205673,109.12896193019297,109.52846882536346,109.95399640029639,110.40357563399006,110.87538314923276,111.36772918839169,111.87904670643123,112.40788146531048,112.9528830271757,113.51279655536825,114.08645534243793,114.67277399327692,115.27074219933917,115.87941904681848,116.49792780775546,117.12545116842784,117.76122685413823,118.40454361373733,119.05473753095814,119.71118863296644,120.37331776948704,121.04058373850214,121.71248063686504,122.38853541627377,123.06830562692198,123.75137733282405,124.43736318431708,125.1259006345913],[114.69174017146538,113.41408028748742,112.29781948785707,111.32898947403135,110.49499031433241,109.78443631934493,109.18702160734017,108.69340254964882,108.29509472803116,107.98438240236229,107.75423879144475,107.59825572371949,107.51058142715425,107.48586540594175,107.51920950178872,107.60612436433919,107.74249066258969,107.92452446025406,108.14874625556862,108.41195325218197,108.71119448435685,109.04374846822287,109.40710309250484,109.79893749805143,110.2171057264765,110.65962194502261,111.12464707798196,111.61047669518088,112.11553002557685,112.63833997931681,113.17754407495883,113.73187618024545,114.30015898505555,114.88129713414756,115.47427095521293,116.0781307247117,116.69199142010352,117.3150279125076,117.94647055861897,118.58560115495813,119.23174922130204,119.88428858348674,120.54263422875709,121.20623940948686,121.87459297346052,122.54721690101962,123.22366403126703,123.90351596121096,124.58638110324726,125.27189288773734],[115.32193992124232,114.01932412717316,112.87956097159959,111.88857142640359,111.03365517699328,110.3033353588561,109.68722312774162,109.17589923307176,108.76081020947599,108.43417717026199,108.18891549331612,108.01856394572341,107.91722200743222,107.87949433393712,107.90044144918463,107.97553588758494,108.10062311210791,108.27188662719954,108.4858167833508,108.73918283678715,109.02900788473796,109.35254634561358,109.70726369540385,110.09081820777644,110.50104447656364,110.93593852632542,111.39364434006451,111.87244165349357,112.37073488292451,112.88704306925997,113.41999073402214,113.96829955512275,114.53078078039378,115.10632830595218,115.69391235443121,116.29257369512192,116.90141835425088,117.51961276908074,118.14637934435208,118.7809923738649,119.42277429379469,120.07109223771067,120.72535486626631,121.38500944720123,122.04953916368075,122.7184606311254,123.39132160458723,124.06769886043128,124.7471962376096,125.42944282518155],[115.99837040821207,114.66896796685889,113.50397834922913,112.4892036746337,111.61183588159074,110.86030024198851,110.22411886301909,109.69379132465792,109.26069004918493,108.91696837097962,108.65547958386894,108.46970550106067,108.35369327838474,108.30199943258813,108.30964013883302,108.3720470202056,108.48502775097516,108.64473088780888,108.84761442184815,109.09041761170373,109.37013571486062,109.68399728422878,110.02944373889027,110.40411095453835,110.80581265055773,111.23252537789854,111.68237493548045,112.15362406332991,112.64466127847425,113.15399073514,113.68022300436573,114.22206668000001,114.77832072845266,115.34786750869085,115.92966639699387,116.52274795804904,117.12620861019744,117.73920573814706,118.3609532113378,118.99071727045765,119.6278127484361,120.27159959563836,120.92147968201493,121.57689385164522,122.23731920752552,122.90226660659101,123.57127834688245,124.24392603048501,124.91980858740384,125.59855044692398],[116.72103163237455,115.36301180654461,114.17107162074556,113.13088621872188,112.22953242812494,111.45533096874252,110.79770881317252,110.24707882440738,109.7947342471579,109.43275600451543,109.15393106310319,108.95168038973134,108.81999524001182,108.7533807018946,108.7468055707338,108.79565776220129,108.89570457919156,109.04305724208207,109.23413917106046,109.46565757693172,109.73457797472503,110.03810128406846,110.37364322296369,110.73881573833748,111.13141024845872,111.54938249974188,111.99083886422963,112.45402392468972,112.93730921222595,113.439182976957,113.95824088598953,114.49317755487721,115.04277882923219,115.60591474236335,116.18153308290098,116.76865351349325,117.36636218794342,117.97380681970652,118.59019215957589,119.21477584473639,119.84686458522616,120.48581065726977,121.13100867600286,121.78189262281896,122.43793310499508,123.09863482741657,123.76353425815273,124.43219747137196,125.10421815263017,125.77921575296463],[117.48992359372998,116.10145564623042,114.88084078614904,113.813619058668,112.88674481659561,112.08842753911773,111.40799297820203,110.83576173232008,110.36294280339504,109.98154007086923,109.68426993101879,109.46448861173533,109.31612789231342,109.23363814185677,109.21193774488704,109.24636811357192,109.33265359675704,109.46686569001922,109.64539103098787,109.86490273247119,110.12233466433106,110.41485834513259,110.73986214762428,111.09493255917359,111.4778372702666,111.88650989185552,112.31903612631216,112.7736412375731,113.24867868417986,113.74261979471082,114.25404437889367,114.78163217975447,115.32415508273228,115.88047000696994,116.4495124121526,117.0302903614545,117.62187908748858,118.22341601375932,118.83409618906643,119.45316809670106,120.079929804165,120.71372542260484,121.35394184823015,122.00000576072242,122.65138085608943,123.30756529360195,123.96808933839809,124.63251318309224,125.30042493328851,125.97143874330351],[118.30504629227829,116.88429948591606,115.63328584543942,114.53740219447205,113.58347304700305,112.75958995311446,112.05497135810766,111.45984004839613,110.96531571789617,110.56332057004123,110.24649618761586,110.00813016707266,109.8420912352896,109.7427717524744,109.70503666129275,109.72417807431766,109.79587480367172,109.91615623162036,110.08137000163046,110.288153078322,110.53340578367882,110.81426846742116,111.12810051287214,111.47246141704669,111.84509371598145,112.24390755423944,112.66696672172804,113.11247600198001,113.57876969433578,114.06430118840153,114.56763348307797,115.08743055463168,115.62244948895309,116.17153330251038,116.73360438474869,117.30765850193272,117.89275930883319,118.48803332030535,119.09266529980952,119.70589402635171,120.32700840525254,120.95534389164368,121.59027919869686,122.23123326535543,122.87766246080835,123.52905800514728,124.18494358761845,124.84487316564592,125.50842892937882,126.17521941794057],[119.16639972801931,117.71154332560184,116.42840679861681,115.30223562613418,114.3197171193471,113.46881821073254,112.73864395288918,112.11931377263546,111.60185299066144,111.17809750203124,110.84060983289434,110.58260505574329,110.39788526894026,110.2807815337476,110.226102319951,110.22908764443832,110.28536819993552,110.3909288668853,110.54207608298807,110.73540861448427,110.96779133276807,111.23633165093429,111.53835831870717,111.87140231195693,112.23317958560318,112.62157548689366,113.03463065047727,113.47052821791054,113.92758224269372,114.40422715802917,114.89900819854256,115.41057267950889,115.93766204789443,116.47910462898487,117.03380900068922,117.60075793492797,118.17900285197702,118.76765873934461,119.36589949180508,119.97295363368821,120.58810038848871,121.21066606438617,121.84002072740286,122.47557513671822,123.11677791915197,123.76311296205247,124.41409700581401,125.06927741903284,125.72823014090136,126.39055777687588],[120.07398390095317,118.58318716528757,117.26620364568109,116.10811935365426,115.0954770336276,114.216112311972,113.45901076254682,112.814182905038,112.27255462169079,111.82587086683928,111.4666108668542,111.18791327774731,110.98350999326551,110.84766748567642,110.77513472086162,110.761096823934,110.80113378554832,110.89118359581425,111.02750927506078,111.20666934095799,111.42549131159909,111.68104789567191,111.9706355651293,112.29175524390409,112.64209487913186,113.01951368981807,113.4220279125598,113.84779788536443,114.29511632925369,114.76239770359363,115.24816852528737,115.75105855438618,116.26979275955644,116.80318398639332,117.35012625997422,117.90958866044015,118.48060971692018,119.06229227087708,119.65379876505307,120.25434691871077,120.8632057538737,121.47969194083237,122.10316643434815,122.73303137481059,123.36872723112032,124.00973016431749,124.65554959298454,125.30572594325319,125.95982856785567,126.61745382010929],[121.02779881107995,119.49923100497327,118.14667638663236,116.95505337703241,115.91075278984495,115.00147225683286,114.21607178708057,113.54444744560378,112.9774206109842,112.50664066446546,112.1244992894955,111.82405483308463,111.59896540826546,111.44342960826083,111.35213386402472,111.32020561280467,111.34317156051036,111.4169204184071,111.53766957784855,111.70193525774313,111.90650572017171,112.14841720163399,112.4249322521388,112.73352021288835,113.07183959656756,113.43772216301285,113.82915850797562,114.24428500434198,114.68137195401579,115.13881282509502,115.61511446331238,116.1088881792634,116.61884162393902,117.14377137473576,117.68255616260362,118.23415067846943,118.79757990366262,119.37193391490285,119.9563631195536,120.55007388141924,121.15232450140742,121.76242152098227,122.37971631953285,123.00360197963272,123.63351039671343,124.26890961194239,124.90930134913025,125.55421873830679,126.20322421024217,126.85590754764095]],"x":[0.5,0.51020408163265307,0.52040816326530615,0.53061224489795922,0.54081632653061229,0.55102040816326525,0.56122448979591832,0.5714285714285714,0.58163265306122447,0.59183673469387754,0.60204081632653061,0.61224489795918369,0.62244897959183676,0.63265306122448983,0.64285714285714279,0.65306122448979587,0.66326530612244894,0.67346938775510201,0.68367346938775508,0.69387755102040816,0.70408163265306123,0.7142857142857143,0.72448979591836737,0.73469387755102034,0.74489795918367352,0.75510204081632648,0.76530612244897955,0.77551020408163263,0.7857142857142857,0.79591836734693877,0.80612244897959173,0.81632653061224492,0.82653061224489788,0.83673469387755106,0.84693877551020402,0.8571428571428571,0.86734693877551017,0.87755102040816324,0.88775510204081631,0.89795918367346927,0.90816326530612246,0.91836734693877542,0.9285714285714286,0.93877551020408156,0.94897959183673464,0.95918367346938771,0.96938775510204078,0.97959183673469385,0.98979591836734693,1],"y":[0.5,0.51020408163265307,0.52040816326530615,0.53061224489795922,0.54081632653061229,0.55102040816326525,0.56122448979591832,0.5714285714285714,0.58163265306122447,0.59183673469387754,0.60204081632653061,0.61224489795918369,0.62244897959183676,0.63265306122448983,0.64285714285714279,0.65306122448979587,0.66326530612244894,0.67346938775510201,0.68367346938775508,0.69387755102040816,0.70408163265306123,0.7142857142857143,0.72448979591836737,0.73469387755102034,0.74489795918367352,0.75510204081632648,0.76530612244897955,0.77551020408163263,0.7857142857142857,0.79591836734693877,0.80612244897959173,0.81632653061224492,0.82653061224489788,0.83673469387755106,0.84693877551020402,0.8571428571428571,0.86734693877551017,0.87755102040816324,0.88775510204081631,0.89795918367346927,0.90816326530612246,0.91836734693877542,0.9285714285714286,0.93877551020408156,0.94897959183673464,0.95918367346938771,0.96938775510204078,0.97959183673469385,0.98979591836734693,1],"type":"surface","contours":{"z":{"show":true,"usecolormap":true,"highlightcolor":"#ff0000","start":104.93884673492462,"end":128.76351163328218,"size":1,"project":{"z":true}}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<figcaption class="figure-caption">Figure&nbsp;5.3: Likelihood surface with two parameters</figcaption>
</figure>
</div>
</div>
<p>We can also see the path our estimates take, starting at a rather poor point, but quickly updating to better values. We also see little exploratory jumps creating a star like pattern, before things ultimately settle to the best values. In general, these updates and paths are dependent on the optimization algorithm one uses.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-likelihood-path" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="estimation_files/figure-html/fig-r-likelihood-path-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5.4: Optimization path two parameters</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout-info">
<p>It turns out that in the case of a normal distribution, the maximum likelihood estimate of the standard deviation is the estimate as the standard deviation of the residuals. Furthermore, the maximum likelihood estimates and OLS estimates converge to the same estimates as the sample size increases. For any data of significance, these estimates are indistinguishable, and the OLS estimate is the maximum likelihood estimate for linear regression.</p>
</div>
<section id="additional-thoughts-on-maximum-likelihood" class="level4" data-number="5.8.0.1">
<h4 data-number="5.8.0.1" class="anchored" data-anchor-id="additional-thoughts-on-maximum-likelihood"><span class="header-section-number">5.8.0.1</span> Additional Thoughts on Maximum Likelihood</h4>
<p>NEEDS WORK</p>
<p>One of the key things to note is that maximum likelihood is an estimation technique that relies on specifying the probability distribution that serves as the data generating process. Maximum likelihood allows us to be explicit about why we think those target values are the way they are. The likelihood also serves as a fundamental part of Bayesian analysis, which we’ll discuss more later. In general, maximum likelihood is a powerful technique that can be used in many contexts, and likelihoods can be used as the objective for many machine learning algorithms as well.</p>
</section>
</section>
<section id="estimation-quick-review" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="estimation-quick-review"><span class="header-section-number">5.9</span> Estimation: Quick Review</h2>
<p>MOVE WHERE? NEEDED?</p>
<p>At this point we understand a few things:</p>
<ul>
<li>Parameters are the values associated with a model</li>
<li>Objective functions specify a modeling goal with which to estimate the parameters.</li>
<li>Estimation is a way of finding the best model, i.e.&nbsp;parameters that help us achieve a goal.</li>
<li>Optimization is the process of finding the parameters that maximize or minimize some objective function</li>
<li>The likelihood is an alternate way to assess the match of data and model, and allows us to compare the relative fits of models</li>
</ul>
</section>
<section id="penalized-objectives" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="penalized-objectives"><span class="header-section-number">5.10</span> Penalized Objectives</h2>
<p>MOVE TO AFTER CLASSIFICATION?</p>
<p>One thing we may want to take into account of with our models is their complexity, especially in the context of <strong>overfitting</strong>. We talk about this in the machine learning chapter also, but the basic idea is that we can get too close to the data we have, such that when we try to predict on new data, our performance suffers or even gets worse than a simpler model. In other words, we are not generalizing well. One way to deal with this is to <strong>penalize the objective function value for complexity</strong>, or at least favor simpler models that might do as well. In some contexts this is called <strong>regularization</strong>, and in other contexts <strong>shrinkage</strong>, since the values are typically shrunk toward zero.</p>
<p>As a starting point, in our basic linear model we can add a penalty that is applied to the size of coefficients, and we can control the strength of the penalty. This is called <strong>ridge regression</strong> or <strong>L2 regularization</strong>. The penalty is just the sum of the squared coefficients multiplied by a constant, which we call <span class="math inline">\(\lambda\)</span>. We can write this formally as:</p>
<p><span class="math display">\[
\textrm{Value} = \sum_{i=1}^{n} (y_i - \hat{y_i})^2 + \lambda \sum_{j=1}^{p} \beta_j^2
\]</span></p>
<p>Where <span class="math inline">\(y_i\)</span> is the actual value of the target for observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(\hat{y_i}\)</span> is the predicted value from the model. The first part is the same as before, but the second part is the penalty for <span class="math inline">\(p\)</span> features. The penalty is the sum of the squared coefficients multiplied by a constant, which we call <span class="math inline">\(\lambda\)</span>. This is an additional parameter to the model that we will typically want to estimate in some fashion, e.g.&nbsp;through cross-validation, often called a hyperparameter, mostly just to distinguish it from those that may be of actual interest. For example, we could probably care less what the actual value for <span class="math inline">\(\lambda\)</span> is, but we would still be interested in the coefficients.</p>
<p>Interestingly, as you’ll notice that this is just OLS+, you might be wondering how our results or interpretation might change. Well for starters, L2 regularization is not limited to linear regression, so just keep that in mind. But also, if we know that OLS produces <strong>unbiased</strong> estimates if assumptions of linear regression are met, that means these estimates have to be biased since they won’t be the same, right? Your are correct! As we note in the ML chapter, the bias-variance tradeoff is a key concept in machine learning, and this is a good example of that. We are introducing some bias in order to reduce the variance. In other words, we are willing to accept some bias in order to get a model that generalizes better.</p>
<p>Another common penalty that is the sum of the absolute value of the coefficients, which is called <strong>lasso regression</strong> or <strong>L1 regularization</strong>. An interersting property of the lasso is that in typical implementations, it will potentially zero out coefficients, which is the same as dropping the feature from the model altogether. This is a form of <strong>feature selection</strong> or <strong>variable selection</strong>. The true values are never zero, but if we want to use a ‘best subset’ of features, this is one way we could do so. We can write the lasso objective as:</p>
<p><span class="math display">\[
\textrm{Value} = \sum_{i=1}^{n} (y_i - \hat{y_i})^2 + \lambda \sum_{j=1}^{p} |\beta_j|
\]</span></p>
<p>But let’s get to a code example to make sure we understand this better! Here is an example of a function that calculates the ridge objective. To make things interesting, let’s add the other features we talked about regarding GDP per capita and perceptions of corruption.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ridge <span class="ot">&lt;-</span> <span class="cf">function</span>(par, X, y, <span class="at">lambda =</span> <span class="dv">0</span>) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> X <span class="sc">%*%</span> par <span class="co"># %*% is matrix multiplication</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the value as sum squared error</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    error <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(y <span class="sc">-</span> mu)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the penalty</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    value <span class="ot">&lt;-</span> error <span class="sc">+</span> lambda <span class="sc">*</span> <span class="fu">crossprod</span>(par)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(value)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>our_result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> ridge,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> df_happiness <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>happiness, <span class="sc">-</span>country) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>(),</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> df_happiness<span class="sc">$</span>happiness,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fl">0.1</span>,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"BFGS"</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we use lambda_ because lambda is a reserved word in python</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ridge(par, X, y, lambda_ <span class="op">=</span> <span class="dv">0</span>):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> X <span class="op">@</span> par</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the error</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> mu)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the penalty</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> value <span class="op">+</span> lambda_ <span class="op">*</span> np.<span class="bu">sum</span>(par<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(value)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>our_result <span class="op">=</span> minimize(</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    fun  <span class="op">=</span> ridge,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    x0   <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> (</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        np.array(df_happiness.drop(columns<span class="op">=</span>[<span class="st">'happiness'</span>, <span class="st">'country'</span>])),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        np.array(df_happiness[<span class="st">'happiness'</span>]), </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.1</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We can compare this to built-in functions as we have before, and can see that the results are very similar, but not exactly the same. We would not worry about such differences in practice, but the main point is again, we can use simple functions that do just about as well as any what we’d get from package output.</p>
<div id="tbl-r-ridge" class="cell tbl-parent anchored">
<div class="cell-output-display">
<div id="kvnsncupwo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#kvnsncupwo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kvnsncupwo thead, #kvnsncupwo tbody, #kvnsncupwo tfoot, #kvnsncupwo tr, #kvnsncupwo td, #kvnsncupwo th {
  border-style: none;
}

#kvnsncupwo p {
  margin: 0;
  padding: 0;
}

#kvnsncupwo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kvnsncupwo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kvnsncupwo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kvnsncupwo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kvnsncupwo .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvnsncupwo .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvnsncupwo .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvnsncupwo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kvnsncupwo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kvnsncupwo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kvnsncupwo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kvnsncupwo .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kvnsncupwo .gt_spanner_row {
  border-bottom-style: hidden;
}

#kvnsncupwo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kvnsncupwo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kvnsncupwo .gt_from_md > :first-child {
  margin-top: 0;
}

#kvnsncupwo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kvnsncupwo .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kvnsncupwo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kvnsncupwo .gt_row_group_first td {
  border-top-width: 2px;
}

#kvnsncupwo .gt_row_group_first th {
  border-top-width: 2px;
}

#kvnsncupwo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kvnsncupwo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kvnsncupwo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvnsncupwo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kvnsncupwo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kvnsncupwo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kvnsncupwo .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#kvnsncupwo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvnsncupwo .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvnsncupwo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_left {
  text-align: left;
}

#kvnsncupwo .gt_center {
  text-align: center;
}

#kvnsncupwo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kvnsncupwo .gt_font_normal {
  font-weight: normal;
}

#kvnsncupwo .gt_font_bold {
  font-weight: bold;
}

#kvnsncupwo .gt_font_italic {
  font-style: italic;
}

#kvnsncupwo .gt_super {
  font-size: 65%;
}

#kvnsncupwo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kvnsncupwo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kvnsncupwo .gt_indent_1 {
  text-indent: 5px;
}

#kvnsncupwo .gt_indent_2 {
  text-indent: 10px;
}

#kvnsncupwo .gt_indent_3 {
  text-indent: 15px;
}

#kvnsncupwo .gt_indent_4 {
  text-indent: 20px;
}

#kvnsncupwo .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Built-in<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>">Built-in<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.44</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.44</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Life Exp. Coef.</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.49</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.52</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Corrupt</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.12</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.11</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">GDP_PC</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.42</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.44</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Showing results from R glmnet package with alpha = 0, lambda = .1</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
<p><strong>?(caption)</strong></p>
</div>
<p>CANT USE LINK WITH HASHTAG IN FIGURE CAP FOR LATEX/PDF, WILL HAVE TO USE WORKAROUND INSTEAD OF DIRECT SECTION LINK</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>It turns out that, given a a set λ penalty, ridge regression estimates need not be estimated, as there is an analytical result. See a <a href="https://m-clark.github.io/models-by-example/penalized-maximum-likelihood.htm">demo</a>.</p>
</div>
</div>
</div>
</section>
<section id="classification" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="classification"><span class="header-section-number">5.11</span> Classification</h2>
<p>So far we’ve been assuming a continuous target, but what if we have a categorical target? When we want to model categorical targets, conceptually nothing changes- we can still have an objective function that maximizes or minimizes some goal. However, we need to think about how we can do this in a way that makes sense for the target.</p>
<section id="misclassification" class="level3" data-number="5.11.1">
<h3 data-number="5.11.1" class="anchored" data-anchor-id="misclassification"><span class="header-section-number">5.11.1</span> Misclassification</h3>
<p>A straightforward correspondence to MSE is a function that minimizes classification error (or maximizes accuracy). In other words, we can think of the objective function as the proportion of incorrect classifications. This is called the <strong>misclassification rate</strong>. We can write this as:</p>
<p><span class="math display">\[
\textrm{Loss} = \frac{1}{n} \sum_{i=1}^{n} \mathbb{1}(y_i \neq \hat{y_i})
\]</span></p>
<p>Where <span class="math inline">\(y_i\)</span> is the actual value of the target for observation <span class="math inline">\(i\)</span>, arbitrarily coded as 1 or 0, and <span class="math inline">\(\hat{y_i}\)</span> is the predicted class from the model. The <span class="math inline">\(\mathbb{1}\)</span> is an indicator function that returns 1 if the condition is true, and 0 otherwise. In other words, we are counting the number of times the predicted value is not equal to the actual value, and dividing by the number of observations.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># misclassification rate</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>misclassification <span class="ot">&lt;-</span> <span class="cf">function</span>(par, X, y, <span class="at">class_threshold =</span> .<span class="dv">5</span>) {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> X <span class="sc">%*%</span> par <span class="co"># %*% is matrix multiplication</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a probability ('sigmoid' function)</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>mu))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a class</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    predicted_class <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(p <span class="sc">&gt;</span> class_threshold, <span class="st">"good"</span>, <span class="st">"bad"</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the error</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    error <span class="ot">&lt;-</span> y <span class="sc">-</span> predicted_class</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(error))</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> misclassification_rate(par, X, y, class_threshold <span class="op">=</span> <span class="fl">.5</span>):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> X <span class="op">@</span> par</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a probability ('sigmoid' function)</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>mu))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a class</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    predicted_class <span class="op">=</span> np.where(p <span class="op">&gt;</span> class_threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the error</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    error <span class="op">=</span> y <span class="op">-</span> predicted_class </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(np.mean(error))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We’ll leave it as an exercise to the reader to play around with this, as the next objective function is more commonly used.</p>
</section>
<section id="log-loss" class="level3" data-number="5.11.2">
<h3 data-number="5.11.2" class="anchored" data-anchor-id="log-loss"><span class="header-section-number">5.11.2</span> Log loss</h3>
<p>Another approach is to use the <strong>log loss</strong>, sometimes called logistic loss or cross-entropy. If we have just the binary case it is:</p>
<p><span class="math display">\[
\textrm{Loss} = -\sum_{i=1}^{n} y_i \log(\hat{y_i}) + (1 - y_i) \log(1 - \hat{y_i})
\]</span></p>
<p>Where <span class="math inline">\(y_i\)</span> is the actual value of the target for observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(\hat{y_i}\)</span> is the predicted value from the model (essentially a probability). It turns out that this is the same as log-likelihood used in a maximum likelihood approach for logistic regression. We typically prefer this objective function to classification error because it is <em>smooth</em> like in the visualization we showed before for maximum likelihood (<a href="#fig-r-likelihood-plot-3d" class="quarto-xref">Figure&nbsp;<span>5.3</span></a>), which means it is differentiable. This is important because it allows us to use optimization algorithms that rely on derivatives in updating the parameter estimates.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>objective <span class="ot">&lt;-</span> <span class="cf">function</span>(par, X, y) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values on the raw scale</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="ot">&lt;-</span> X <span class="sc">%*%</span> par</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a probability ('sigmoid' function)</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>y_hat))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># likelihood (or dbinom(y, size = 1, prob = y_hat, log = TRUE))</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    ll <span class="ot">&lt;-</span> y <span class="sc">*</span> <span class="fu">log</span>(y_hat) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> y_hat)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(<span class="sc">-</span>ll))</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> objective(par, X, y):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> X <span class="op">@</span> par</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a probability ('sigmoid' function)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>y_hat))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># likelihood</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    ll <span class="op">=</span> y <span class="op">*</span> np.log(y_hat) <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> y) <span class="op">*</span> np.log(<span class="dv">1</span> <span class="op">-</span> y_hat)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(<span class="op">-</span>np.<span class="bu">sum</span>(ll))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Let’s go ahead and demonstrate this. Let’s go back to our movie review data, just make our current target a rating of good if the rating is 3 or greater, and bad otherwise. Our features will be the review year (starting at zero) We have a binary rating in the processed version of our data. Let’s use optim to get the best parameters for a model. We’ll compare our results to the built-in <code>glm</code> function to get the same results. We can see that the results are very similar, but not exactly the same. We would not worry about such differences in practice</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_reviews_pr <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/movie_reviews_processed.csv"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>mod_logloss <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> objective,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> df_reviews_pr <span class="sc">|&gt;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(review_year_0, age_sc, word_count_sc) <span class="sc">|&gt;</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.matrix</span>(),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> df_reviews_pr<span class="sc">$</span>rating_good</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>mod_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    rating_good <span class="sc">~</span> review_year_0 <span class="sc">+</span> age_sc <span class="sc">+</span> word_count_sc,</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data   =</span> df_reviews_pr,</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>mod_logloss <span class="op">=</span> minimize(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    objective,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    x0 <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> (</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        df_reviews_pr[[<span class="st">'review_year_0'</span>, <span class="st">'age_sc'</span>, <span class="st">'word_count_sc'</span>]], </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        df_reviews_pr[<span class="st">'rating_good'</span>]</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>mod_glm <span class="op">=</span> smf.glm(</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'rating_good ~ review_year_0 + age_sc + word_count_sc'</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    data   <span class="op">=</span> df_reviews_pr,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    family <span class="op">=</span> sm.families.Binomial()</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>).fit(method <span class="op">=</span> <span class="st">'lbfgs'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We actually have to go out several decimal places before we start seeing differences between our result and the built-in function. So when it comes to classification, you should feel confident in what’s going on under the hood.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-logloss" class="anchored">
<div id="rzfnlyjscu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rzfnlyjscu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rzfnlyjscu thead, #rzfnlyjscu tbody, #rzfnlyjscu tfoot, #rzfnlyjscu tr, #rzfnlyjscu td, #rzfnlyjscu th {
  border-style: none;
}

#rzfnlyjscu p {
  margin: 0;
  padding: 0;
}

#rzfnlyjscu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rzfnlyjscu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rzfnlyjscu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rzfnlyjscu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rzfnlyjscu .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzfnlyjscu .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzfnlyjscu .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzfnlyjscu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rzfnlyjscu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rzfnlyjscu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rzfnlyjscu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rzfnlyjscu .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rzfnlyjscu .gt_spanner_row {
  border-bottom-style: hidden;
}

#rzfnlyjscu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rzfnlyjscu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rzfnlyjscu .gt_from_md > :first-child {
  margin-top: 0;
}

#rzfnlyjscu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rzfnlyjscu .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rzfnlyjscu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rzfnlyjscu .gt_row_group_first td {
  border-top-width: 2px;
}

#rzfnlyjscu .gt_row_group_first th {
  border-top-width: 2px;
}

#rzfnlyjscu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rzfnlyjscu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rzfnlyjscu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzfnlyjscu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rzfnlyjscu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rzfnlyjscu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rzfnlyjscu .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#rzfnlyjscu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzfnlyjscu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzfnlyjscu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_left {
  text-align: left;
}

#rzfnlyjscu .gt_center {
  text-align: center;
}

#rzfnlyjscu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rzfnlyjscu .gt_font_normal {
  font-weight: normal;
}

#rzfnlyjscu .gt_font_bold {
  font-weight: bold;
}

#rzfnlyjscu .gt_font_italic {
  font-style: italic;
}

#rzfnlyjscu .gt_super {
  font-size: 65%;
}

#rzfnlyjscu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rzfnlyjscu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rzfnlyjscu .gt_indent_1 {
  text-indent: 5px;
}

#rzfnlyjscu .gt_indent_2 {
  text-indent: 10px;
}

#rzfnlyjscu .gt_indent_3 {
  text-indent: 15px;
}

#rzfnlyjscu .gt_indent_4 {
  text-indent: 20px;
}

#rzfnlyjscu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption>Table&nbsp;5.2:  <p>Comparison of log loss results</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="name">name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Ours">Ours</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="GLM">GLM</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="name" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">LogLike</td>
<td headers="Ours" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">622.5935</td>
<td headers="GLM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">622.5935</td></tr>
    <tr><td headers="name" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">int</td>
<td headers="Ours" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.0819</td>
<td headers="GLM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.0818</td></tr>
    <tr><td headers="name" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">review_year_0</td>
<td headers="Ours" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.0213</td>
<td headers="GLM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.0213</td></tr>
    <tr><td headers="name" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">age_sc</td>
<td headers="Ours" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.2213</td>
<td headers="GLM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.2213</td></tr>
    <tr><td headers="name" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">word_count_sc</td>
<td headers="Ours" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.7344</td>
<td headers="GLM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.7343</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="optimization-algorithms" class="level2" data-number="5.12">
<h2 data-number="5.12" class="anchored" data-anchor-id="optimization-algorithms"><span class="header-section-number">5.12</span> Optimization Algorithms</h2>
<section id="gradient-descent" class="level3" data-number="5.12.1">
<h3 data-number="5.12.1" class="anchored" data-anchor-id="gradient-descent"><span class="header-section-number">5.12.1</span> Gradient Descent</h3>
<p>One of the most common approaches in optimization is called <strong>gradient descent</strong>. The idea behind it is that we can use the gradient of the objective function to guide us to the best fitting parameters. Conceptually, this works in the exact same way as described with other estimation approaches like maximum likelihood - gradient descent is just a way to find that path along the objective surface. More formally, the gradient is the vector of partial derivatives of the objective function with respect to each parameter. That may not mean much to you, but the basic idea is that the gradient is a vector that points in the direction of steepest ascent in terms of the objective function. So if we want to maximize the objective function, we can take a step in the direction of the gradient, and if we want to minimize it, we can take a step in the opposite direction of the gradient. The size of the step is called the learning rate, and, like our penalty parameter we saw with penalized regression, it is a hyperparameter that we can tune. If the learning rate is too small, it will take a longer time to converge. If the learning rate is too large, we might overshoot the objective and never converge. There are a number of variations on gradient descent that have been developed over time. Here is a function to illustrate the process. Let’s see this in action with the happiness data model we used previously.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>gradient_descent <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    par,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-3</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">1000</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> <span class="fl">1e-3</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">adapt =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotLoss =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> par</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(beta) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(X)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    mse <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(X <span class="sc">%*%</span> beta <span class="sc">-</span> y) <span class="sc">/</span> N</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    tol <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    iter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (tol <span class="sc">&gt;</span> tolerance <span class="sc">&amp;&amp;</span> iter <span class="sc">&lt;</span> maxit) {</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        LP <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>        grad <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> (LP <span class="sc">-</span> y)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>        betaCurrent <span class="ot">&lt;-</span> beta <span class="sc">-</span> learning_rate <span class="sc">*</span> grad</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        tol <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(betaCurrent <span class="sc">-</span> beta))</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        beta <span class="ot">&lt;-</span> betaCurrent</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>        mse <span class="ot">&lt;-</span> <span class="fu">append</span>(mse, <span class="fu">crossprod</span>(LP <span class="sc">-</span> y) <span class="sc">/</span> N)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>        iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (adapt) {</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>            stepsize <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>                mse[iter] <span class="sc">&lt;</span> mse[iter <span class="sc">-</span> <span class="dv">1</span>],</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>                stepsize <span class="sc">*</span> <span class="fl">1.2</span>,</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>                stepsize <span class="sc">*</span> .<span class="dv">8</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (verbose <span class="sc">&amp;&amp;</span> iter <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>            <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"Iteration:"</span>, iter))</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (plotLoss) {</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> <span class="fu">tibble</span>(mse) <span class="sc">|&gt;</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ggplot</span>(<span class="fu">aes</span>(iter, mse)) <span class="sc">+</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">round_any</span>(<span class="fu">max</span>(mse), <span class="dv">10</span>), <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Iteration"</span>, <span class="at">y =</span> <span class="st">"MSE"</span>)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(p)</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">par    =</span> beta,</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">loss   =</span> mse,</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">MSE    =</span> <span class="fu">crossprod</span>(LP <span class="sc">-</span> y) <span class="sc">/</span> <span class="fu">nrow</span>(X),</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">iter   =</span> iter,</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">fitted =</span> LP</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>our_result <span class="ot">&lt;-</span> <span class="fu">gradient_descent</span>(</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> df_happiness <span class="sc">|&gt;</span> <span class="fu">select</span>(life_exp, gdp_pc, corrupt) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>(),</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> df_happiness<span class="sc">$</span>happiness,</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> <span class="fl">1e-3</span>,</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">FALSE</span> <span class="co"># shown later</span></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gradient_descent(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    par, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    X, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    y, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    tolerance <span class="op">=</span> <span class="fl">1e-3</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    maxit <span class="op">=</span> <span class="dv">1000</span>, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> <span class="fl">1e-3</span>, </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    adapt <span class="op">=</span> <span class="va">False</span>, </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    verbose <span class="op">=</span> <span class="va">True</span>, </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    plotLoss <span class="op">=</span> <span class="va">True</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> par</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> np.<span class="bu">sum</span>((X <span class="op">@</span> beta <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    tol <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">iter</span> <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (tol <span class="op">&gt;</span> tolerance <span class="kw">and</span> <span class="bu">iter</span> <span class="op">&lt;</span> maxit):</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        LP <span class="op">=</span> X <span class="op">@</span> beta</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        grad <span class="op">=</span> X.T <span class="op">@</span> (LP <span class="op">-</span> y)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        betaCurrent <span class="op">=</span> beta <span class="op">-</span> learning_rate <span class="op">*</span> grad</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>        tol <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(betaCurrent <span class="op">-</span> beta))</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>        beta <span class="op">=</span> betaCurrent</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> np.append(loss, np.<span class="bu">sum</span>((LP <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">iter</span> <span class="op">=</span> <span class="bu">iter</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (adapt):</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>            stepsize <span class="op">=</span> np.where(loss[<span class="bu">iter</span>] <span class="op">&lt;</span> loss[<span class="bu">iter</span> <span class="op">-</span> <span class="dv">1</span>], stepsize <span class="op">*</span> <span class="fl">1.2</span>, stepsize <span class="op">*</span> <span class="fl">.8</span>)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (verbose <span class="kw">and</span> <span class="bu">iter</span> <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>):</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Iteration:"</span>, <span class="bu">iter</span>)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (plotLoss):</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>        plt.plot(loss)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>({</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">"par"</span>: beta,</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">"loss"</span>: loss,</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"RSE"</span>: np.sqrt(np.<span class="bu">sum</span>((LP <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> (X.shape[<span class="dv">0</span>] <span class="op">-</span> X.shape[<span class="dv">1</span>])),</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">"iter"</span>: <span class="bu">iter</span>,</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">"fitted"</span>: LP</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>our_result <span class="op">=</span> gradient_descent(</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>    par <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> df_happiness[[<span class="st">'life_exp'</span>, <span class="st">'gdp_pc'</span>, <span class="st">'corrupt'</span>]].to_numpy(),</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>].to_numpy(),</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> <span class="fl">1e-3</span>,</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>    verbose  <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>    plotLoss <span class="op">=</span> <span class="va">False</span> <span class="co"># will show below</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Comparing our results, we have the following table. Again, we see that the results are very similar.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-gradient-descent" class="anchored">
<div id="xhflgeqohp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#xhflgeqohp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xhflgeqohp thead, #xhflgeqohp tbody, #xhflgeqohp tfoot, #xhflgeqohp tr, #xhflgeqohp td, #xhflgeqohp th {
  border-style: none;
}

#xhflgeqohp p {
  margin: 0;
  padding: 0;
}

#xhflgeqohp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xhflgeqohp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xhflgeqohp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xhflgeqohp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xhflgeqohp .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xhflgeqohp .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xhflgeqohp .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xhflgeqohp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xhflgeqohp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xhflgeqohp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xhflgeqohp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xhflgeqohp .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xhflgeqohp .gt_spanner_row {
  border-bottom-style: hidden;
}

#xhflgeqohp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xhflgeqohp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xhflgeqohp .gt_from_md > :first-child {
  margin-top: 0;
}

#xhflgeqohp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xhflgeqohp .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xhflgeqohp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xhflgeqohp .gt_row_group_first td {
  border-top-width: 2px;
}

#xhflgeqohp .gt_row_group_first th {
  border-top-width: 2px;
}

#xhflgeqohp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xhflgeqohp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xhflgeqohp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xhflgeqohp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xhflgeqohp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xhflgeqohp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xhflgeqohp .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#xhflgeqohp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xhflgeqohp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xhflgeqohp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_left {
  text-align: left;
}

#xhflgeqohp .gt_center {
  text-align: center;
}

#xhflgeqohp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xhflgeqohp .gt_font_normal {
  font-weight: normal;
}

#xhflgeqohp .gt_font_bold {
  font-weight: bold;
}

#xhflgeqohp .gt_font_italic {
  font-style: italic;
}

#xhflgeqohp .gt_super {
  font-size: 65%;
}

#xhflgeqohp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xhflgeqohp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xhflgeqohp .gt_indent_1 {
  text-indent: 5px;
}

#xhflgeqohp .gt_indent_2 {
  text-indent: 10px;
}

#xhflgeqohp .gt_indent_3 {
  text-indent: 15px;
}

#xhflgeqohp .gt_indent_4 {
  text-indent: 20px;
}

#xhflgeqohp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption>Table&nbsp;5.3:  <p>Comparison of gradient descent results</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Value">Value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Built-in">Built-in</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.437</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Life Exp. Coef.</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.521</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">GDP_PC</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.438</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.439</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Corrupt</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.107</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">MSE</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>In addition, when we visualize the loss function across iterations, we see smooth decline in the MSE value as we go along.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-gradient-descent" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="estimation_files/figure-html/fig-r-gradient-descent-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5.5: Gradient descent path</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="stochastic-gradient-descent" class="level3" data-number="5.12.2">
<h3 data-number="5.12.2" class="anchored" data-anchor-id="stochastic-gradient-descent"><span class="header-section-number">5.12.2</span> Stochastic Gradient Descent</h3>
<p><strong>Stochastic gradient descent</strong> is a variation on gradient descent that uses a random sample of the data to estimate the gradient, while the true gradient is the gradient of the objective function with respect to all of the data. As such, the stochastic gradient descent is less accurate than gradient descent. The advantage of stochastic gradient descent is that it is faster than gradient descent. In practice, stochastic gradient descent is often used in machine learning applications where the data is large, and the tradeoff between accuracy and speed is worth it.</p>
<p>Let’s see this in action with the happiness data model we used previously. The following is a conceptual version of the AdaGrad approach<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>, which is a variation of stochastic gradient descent that adjusts the learning rate for each parameter. We will also add a variation that averages the parameter estimates across iterations, which is a common approach to improve the performance of stochastic gradient descent, but by default it is not used, just something you can play with. We are going to use a ‘batch size’ of one, which is similar to a ‘streaming’ or ‘online’ version where we update the model with each observation. Since our data are alphabetically ordered, we’ll shuffle the data first. We’ll also use a stepsize_tau parameter, which is a way to adjust the learning rate at early iterations. We’ll set it to zero for now, but you can play with it to see how it affects the results. The values for the learning rate and stepsize_tau are arbitrary, selected after some initial playing around, but you can play with them to see how they affect the results.</p>
<p>NOTE: SHOULD MAYBE CLEAN UP/ALTER TO LESS VERBOSE VERSION</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>stochastic_gradient_descent <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    par, <span class="co"># parameter estimates</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    X, <span class="co"># model matrix</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    y, <span class="co"># target variable</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> <span class="dv">1</span>, <span class="co"># the learning rate</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">stepsize_tau =</span> <span class="dv">0</span>, <span class="co"># if &gt; 0, a check on the LR at early iterations</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">average =</span> <span class="cn">FALSE</span> <span class="co"># a variation of the approach</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    ) {</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> par</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect all estimates</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    betamat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(X), <span class="at">ncol =</span> <span class="fu">length</span>(beta))</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect fitted values at each point))</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    fits <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect loss at each point</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    loss <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adagrad per parameter learning rate adjustment</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a smoothing term to avoid division by zero</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    eps <span class="ot">&lt;-</span> <span class="fl">1e-8</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)) {</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>        Xi <span class="ot">&lt;-</span> X[i, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>        yi <span class="ot">&lt;-</span> y[i]</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># matrix operations not necessary here,</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># but makes consistent with standard gd func</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>        LP <span class="ot">&lt;-</span> Xi <span class="sc">%*%</span> beta</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>        grad <span class="ot">&lt;-</span> <span class="fu">t</span>(Xi) <span class="sc">%*%</span> (LP <span class="sc">-</span> yi)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> s <span class="sc">+</span> grad<span class="sc">^</span><span class="dv">2</span> <span class="co"># adagrad approach</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># update</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>        beta <span class="ot">&lt;-</span> beta <span class="sc">-</span> learning_rate <span class="sc">/</span> (stepsize_tau <span class="sc">+</span> <span class="fu">sqrt</span>(s <span class="sc">+</span> eps)) <span class="sc">*</span> grad</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># a variation</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (average <span class="sc">&amp;</span> i <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>            beta <span class="ot">&lt;-</span> beta <span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span> i <span class="sc">*</span> (betamat[i <span class="sc">-</span> <span class="dv">1</span>, ] <span class="sc">-</span> beta)</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>        betamat[i, ] <span class="ot">&lt;-</span> beta</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>        fits[i] <span class="ot">&lt;-</span> LP</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>        loss[i] <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(LP <span class="sc">-</span> yi)</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>    LP <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    lastloss <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(LP <span class="sc">-</span> y)</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">par =</span> beta, <span class="co"># final estimates</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">par_chain =</span> betamat, <span class="co"># estimates at each iteration</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">MSE =</span> <span class="fu">sum</span>(lastloss) <span class="sc">/</span> <span class="fu">nrow</span>(X),</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">fitted =</span> LP</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a><span class="co"># setting a seed ensures replicability</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a><span class="co"># generate random sample indices (could also have done within the function)</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df_happiness), <span class="fu">nrow</span>(df_happiness))</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">=</span> df_happiness <span class="sc">|&gt;</span></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(life_exp, gdp_pc, corrupt) <span class="sc">|&gt;</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice</span>(idx) <span class="sc">|&gt;</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">&lt;-</span> df_happiness<span class="sc">$</span>happiness[idx]</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>our_result <span class="ot">&lt;-</span> <span class="fu">stochastic_gradient_descent</span>(</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="fu">mean</span>(df_happiness<span class="sc">$</span>happiness), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> X_train,</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> y_train,</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> .<span class="dv">15</span>,</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">stepsize_tau =</span> .<span class="dv">1</span></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stochastic_gradient_descent(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    par, <span class="co"># parameter estimates</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    X, <span class="co"># model matrix</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    y, <span class="co"># target variable</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> <span class="dv">1</span>, <span class="co"># the learning rate</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    stepsize_tau <span class="op">=</span> <span class="dv">0</span>, <span class="co"># if &gt; 0, a check on the LR at early iterations</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    average <span class="op">=</span> <span class="va">False</span> <span class="co"># a variation of the approach</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> par</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect all estimates</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    betamat <span class="op">=</span> np.zeros((X.shape[<span class="dv">0</span>], beta.shape[<span class="dv">0</span>]))</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect fitted values at each point))</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    fits <span class="op">=</span> np.zeros(X.shape[<span class="dv">0</span>])</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect loss at each point</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> np.zeros(X.shape[<span class="dv">0</span>])</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adagrad per parameter learning rate adjustment</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a smoothing term to avoid division by zero</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    eps <span class="op">=</span> <span class="fl">1e-8</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">0</span>]):</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        Xi <span class="op">=</span> X[<span class="va">None</span>, i, :]</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>        yi <span class="op">=</span> y[i]</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># matrix operations not necessary here,</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># but makes consistent with standard gd func</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>        LP <span class="op">=</span> Xi <span class="op">@</span> beta</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>        grad <span class="op">=</span> Xi.T <span class="op">@</span> (LP <span class="op">-</span> yi)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s <span class="op">+</span> grad<span class="op">**</span><span class="dv">2</span> <span class="co"># adagrad approach</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># update</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>        beta <span class="op">=</span> beta <span class="op">-</span> learning_rate <span class="op">/</span> (stepsize_tau <span class="op">+</span> np.sqrt(s <span class="op">+</span> eps)) <span class="op">*</span> grad</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># a variation</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (average <span class="op">&amp;</span> i <span class="op">&gt;</span> <span class="dv">1</span>):</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>            beta <span class="op">=</span> beta <span class="op">-</span> <span class="dv">1</span> <span class="op">/</span> i <span class="op">*</span> (betamat[i <span class="op">-</span> <span class="dv">1</span>, :] <span class="op">-</span> beta)</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>        betamat[i, :] <span class="op">=</span> beta</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>        fits[i] <span class="op">=</span> LP</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>        loss[i] <span class="op">=</span> np.<span class="bu">sum</span>((LP <span class="op">-</span> yi)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>    LP <span class="op">=</span> X <span class="op">@</span> beta</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    lastloss <span class="op">=</span> np.<span class="bu">sum</span>((LP <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>({</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">"par"</span>: beta, <span class="co"># final estimates</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>        <span class="st">"par_chain"</span>: betamat, <span class="co"># estimates at each iteration</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"MSE"</span>: lastloss <span class="op">/</span> X.shape[<span class="dv">0</span>],</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"fitted"</span>: LP</span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a><span class="co"># setting a seed ensures replicability</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1234</span>)</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a><span class="co"># generate random sample indices (could also have done within the function)</span></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> np.random.choice(df_happiness.shape[<span class="dv">0</span>], df_happiness.shape[<span class="dv">0</span>], replace <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> df_happiness[[<span class="st">'life_exp'</span>, <span class="st">'gdp_pc'</span>, <span class="st">'corrupt'</span>]].to_numpy()[idx, :]</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>].to_numpy()[idx]</span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>our_result <span class="op">=</span> stochastic_gradient_descent(</span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>    par <span class="op">=</span> np.array([np.mean(df_happiness[<span class="st">'happiness'</span>]), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X_train,</span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> y_train,</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> <span class="fl">.15</span>,</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>    stepsize_tau <span class="op">=</span> <span class="fl">.1</span></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Next we’ll compare it to OLS estimates. Very similar even though SGD normally would not be used for such a small dataset.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-stochastic-gradient-descent" class="anchored">
<div id="owzfngjefp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#owzfngjefp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#owzfngjefp thead, #owzfngjefp tbody, #owzfngjefp tfoot, #owzfngjefp tr, #owzfngjefp td, #owzfngjefp th {
  border-style: none;
}

#owzfngjefp p {
  margin: 0;
  padding: 0;
}

#owzfngjefp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#owzfngjefp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#owzfngjefp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#owzfngjefp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#owzfngjefp .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#owzfngjefp .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#owzfngjefp .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#owzfngjefp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#owzfngjefp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#owzfngjefp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#owzfngjefp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#owzfngjefp .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#owzfngjefp .gt_spanner_row {
  border-bottom-style: hidden;
}

#owzfngjefp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#owzfngjefp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#owzfngjefp .gt_from_md > :first-child {
  margin-top: 0;
}

#owzfngjefp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#owzfngjefp .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#owzfngjefp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#owzfngjefp .gt_row_group_first td {
  border-top-width: 2px;
}

#owzfngjefp .gt_row_group_first th {
  border-top-width: 2px;
}

#owzfngjefp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#owzfngjefp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#owzfngjefp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#owzfngjefp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#owzfngjefp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#owzfngjefp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#owzfngjefp .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#owzfngjefp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#owzfngjefp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#owzfngjefp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_left {
  text-align: left;
}

#owzfngjefp .gt_center {
  text-align: center;
}

#owzfngjefp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#owzfngjefp .gt_font_normal {
  font-weight: normal;
}

#owzfngjefp .gt_font_bold {
  font-weight: bold;
}

#owzfngjefp .gt_font_italic {
  font-style: italic;
}

#owzfngjefp .gt_super {
  font-size: 65%;
}

#owzfngjefp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#owzfngjefp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#owzfngjefp .gt_indent_1 {
  text-indent: 5px;
}

#owzfngjefp .gt_indent_2 {
  text-indent: 10px;
}

#owzfngjefp .gt_indent_3 {
  text-indent: 15px;
}

#owzfngjefp .gt_indent_4 {
  text-indent: 20px;
}

#owzfngjefp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption>Table&nbsp;5.4:  <p>Comparison of stochastic gradient descent results</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Value">Value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Built-in">Built-in</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.44</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.47</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Life Exp. Coef.</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.52</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.51</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">GDP_PC</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.44</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.39</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Corrupt</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.11</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.11</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">MSE</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.37</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.37</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<p>And here’s a plot of the estimates as they moved along the data. For this plot we don’t include the intercept as it’s on a notably different scale. We can see that the estimates are moving around a bit, but they appear to be converging to a solution.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-stochastic-gradient-descent" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="estimation_files/figure-html/fig-r-stochastic-gradient-descent-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5.6: Stochastic gradient descent path</figcaption>
</figure>
</div>
</div>
</div>
<!-- ![Stochastic gradient descent path](img/sgd.gif) -->
</section>
<section id="other-optimization-algorithms" class="level3" data-number="5.12.3">
<h3 data-number="5.12.3" class="anchored" data-anchor-id="other-optimization-algorithms"><span class="header-section-number">5.12.3</span> Other Optimization Algorithms</h3>
<p>There are lots of other approaches to optimization. For example, here are some of the options available in R’s <code>optim</code> or scipy’s <code>minimize</code> function:</p>
<ul>
<li>Nelder-Mead</li>
<li>BFGS</li>
<li>L-BFGS-B (provides constraints)</li>
<li>Conjugate gradient</li>
<li>Simulated annealing</li>
<li>Newton’s method</li>
<li>Genetic algorithms</li>
</ul>
<p>The main reason to choose one method over another usually is some sort of computational gain, e.g.&nbsp;memory or speed, or it may just work better for some types of models in practice. For statistical problems, many GLM-type functions appear to use Newton’s as a default, but more complicated models may implement other means, and even then might best be served by a different approach. In general, we can always try a few different methods to see which works best, and often there would be little differences in the results. For example, here are the results from the happiness data using the BFGS method, which is a quasi-Newton method. Here is our resuls from using OLS, compared to different algorithms, some we used some we didn’t. We can see that the results are very similar, and for simpler modeling endeavors they should converge on the same result.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-optim-compare" class="anchored">
<div id="xuwkdlnsyg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#xuwkdlnsyg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xuwkdlnsyg thead, #xuwkdlnsyg tbody, #xuwkdlnsyg tfoot, #xuwkdlnsyg tr, #xuwkdlnsyg td, #xuwkdlnsyg th {
  border-style: none;
}

#xuwkdlnsyg p {
  margin: 0;
  padding: 0;
}

#xuwkdlnsyg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xuwkdlnsyg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xuwkdlnsyg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xuwkdlnsyg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xuwkdlnsyg .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xuwkdlnsyg .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xuwkdlnsyg .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xuwkdlnsyg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xuwkdlnsyg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xuwkdlnsyg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xuwkdlnsyg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xuwkdlnsyg .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xuwkdlnsyg .gt_spanner_row {
  border-bottom-style: hidden;
}

#xuwkdlnsyg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xuwkdlnsyg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xuwkdlnsyg .gt_from_md > :first-child {
  margin-top: 0;
}

#xuwkdlnsyg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xuwkdlnsyg .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xuwkdlnsyg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xuwkdlnsyg .gt_row_group_first td {
  border-top-width: 2px;
}

#xuwkdlnsyg .gt_row_group_first th {
  border-top-width: 2px;
}

#xuwkdlnsyg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xuwkdlnsyg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xuwkdlnsyg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xuwkdlnsyg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xuwkdlnsyg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xuwkdlnsyg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xuwkdlnsyg .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#xuwkdlnsyg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xuwkdlnsyg .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xuwkdlnsyg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_left {
  text-align: left;
}

#xuwkdlnsyg .gt_center {
  text-align: center;
}

#xuwkdlnsyg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xuwkdlnsyg .gt_font_normal {
  font-weight: normal;
}

#xuwkdlnsyg .gt_font_bold {
  font-weight: bold;
}

#xuwkdlnsyg .gt_font_italic {
  font-style: italic;
}

#xuwkdlnsyg .gt_super {
  font-size: 65%;
}

#xuwkdlnsyg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xuwkdlnsyg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xuwkdlnsyg .gt_indent_1 {
  text-indent: 5px;
}

#xuwkdlnsyg .gt_indent_2 {
  text-indent: 10px;
}

#xuwkdlnsyg .gt_indent_3 {
  text-indent: 15px;
}

#xuwkdlnsyg .gt_indent_4 {
  text-indent: 20px;
}

#xuwkdlnsyg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption>Table&nbsp;5.5:  <p>Comparison of optimization results</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="parameter">parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="NM<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>">NM<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="BFGS<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>">BFGS<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="CG<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>3</sup></span>">CG<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="GD<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>4</sup></span>">GD<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>4</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Built-in">Built-in</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.437</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Life Exp. Coef.</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.521</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">GDP_PC</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.437</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.438</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.438</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.439</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.438</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Corrupt</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.107</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">MSE</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="Built-in" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> NM = Nelder-Mead</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> BFGS = Broyden–Fletcher–Goldfarb–Shanno</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>3</sup></span> CG = Conjugate gradient</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>4</sup></span> GD = Gradient descent</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="other-estimation-approaches" class="level2" data-number="5.13">
<h2 data-number="5.13" class="anchored" data-anchor-id="other-estimation-approaches"><span class="header-section-number">5.13</span> Other Estimation Approaches</h2>
<p>Before leaving our estimation discussion, we should mention that there are many other approaches to estimation that are out there. These include variaions on least squares, <strong>method of moments</strong>, <strong>generalized estimating equations</strong>, <strong>robust</strong> estimation, and more. The above that we’ve focused on will generally be sufficient for most applications, but it’s good to be aware of others. But there are two we want to discuss in a little bit detail before we leave model estimation formally given their widespread usage, and that is the <strong>bootstrap</strong> and <strong>Bayesian estimation</strong>.</p>
<section id="bootstrap" class="level3" data-number="5.13.1">
<h3 data-number="5.13.1" class="anchored" data-anchor-id="bootstrap"><span class="header-section-number">5.13.1</span> Bootstrap</h3>
<p>The bootstrap is a resampling approach to estimation. We <strong>sample with replacement</strong> from the data, generating an entirely new data set of the same size, and then estimate the model. We repeat this process many times, collecting parameter estimates, predictions, or any thing we want to calculate along the way. Ultimately we end up with a distribution of possible parameter estimates.</p>
<p>This distribution is useful for inference, as we can use the distribution to calculate confidence intervals, prediction intervals or intervals for anything we happen to calculate. The average estimate will typically be the same as whatever the underlying model used would produced, but the bootstrap provides a way to get at a measure of uncertainty with fewer assumptions about how that distribution should take sahape. The bootstrap is very flexible, and it can be used with any estimation approach. Here is a function to illustrate the process. Let’s see this in action with the happiness data model we used previously.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>bootstrap <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, <span class="at">nboot =</span> <span class="dv">100</span>, <span class="at">seed =</span> <span class="dv">123</span>) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, (<span class="dv">1</span><span class="sc">+</span><span class="fu">ncol</span>(X))<span class="sc">*</span>nboot, <span class="at">nrow =</span> nboot, <span class="at">ncol =</span> <span class="dv">1</span><span class="sc">+</span><span class="fu">ncol</span>(X))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(beta) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Intercept'</span>, <span class="fu">colnames</span>(X))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    mse <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nboot)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set seed</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nboot) {</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample with replacement</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, N, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        Xi <span class="ot">&lt;-</span> X <span class="sc">|&gt;</span> <span class="fu">slice</span>(idx)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        yi <span class="ot">&lt;-</span> y[idx]</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># estimate model</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(yi <span class="sc">~</span>., <span class="at">data =</span> Xi)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># save results</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>        beta[i, ] <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>        mse[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>((mod<span class="sc">$</span>fitted <span class="sc">-</span> yi)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> N</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># given mean estimates, calculate MSE</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fu">as.matrix</span>(X)) <span class="sc">%*%</span> <span class="fu">colMeans</span>(beta)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    final_mse <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> y_hat)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> N</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">beta =</span> <span class="fu">as_tibble</span>(beta),</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">MSE =</span> mse,</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">final_mse =</span> final_mse</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>our_result <span class="ot">&lt;-</span> <span class="fu">bootstrap</span>(</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> df_happiness <span class="sc">|&gt;</span> <span class="fu">select</span>(life_exp, gdp_pc, corrupt),</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> df_happiness<span class="sc">$</span>happiness,</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">nboot =</span> <span class="dv">250</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bootstrap(X, y, nboot<span class="op">=</span><span class="dv">100</span>, seed<span class="op">=</span><span class="dv">123</span>):</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    cn <span class="op">=</span> X.columns</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> X.shape[<span class="dv">0</span>]</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> np.empty((nboot, X.shape[<span class="dv">1</span>]))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># beta = pd.DataFrame(beta, columns=['Intercept'] + list(cn))</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    mse <span class="op">=</span> np.empty(nboot)    </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set seed</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    np.random.seed(seed)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nboot):</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample with replacement</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        idx <span class="op">=</span> np.random.randint(<span class="dv">0</span>, N, N)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        Xi <span class="op">=</span> X[idx, :]</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        yi <span class="op">=</span> y[idx]</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># estimate model</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> LinearRegression(fit_intercept<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>        mod <span class="op">=</span> model.fit(Xi, yi)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># save results</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>        beta[i, :] <span class="op">=</span> mod.coef_</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>        mse[i] <span class="op">=</span> np.<span class="bu">sum</span>((mod.predict(Xi) <span class="op">-</span> yi)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> N</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># given mean estimates, calculate MSE</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> X <span class="op">@</span> beta.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    final_mse <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> N</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">dict</span>(beta <span class="op">=</span> beta, mse <span class="op">=</span> mse, final_mse <span class="op">=</span> final_mse)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>our_result <span class="op">=</span> bootstrap(</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> df_happiness[[<span class="st">'life_exp'</span>, <span class="st">'gdp_pc'</span>, <span class="st">'corrupt'</span>]],</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>],</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    nboot <span class="op">=</span> <span class="dv">250</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Here are the results of the interval estimates for the coefficients. For each parameter, we have the mean estimate, the lower and upper bounds of the 95% confidence interval, and the width of the interval. We can see that the bootstrap intervals are wider than the OLS intervals, possibly better capturing the uncertainty in this model based on not too many observations.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-bootstrap" class="anchored">
<div id="lcrnnhtewt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#lcrnnhtewt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lcrnnhtewt thead, #lcrnnhtewt tbody, #lcrnnhtewt tfoot, #lcrnnhtewt tr, #lcrnnhtewt td, #lcrnnhtewt th {
  border-style: none;
}

#lcrnnhtewt p {
  margin: 0;
  padding: 0;
}

#lcrnnhtewt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lcrnnhtewt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lcrnnhtewt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lcrnnhtewt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lcrnnhtewt .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lcrnnhtewt .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcrnnhtewt .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lcrnnhtewt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lcrnnhtewt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lcrnnhtewt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lcrnnhtewt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lcrnnhtewt .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lcrnnhtewt .gt_spanner_row {
  border-bottom-style: hidden;
}

#lcrnnhtewt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lcrnnhtewt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lcrnnhtewt .gt_from_md > :first-child {
  margin-top: 0;
}

#lcrnnhtewt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lcrnnhtewt .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lcrnnhtewt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrnnhtewt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lcrnnhtewt .gt_row_group_first td {
  border-top-width: 2px;
}

#lcrnnhtewt .gt_row_group_first th {
  border-top-width: 2px;
}

#lcrnnhtewt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrnnhtewt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lcrnnhtewt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lcrnnhtewt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lcrnnhtewt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrnnhtewt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lcrnnhtewt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lcrnnhtewt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lcrnnhtewt .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#lcrnnhtewt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lcrnnhtewt .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrnnhtewt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lcrnnhtewt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lcrnnhtewt .gt_left {
  text-align: left;
}

#lcrnnhtewt .gt_center {
  text-align: center;
}

#lcrnnhtewt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lcrnnhtewt .gt_font_normal {
  font-weight: normal;
}

#lcrnnhtewt .gt_font_bold {
  font-weight: bold;
}

#lcrnnhtewt .gt_font_italic {
  font-style: italic;
}

#lcrnnhtewt .gt_super {
  font-size: 65%;
}

#lcrnnhtewt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lcrnnhtewt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lcrnnhtewt .gt_indent_1 {
  text-indent: 5px;
}

#lcrnnhtewt .gt_indent_2 {
  text-indent: 10px;
}

#lcrnnhtewt .gt_indent_3 {
  text-indent: 15px;
}

#lcrnnhtewt .gt_indent_4 {
  text-indent: 20px;
}

#lcrnnhtewt .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption>Table&nbsp;5.6:  <p>Bootstrap parameter estimates</p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="mean">mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="lower">lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="upper">upper</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Lower OLS">Lower OLS</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Upper OLS">Upper OLS</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Diff Width<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>">Diff Width<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="mean" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.44</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.33</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.55</td>
<td headers="Lower OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.33</td>
<td headers="Upper OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.56</td>
<td headers="Diff Width" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.23</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">life_exp</td>
<td headers="mean" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.51</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.30</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.70</td>
<td headers="Lower OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.35</td>
<td headers="Upper OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.70</td>
<td headers="Diff Width" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.35</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">gdp_pc</td>
<td headers="mean" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.46</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.18</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.76</td>
<td headers="Lower OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.24</td>
<td headers="Upper OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.64</td>
<td headers="Diff Width" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.40</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">corrupt</td>
<td headers="mean" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.10</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.29</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.09</td>
<td headers="Lower OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.25</td>
<td headers="Upper OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.04</td>
<td headers="Diff Width" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.28</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="7"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Width of bootstrap estimate minus width of OLS estimate</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<p>Let’s look at the bootstrap distributions for each coefficient. With standard statistical estimates, we are assuming a distribution like the normal, which is a very specific shape. With the bootstrap, we can be more flexible, thought often it may tend toward the distribution that would otherwise be assumed. These aren’t perfectly symmetrical, but they suit our needs in that we can extract the lower and upper quantiles to create an interval estimate.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-bootstrap" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="estimation_files/figure-html/fig-r-bootstrap-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5.7: Bootstrap distributions of parameter estimates</figcaption>
</figure>
</div>
</div>
</div>
<p>The bootstrap is a commonly used for predictions and other metrics, but it is computationally inefficient, and can become prohibitive with large data sizes. Also, the simple bootstrap will likely not estimate the appropriate uncertainty for some types of statistics (e.g.&nbsp;extreme values) or <a href="https://stats.stackexchange.com/questions/9664/what-are-examples-where-a-naive-bootstrap-fails">in some data contexts</a> (e.g.&nbsp;correlated observations). Overcoming the limitations may typically require an even more computationally intensive approach, further limiting its utility. But it is a useful tool to have in your toolbox, and it can be used in conjunction with other approaches to get at uncertainty in a model.</p>
</section>
<section id="bayesian-estimation" class="level3" data-number="5.13.2">
<h3 data-number="5.13.2" class="anchored" data-anchor-id="bayesian-estimation"><span class="header-section-number">5.13.2</span> Bayesian Estimation</h3>
<p>The bayesian approach to modeling is a philosophical view point, an entirely different way to think about probability, a different way to measure uncertainty, and on a practical level, just another way to get model parameter estimates. It can be as frustrating as it is fun to use, and one of the really nice things about using bayesian estimation is that it can handle model complexities that other approaches don’t do well.</p>
<p>The basis of bayesian estimation is the <strong>likelihood</strong>, same as with maximum likelihood, and everything we did there follows to here. However, here we can incorporate domain knowledge, in the form of <strong>prior distributions</strong> about the parameters, which we specify in addition to the likelihood. For example, we may say that the coefficients for a linear model come from a normal distribution centered on zero with some variance. The combination prior distributions with the likelihood ultimately results in the <strong>posterior distribution</strong>. And this is the key difference when comparing bayesian estimation to the others we’ve talked about, and something it shares in common with the bootstrap- the end result is not a point estimate of the parameters, but rather a <em>distribution</em> of possible parameter values.</p>
<p><img src="img/prior2post_clean.png" class="img-fluid"></p>
<p>Dealing with distributions instead of single estimates is a different way to think about modeling, but it can be very useful. For example, as we did with the bootstrap, the bayesian posterior distribution is useful for inference. With these distributions, we can look at any range in between for our <strong>credible interval</strong>, which is the bayesian equivalent of a confidence interval<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>. Here is an example of the posterior distribution for the parameters of our happiness model, along with 95% intervals.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-bayesian-posterior" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="estimation_files/figure-html/fig-r-bayesian-posterior-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5.8: Posterior distribution of parameters</figcaption>
</figure>
</div>
</div>
</div>
<p>With bayesian modeling, we use the bayesian algorithm of our choosing, give it starting values and proceed much in the same way as other optimization procedures. In the bayesian approach, we always specify a number of iterations as the <strong>stopping rule</strong>, i.e.&nbsp;when the model should terminate. These iterations are single draws from the posterior distribution for each parameter. So if we specified 1000 iterations, we would have 1000 draws from the posterior distribution for each parameter. Typically we don’t use the first few hundred draws, as these are considered <strong>burn-in</strong> or <strong>warmup</strong> draws, and we use the remaining draws for inference. The number of burn-in draws is a bit of an art, but it’s not too important as long as it’s not too small. The more iterations we set, the longer it will take to run. We also specify multiple <strong>chains</strong>, which are each doing the exact same thing, but do to the random nature of the bayesian approach, would take different estimation paths. We can then compare the chains to see if they are converging to the same result, which is a check on the model. If they are not converging, we may need to run the model longer, or we may need to change something else. Here is an example of the chains for our happiness model for the life expectancy coefficient. We can see that they are converging to the same result, so we are good to go. Nowadays we have statistics that allow us to check whether the chains are converging, making it easier to assess many parameters quickly.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-bayesian-chains" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="estimation_files/figure-html/fig-r-bayesian-chains-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5.9: Bayesian chains for life expectancy coefficient</figcaption>
</figure>
</div>
</div>
</div>
<p>When we are interested in making predictions, we can use the results to generate a distribution of possible predictions <em>for each observation</em>, which can be very useful when we want to quantify uncertainty in for complex models. This is referred to as <strong>posterior predictive distribution</strong>. Here is a plot of several draws of predicted values against the true happiness scores.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-bayesian-posterior-predictive" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="estimation_files/figure-html/fig-r-bayesian-posterior-predictive-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5.10: Posterior predictive distribution of happiness values</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that <em>any</em> metric we can calculate from a model will also have a distribution. For example, you have a classification model and you want to know the accuracy or true positive rate of the model. Instead of a single number, you now have access to a distribution of values for that metric. Why? For every sample of the distribution of parameters, you generate a prediction, convert it a class and compare it to the true class. So now you have a posterior predictive distribution for the predicted probabilities and class, and you can then calculate the accuracy, area under a receiver operating curve, true positive rate, etc., for each sample, and you have a distribution of possible values. As an example, we did this for our happiness model and show the interval estimate for R<sup>2</sup>. Pretty neat!</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-r-bayesian-metrics" class="anchored">
<div id="jxdcmteaia" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#jxdcmteaia table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jxdcmteaia thead, #jxdcmteaia tbody, #jxdcmteaia tfoot, #jxdcmteaia tr, #jxdcmteaia td, #jxdcmteaia th {
  border-style: none;
}

#jxdcmteaia p {
  margin: 0;
  padding: 0;
}

#jxdcmteaia .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jxdcmteaia .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jxdcmteaia .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jxdcmteaia .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jxdcmteaia .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jxdcmteaia .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxdcmteaia .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jxdcmteaia .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jxdcmteaia .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jxdcmteaia .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jxdcmteaia .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jxdcmteaia .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jxdcmteaia .gt_spanner_row {
  border-bottom-style: hidden;
}

#jxdcmteaia .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jxdcmteaia .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jxdcmteaia .gt_from_md > :first-child {
  margin-top: 0;
}

#jxdcmteaia .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jxdcmteaia .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jxdcmteaia .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jxdcmteaia .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jxdcmteaia .gt_row_group_first td {
  border-top-width: 2px;
}

#jxdcmteaia .gt_row_group_first th {
  border-top-width: 2px;
}

#jxdcmteaia .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxdcmteaia .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jxdcmteaia .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jxdcmteaia .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jxdcmteaia .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxdcmteaia .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jxdcmteaia .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jxdcmteaia .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jxdcmteaia .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#jxdcmteaia .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jxdcmteaia .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxdcmteaia .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jxdcmteaia .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jxdcmteaia .gt_left {
  text-align: left;
}

#jxdcmteaia .gt_center {
  text-align: center;
}

#jxdcmteaia .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jxdcmteaia .gt_font_normal {
  font-weight: normal;
}

#jxdcmteaia .gt_font_bold {
  font-weight: bold;
}

#jxdcmteaia .gt_font_italic {
  font-style: italic;
}

#jxdcmteaia .gt_super {
  font-size: 65%;
}

#jxdcmteaia .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jxdcmteaia .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jxdcmteaia .gt_indent_1 {
  text-indent: 5px;
}

#jxdcmteaia .gt_indent_2 {
  text-indent: 10px;
}

#jxdcmteaia .gt_indent_3 {
  text-indent: 15px;
}

#jxdcmteaia .gt_indent_4 {
  text-indent: 20px;
}

#jxdcmteaia .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption>Table&nbsp;5.7:  <p>Bayesian R<sup>2</sup></p> </caption>
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Bayes R2">Bayes R2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Lower">Lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Upper">Upper</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Bayes R2" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.71</td>
<td headers="Lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.65</td>
<td headers="Upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.75</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> 95% Credible interval for R-squared</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>There is nothing keeping you from doing posterior predictive checks with other estimation approaches, and it’s a good idea to do so. For example, in a GLM you have the beta estimates and the covariance matrix for them, and can simulate from a normal distribution with those estimates. But it’s a bit more straightforward with the bayesian approach, and some pacakges will allow you to do this automatically even.</p>
</div>
</div>
</div>
<section id="additional-thoughts" class="level4" data-number="5.13.2.1">
<h4 data-number="5.13.2.1" class="anchored" data-anchor-id="additional-thoughts"><span class="header-section-number">5.13.2.1</span> Additional Thoughts</h4>
<p>It turns out that any standard (frequentist) statistical model can be seen as a bayesian one from a particular point of view. Here are a couple:</p>
<ul>
<li>GLM and related estimated via maximum likelihood: Bayesian estimation with a flat/uniform prior on the parameters.</li>
<li>Ridge Regression: Bayesian estimation with a normal prior on the coefficients, penalty parameter is related to the variance of the prior</li>
<li>Lasso Regression: Bayesian estimation with a Laplace prior on the coefficients, penalty parameter is related to the variance of the prior</li>
</ul>
<p>So in many modeling contexts, you’re probably doing a restrictive form of bayesian estimation already. Hopefully this helps to demystify the bayesian approach a bit, and you feel more comfortable switching to it. R has excellent tools here, like brms and tidybayes, and Python has pymc3 and arviz, which are also useful.</p>
<p>We can see that the bayesian approach is very flexible, and can be used for many different types of models, and can be used to get at uncertainty in a model in ways that other approaches can’t. It’s not a panacea, and it’s not always the best approach, but it’s a good one to have in your toolbox.</p>
<p>WHERE TO PUT THIS PRIOR STUFF?</p>
<p>The tough part about the bayesian approach is specifying priors, but even when you don’t have a great idea, many have offered solutions, and there are ways to check whether what you’ve chosen makes sense for your data before trying the model itself.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Specification of priors can be done in different ways, and nowadays, there is a lot of information on how to do so, and with some tools, it’s also pretty straightforward to check whether the priors are sensible without even running a model. When you do have actual prior knowledge, either domain knowledge (e.g.&nbsp;a prior study found the beta values to be positive), statistical knowledge, (e.g.&nbsp;only the largest standard coefficients go near or beyond 1), data from time periods, there’s typically at least something to help you specify your priors with sensible values. This takes away most of the luster of the primary argument against the bayesian approach, which is the subjective nature of priors. But there is likewise so much subjective decision making in other approaches, that it’s not really a useful argument to begin with. The bayesian approach just makes it more explicit. And if you don’t have any prior knowledge, you can use non- or weakly- informative priors, which will likely have little influence and let the data do the talking, producing a result that is not that different from maximum likelihood estimation.</p>
</div>
</div>
</div>
<p>MOVE MH EXAMPLE TO APPENDIX</p>
<p>Metropolis-Hastings demo</p>
</section>
</section>
</section>
<section id="commentary" class="level2" data-number="5.14">
<h2 data-number="5.14" class="anchored" data-anchor-id="commentary"><span class="header-section-number">5.14</span> Commentary</h2>
</section>
<section id="refs" class="level2" data-number="5.15" style="display: none">
<h2 data-number="5.15" class="anchored" data-anchor-id="refs"><span class="header-section-number">5.15</span> Refs</h2>
<p>Maximum Likelihood</p>
<p>SGD</p>
<p><a href="https://www.youtube.com/watch?v=sDv4f4s2SB8">Gradient Descent, Step-by-Step</a> <a href="https://www.youtube.com/watch?v=vMh0zPT0tLI">Stochastic Gradient Descent, Clearly Explained!!!</a> https://www.databricks.com/glossary/adagrad https://machinelearningmastery.com/gradient-descent-with-adagrad-from-scratch/</p>
<p>Bayesian</p>
<ul>
<li>BDA</li>
<li>Statistical Rethinking</li>
<li><a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">Prior Specification</a></li>
</ul>


</section>
<aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>It turns out that our error metric is itself an estimate of the true error. We’ll get more into this later, but for now this means that we can’t ever know the true error, and so we can’t ever really know the best or true model. However we can still get a good or better model relative to others in our current data setting.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We don’t have to do it this way, but it’s the default in most scenarios. As an example, maybe for your situation overshooting is worse than undershooting, and so you might want to use an approach that would weight those errors more heavily.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>You may find that some packages will only minimize (or maximize) a function, possibly one that you come up with yourself. It’d be nice if they did this internally, or allowed the user to specify the direction like most packages, but you’ll need to take care when implementing your own metrics.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Some disciplines seem confuse models with estimation methods and link functions. It doesn’t really make sense, nor is informative, to call something an OLS model or a logit model. Many models are estimated using a least squares approach, and different types of models use a logit link.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The actual probability of a <em>specific value</em> is 0, but the probability of a range of values is not 0. You can find out more about likelihoods and probabilities at the discussion <a href="https://stats.stackexchange.com/questions/2641/what-is-the-difference-between-likelihood-and-probability">here</a>, but in general many traditional statistical texts will have a discussion of this.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Those who have experience here will notice we aren’t putting a lower bound on sigma. You typically want to do this otherwise you may get nonsensical results. You can do this by using the <code>lower</code> parameter in <code>optim</code> with an algorithm that uses boundaries, or even more simply by exponentiating the parameter, i.e.&nbsp;<code>exp(par[1])</code>. Just remember that the returned value will be on the log scale, so you’ll have to exponentiate to get to the correct scale. We leave this detail out of the code for now to keep things simple.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Linear regression will settle on a line that cuts through the means, and when standardizing the mean of the features and target are both zero, so the line goes through the origin.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>MC does not recall exactly where this origin of this function came from except that Murphy’s PML book was a key reference.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Your default interpretation of a standard confidence interval is almost certaintly, and incorrectly, the actual interpretation of a Bayesian confidence interval, because the Bayesian interpretation of confidence intervals and p-values is how we tend to naturally think about them. But that’s okay, everyone else is in the same boat. We also don’t care if you want to call the Bayesian version a credible interval or a confidence interval.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./steps.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Steps in Modeling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./machine_learning.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Machine Learning</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>